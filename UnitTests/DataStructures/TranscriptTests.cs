using UnitTests.Utilities;
using Xunit;

namespace UnitTests.DataStructures
{
    [Collection("Chromosome 1 collection")]
    public class TranscriptTests
    {
        [Fact]
        public void AlternateCdsForward()
        {
            var transcript = CacheUtilities.GetTranscript("ENST00000374163_chr1_Ensembl84.ndb", "ENST00000374163");
            Assert.NotNull(transcript);

            const string expectedAlternateCds = "ATGGAGCAGGATCCCAAGCCGCCCCGTCTGCGGCTCTGGGCCCTGATCCCCTGGCTTCCCAGGAAGCAGCGGCCCAGGATCAGCCAGACCTCTCTGCCTGTCCCTGGCCCTGGCTCTGGCCCCCAGCGGGACTCGGATGAGGGCGTCCTCAAGGAGATCTCCATCACGCACCACGTCAAGGCTGGCTCTGAGAAGGCTGATCCATCCCATTTCGAGCTCCTCAAGGTTCTGGGCCAGGGATCCTTTGGCAAAGTCTTCCTGGTGCGGAAAGTCACCCGGCCTGACAGTGGGCACCTGTATGCTATGAAGGTGCTGAAGAAGGCAACGCTGAAAGTACGTGACCGCGTCCGGACCAAGATGGAGAGAGACATCCTGGCTGATGTAAATCACCCATTCGTGGTGAAGCTGCACTATGCCTTCCAGACCGAGGGCAAGCTCTATCTCATTCTGGACTTCCTGCGTGGTGGGGACCTCTTCACCCGGCTCTCAAAAGAGGTAATATACATGATTCAAAAGAAAAATATTCATGAAGAAGTCTTCCTCCCACCCCAGCCCCCTCTATTCCCATCTATAGGTGATGTTCACGGAGGAGGATGTGAAGTTTTACCTGGCCGAGCTGGCTCTGGGCCTGGATCACCTGCACAGCCTGGGTATCATTTACAGAGACCTCAAGCCTGAGAACATCCTTCTGGATGAGGAGGGCCACATCAAACTCACTGACTTTGGCCTGAGCAAAGAGGCCATTGACCACGAGAAGAAGGCCTATTCTTTCTGCGGGACAGTGGAGTACATGGCCCCTGAGGTCGTCAACCGCCAGGGCCACTCCCATAGTGCGGACTGGTGGTCCTATGGGGTGTTGATGTTTGAGATGCTGACGGGCTCCCTGCCCTTCCAGGGGAAGGACCGGAAGGAGACCATGACACTGATTCTGAAGGCGAAGCTAGGCATGCCCCAGTTTCTGAGCACTGAAGCCCAGAGCCTCTTGCGGGCCCTGTTCAAGCGGAATCCTGCCAACCGGCTCGGCTCCGGCCCTGATGGGGCAGAGGAAATCAAGCGGCATGTCTTCTACTCCACCATTGACTGGAATAAGCTATACCGTCGTGAGATCAAGCCACCCTTCAAGCCAGCAGTGGCTCAGCCTGATGACACCTTCTACTTTGACACCGAGTTCACGTCCCGCACACCCAAGGATTCCCCAGGCATCCCCCCCAGCGCTGGGGCCCATCAGCTGTTCCGGGGCTTCAGCTTCGTGGCCACCGGCCTGATGGAAGACGACGGCAAGCCTCGTGCCCCGCAGGCACCCCTGCACTCGGTGGTACAGCAACTCCATGGGAAGAACCTGGTTTTTAGTGACGGCTACGTGGTAAAGGAGACAATTGGTGTGGGCTCCTACTCTGAGTGCAAGCGCTGTGTCCACAAGGCCACCAACATGGAGTATGCTGTCAAGGTCATTGATAAGAGCAAGCGGGATCCTTCAGAAGAGATTGAGATTCTTCTGCGGTATGGCCAGCACCCCAACATCATCACTCTGAAAGATGTGTATGATGATGGCAAACACGTGTACCTGGTGACAGAGCTGATGCGGGGTGGGGAGCTGCTGGACAAGATCCTGCGGCAGAAGTTCTTCTCAGAGCGGGAGGCCAGCTTTGTCCTGCACACCATTGGCAAAACTGTGGAGTATCTGCACTCACAGGGGGTTGTGCACAGGGACCTGAAGCCCAGCAACATCCTGTATGTGGACGAGTCCGGGAATCCCGAGTGCCTGCGCATCTGTGACTTTGGTTTTGCCAAACAGCTGCGGGCTGAGAATGGGCTCCTCATGACACCTTGCTACACAGCCAACTTTGTGGCGCCTGAGGTGCTGAAGCGCCAGGGCTACGATGAAGGCTGCGACATCTGGAGCCTGGGCATTCTGCTGTACACCATGCTGGCAGGATATACTCCATTTGCCAACGGTCCCAGTGACACACCAGAGGAAATCCTAACCCGGATCGGCAGTGGGAAGTTTACCCTCAGTGGGGGAAATTGGAACACAGTTTCAGAGACAGCCAAGGACCTGGTGTCCAAGATGCTACACGTGGATCCCCACCAGCGCCTCACAGCTAAGCAGGTTCTGCAGCATCCATGGGTCACCCAGAAAGACAAGCTTCCCCAAAGCCAGCTGTCCCACCAGGACCTACAGCTTGTGAAGGGAGCCATGGCTGCCACGTACTCCGCACTCAACAGCTCCAAGCCCACCCCCCAGCTGAAGCCCATCGAGTCATCCATCCTGGCCCAGCGGCGAGTGAGGAAGTTGCCATCCACCACCCTGTGAGGCACCAGGGCATTCGGGCCACAGGGCGGTGCTAGCTTGACACAGTCAGCATGCTTCCCAGAGGGAGCAGGCCGGAACCACAGGGCCAGAGGGAGCTGGAACCCGAGGGGCCGGGGAAGCTGCCAGCCCAGAACACCCCTAATGAGGGTGTGAGAAGTGCCTTCTCCTTCCCCAGGATGGACTCTTCTCGGCTCAGGCTCTGCTGGTGGAAAGCGATTCACTGTATAAACTTTTTTTTATGAAAAAAATGGCATCAACCACCATGGATTTTTACAAGATCCATTTGCCTTTCTGGGAGCAGAAACAGCCATTGCGGCCCCAGGAGGGGAACTGAGTCACGCTGGGGCTCTCTGAGACTCTTTAGAGCAGCTTTGGGATCCCACCCTGGGGACCCCCACGATTGGCCACCTGTAGCCATCTGCACACACCTCCGAGACAGTCCAGTGTCACCTCTCTCAGAGCATCTGGCTGTTTAGCAGAACTCATTCTATCCCCAATCAGCTCCTTTTCCGTTCTGTTCTGCTGGGAGTTCTAGAACCACTTCCTGCTACAGGAGGGGTCTCATGTCCTGCTGGCTTCCAGCTTCAGGCACCAGCATCCACCTTGGCTCTGCCAGTGGATCCCCTGCGGTCAGGCTGGGCAGCCCCAGAGAGAGGATGTGGAAAGCACTTTTTGGCTGACTTCATCTGGGGTTGGCAACAGGACAGAGTTCACAGGAGGCCAGTGGGCGGGCCATGAGGGACAGGGTCTTTTTTCATTTCTTCCTCAGCTGGTTACTCAGGGTTCATCTGTCCATGGCCTTTCTAATAAACTGTTGAGTTGAAGCACG";
            var observedAlternateCds = transcript.GetAlternateCds(613, 613, "C");

            Assert.Equal(expectedAlternateCds, observedAlternateCds);
        }

        [Fact]
        public void AlternateCdsReverse()
        {
            var transcript = CacheUtilities.GetTranscript("ENST00000255416_chr1_Ensembl84.ndb", "ENST00000255416");
            Assert.NotNull(transcript);

            const string expectedAlternateCds = "ATGATGGAAAAAAACACCTCCGAGGGCCCTGCCTGCAGTCCAGAGGAGACCGCATCTGAATCTGCCAAGGTGCCCACAGCAGAGCCTCCCGGAGAAGTGGCAGTATCAGAGTCCACCAGAGAAGAGCAGGTGCCCAAGCCGCAGGCCCCTGCCCCACAGGCCCCTACAGCCTCCACAGCCACTAAGCCTGCACCCCCAAGTGAAGATGTCCCCAGTGCCCCACTGCTGCTGACCCTGGATGATGTGAGCAGCAGCTCTGTGACTGTGAGCTGGGAGCCCCCAGAGAGGCTGGGGAGGCTGGGCCTCCAGGGCTATGTGCTGGAGCTCTGCAGAGAGGGAGCCTCGGAGTGGGTGCCTGTGAGTGCCCGGCCCATGATGGTGACCCAGCAGACTGTGCGGAACCTGGCTCTGGGAGACAAGTTCCTCCTGCGCGTGTCTGCAGTGAGTTCTGCAGGGGCTGGCCCGCCGGCCATGCTGGACCAGCCCATCCACATCCGAGAGAACATTGAGGCCCCCAAGATCCGTGTCCCCCGCCACCTCCGTCAGACCTACATCCGCCAGGTGGGAGAGACGGTCAACCTGCAAATCCCCTTCCAGGGGAAGCCTAAGCCTCAGGCCACATGGACCCACAACGGCCATGCCCTGGACAGCCAGCGGGTGAGCATGCGCACCGGGGACCAGGACTCCATCCTCTTCATTCGCTCGGCCCAGCGCTCCGACTCTGGCCGCTACGAGCTCACTGTGCGCGTGGAAGACCTGGAGGCCAAGGCAGTCATTGACATCCTGGTGATTGAGAAACCTGGACCCCCCAGCAGCATCAGGCTCCTGGACGTCTGGGGCTGCAATGCTGCTCTTCAGTGGACGCCACCCCAGGACACAGGCAACACAGAGCTCCTGGGCTACATGGTGCAGAAGGCAGACAAAAAGACAGGGCAATGGTTCACAGTGCTGGAGCGCTACCACCCAACCACCTGCACCATCTCTGACCTCATCATCGGCAACTCGTACTCCTTCCGGGTCTTCTCAGAAAACCTGTGTGGACTCAGCACCTCGGCCACCGTCACCAAGGAGCTCGCCCACATCCAGAAGGCAGATATTGCTGCCAAACCTAAAGGGTTTATTGAGCGAGACTTCTCAGAAGCCCCCTCATTCACCCAGCCCCTGGCTGACCACACCTCCACCCCTGGCTACAGCACCCAGTTGTTCTGCAGTGTCCGAGCTTCACCCAAGCCCAAGATCATCTGGATGAAAAACAAGATGGAGATCCAGGGCAACCCCAAATACCGCGCCCTCTCTGAGCAAGGCGTCTGCACCCTAGAGATCCGGAAACCCAGCCCCTTTGATTCTGGGGTCTACACCTGCAAGGCCATAAATGTGCTGGGGGAGGCATCTGTGGACTGCCGGCTGGAGGTCAAAGCCTCAGCCGCACACTGGAGTCACGGGAGGAGGCTGTGATGAGGAGCCAGGTGCTGCAGGCCTGAGGGGCCAGGTCCACCAGGCCTACAGTCAAACTCCAGAGATGCCCAAGACCCCCGCTTCCATAGCGACGGCTGATGGAACCGCCCCTGGTACCTGCTGGCCTCCCTTCCCCAGAGGCTGGTGTCCAGAACTCAGGAATGGGCCTGGTAGGCCCCAGGCCAGACTAACTGGGCTCAAGGGGTGCTGGAAGGCGCAGAGATTGGAGTGCCCTGCGGAGTTGCACTCTGGGTGGGAAGCACTCAAATAAAGATGCGTGGTGTTAACAGTG";
            var observedAlternateCds = transcript.GetAlternateCds(1434, 1434, "G");

            Assert.Equal(expectedAlternateCds, observedAlternateCds);
        }

        [Fact]
        public void AlternateCdsPaddedReverse()
        {
            var transcript = CacheUtilities.GetTranscript("ENST00000474953_chr1_Ensembl84.ndb", "ENST00000474953");
            Assert.NotNull(transcript);

            const string expectedAlternateCds = "NNCAAAAACTCTGATACTGCTCATATTAAGTCCATAGAAATTACTTCGATCCTTAATGGACTTCAAGCTTCTGAAAGTTCTGCTGAAGACAGTGAGCAGGAAGATGAGAGAGGTGCTCAAGACATGGATAATAATGGCAAAGAGGAATCTAAGATTGATCATTTGACCAACAACAGAAATGATCTTATTTCAAAGGAGGAACAGAACAGTTCATCTTTGCTAGAAGAAAACAAAGTTCATGCAGATTTGGTAATATCCAAACCAGTGTCAAAATCTCCAGAAAGATTAAGGAAAGATATAGAAGTATTATCCGAAGATACTGATTATGAAGAAGATGAAGTCACAAAAAAGAGAAAGGATGTCAAGAAGGACACAACAGATAAATCTTCAAAACCACAAATAAAACGTGGTAAAAGAAGGTATTGCAATACAGAAGAGTGTCTAAAAACTGGATCACCTGGCAAAAAGGAAGAGAAGGCCAAGAACAAAGAATCACTTTGCATGGAAAACAGTAGCAACAGCTCTTCAGATGAAGATGAAGAAGAAACAAAAGCAAAGATGACACCAACTAAGAAATACAATGGTTTGGAGGAAAAAAGAAAATCTCTACGGACAACTGGTTTCTATTCAGGATTTTCAGAAGTGGCAGAAAAAAGGATTAAACTTTTAAATAACTCTGATGAAAGACTTCAAAACAGCAGGGCCAAAGATCGAAAAGATGTCTGGTCAAGTATTCAGGGACAGTGGCCTAAAAAAACGCTGAAAGAGCTTTTTTCAGACTCTGATACTGAGGCTGCAGCTTCCCCACCGCATCCTGCCCCAGAGGAGGGGGTGGCAGAGGAGTCACTGCAGACTGTGGCTGAAGAGGAGAGTTGTTCACCCAGTGTAGAACTAGAAAAACCACCTCCAGTCAATGTCGATAGTAAACCCATTGAAGAAAAAACAGTAGAGGTCAATGACAGAAAAGCAGAATTTCCAAGTAGTGGCAGTAATTCAGTGCTAAATACCCCTCCTACTACACCTGAATCGCCTTCATCAGTCACTGTAACAGAAGGCAGCCGGCAGCAGTCTTCTGTAACAGTATCAGAACCACTGGCTCCAAACCAAGAAGAGGTTCGAAGTATCAAGAGTGAAACTGATAGCACAATTGAGGTGGATAGTGTTGCTGGGGAGCTCCAAGACCTCCAGTCTGAAGGGAATAGCTCGCCAGCAGGTTTTGATGCCAGTGTGAGCTCAAGCAGTAGTAATCAGCCAGAACCAGAACATCCTGAAAAAGCCTGTACAGGTCAGAAAAGAGTGAAAGATGCTCAGGGAGGAGGAAGTTCATCAAAAAAGCAGAAAAGAAGCCATAAAGCAACAGTGGTAAACAACAAAAAGAAGGGAAAAGGCACAAATAGTAGTGATAGTGAAGAACTTTCAGCTGGTGAAAGTATAACTAAGAGTCAGCCAGTCAAATCAGTTTCCACTGGAATGAAGTCTCATAGTACCAAATCTCCCGCAAGGACGCAGTCTCCAGGAAAATGTGGAAAGAATGGTGATAAGGATCCTGATCTCAAGGAACCCAGTAATCGATTACCCAAAGTTTACAAATGGAGTTTTCAGATGTCGGACCTGGAAAATATGACAAGTGCCGAACGCATCACAATTCTTCAAGAAAAACTTCAAGAAATCAGAAAACATTATCTGTCATTAAAATCTGAAGTAGCTTCCATTGATCGGAGGAGAAAGCGTTTAAAGAAGAAAGAGAGAGAAAGTGCTGCTACATCCTCATCCTCCTCTTCACCTTCATCCAGTTCCATAACAGCTGCTGTTATGTTAACTTTAGCTGAACCGTCAATGTCCAGCGCATCACAAAATGGAATGCTTCAACCACTCCCAGAAGACGTCCTTCACTCCCAAAATGAGGCTTTTCTGAAACGGCGAGGACCACCAACCGACGGCGACAAACCTGCTCCCTCACCCAGCGCCTCCCTTCGCCGCCGCCCGGCGGCCGACTGCCGGAGGGGAGGGGGCGTGGCCAGAGAGCGGAAGTGCCCGGAACCCGGAAGTGCGAGCTGGCGCGCAGCTGCAGTCTGGGAGTCTTTGGAGTTAGAATGGCCTTGGAAGGGATGAGCAAACGGAAGAGAAAGAGAAGTGTCCAGGAGGGAGAGAATCCTGACGACGGCGTTCGCGGGAGTCCGCCGGAAGACTACAGGCTTGGACAGGTCGCCAGTAGCTTATTTCGCGGCGAACACCATTCCAGAGGTGGCACCGGTCGGCTGGCGTCCCTCTTCAGTTCTCTGGAGCCCCAGATTCAACCCGTGTACGTGCCTGTGCCTAAACAAACCATCAAAAAAACGAAACGGAATGAGGAGGAAGAAAGTACATCCCAGATTGAAAGACCACTTTCGCAAGAACCTGCCAAAAAAGTGAAAGCGAAGAAGAAACACACTAACGCAGAAAAAAAGTTGGCAGACAGGGAAAGCGCTCTAGCGAGTGCTGATTTAGAAGAAGAAATTCACCAGAAACAAGGGCAGAAAAGGAAAAATTCTCAACCTGGTGTTAAAGTAGCAGATAGAAAAATACTTGATGACACAGAAGACACAGTTGTCAGTCAAAGAAAGAAAATTCAAATCAACCAAGAAGAAGAGAGATTAAAGAATGAGAGAACTGTGTTTGTTGGGAATTTGCCTGTTACATGTAATAAGAAGAAGCTGAAGTCGTTTTTTAAAGAGTATGGACAAATAGAATCTGTACGATTTCGTTCTCTGATTCCAGCAGAGGGAACGCTATCCAAAAAGTTGGCAGCAATAAAACGTAAAATTCATCCTGATCAGAAAAATATTAATGCCTATGTTGTGTTTAAGGAGGAGAGTGCTGCCACGCAAGCATTGAAAAGAAATGGGGCCCAGATTGCAGATGGATTTCGTATTAGAGTTGATCTCGCATCTGAGACCTCATCTAGAGACAAGAGATCGGTTTTTGTGGGGAATCTCCCTTATAAAGTTGAAGAATCTGCCATTGAGAAGCACTTTCTGGACTGTGGAAGTATCATGGCCGTGAGGATTGTGAGAGACAAAATGACAGGCATCGGCAAAGGGTTTGGCTATGTGCTCTTTGAGAATACAGATTCTGTTCATCTTGCTCTGAAATTAAATAATTCTGAACTCATGGGGAGAAAACTCAGAGTCATGCGTTCTGTTAATAAAGAAAAATTTAAACAACAAAATTCAAATCCACGATTGAAGAATGTCAGTAAACCTAAGCAGGGACTTAATTTTACTTCCAAAACTGCAGAAGGACATCCTAAAAGCTTATTTATTGGAGAAAAAGCTGTTCTCCTTAAAACGAAGAAGAAAGGACAGAAGAAAAGTGGACGCCCTAAGAAACAGAGAAAACAGAAATAACAACCAGGAACTGCTTTTTCTTTTCCTGCTGAGTACTGCTAATAAAAGTGCTATTATCTGCTGATAGCATCGTCTGCTA";
            var observedAlternateCds = transcript.GetAlternateCds(2090, 2090, "T");

            Assert.Equal(expectedAlternateCds, observedAlternateCds);
        }
    }
}
