using UnitTests.Utilities;
using Xunit;

namespace UnitTests.DataStructures
{
    public class CodingSequenceTests
    {
        [Theory]
        //[Trait("transcript", "ENST00000257290")] // forward
        //[Trait("transcript", "ENST00000480326")] // forward with phase
        //[Trait("transcript", "ENST00000355439")] // reverse
        //[Trait("transcript", "ENST00000474953")] // reverse with phase
        //[InlineData("4", "GRCh37.ENST00000257290_chr4_Ensembl84", "ATGGGGACTTCCCATCCGGCGTTCCTGGTCTTAGGCTGTCTTCTCACAGGGCTGAGCCTAATCCTCTGCCAGCTTTCATTACCCTCTATCCTTCCAAATGAAAATGAAAAGGTTGTGCAGCTGAATTCATCCTTTTCTCTGAGATGCTTTGGGGAGAGTGAAGTGAGCTGGCAGTACCCCATGTCTGAAGAAGAGAGCTCCGATGTGGAAATCAGAAATGAAGAAAACAACAGCGGCCTTTTTGTGACGGTCTTGGAAGTGAGCAGTGCCTCGGCGGCCCACACAGGGTTGTACACTTGCTATTACAACCACACTCAGACAGAAGAGAATGAGCTTGAAGGCAGGCACATTTACATCTATGTGCCAGACCCAGATGTAGCCTTTGTACCTCTAGGAATGACGGATTATTTAGTCATCGTGGAGGATGATGATTCTGCCATTATACCTTGTCGCACAACTGATCCCGAGACTCCTGTAACCTTACACAACAGTGAGGGGGTGGTACCTGCCTCCTACGACAGCAGACAGGGCTTTAATGGGACCTTCACTGTAGGGCCCTATATCTGTGAGGCCACCGTCAAAGGAAAGAAGTTCCAGACCATCCCATTTAATGTTTATGCTTTAAAAGCAACATCAGAGCTGGATCTAGAAATGGAAGCTCTTAAAACCGTGTATAAGTCAGGGGAAACGATTGTGGTCACCTGTGCTGTTTTTAACAATGAGGTGGTTGACCTTCAATGGACTTACCCTGGAGAAGTGAAAGGCAAAGGCATCACAATGCTGGAAGAAATCAAAGTCCCATCCATCAAATTGGTGTACACTTTGACGGTCCCCGAGGCCACGGTGAAAGACAGTGGAGATTACGAATGTGCTGCCCGCCAGGCTACCAGGGAGGTCAAAGAAATGAAGAAAGTCACTATTTCTGTCCATGAGAAAGGTTTCATTGAAATCAAACCCACCTTCAGCCAGTTGGAAGCTGTCAACCTGCATGAAGTCAAACATTTTGTTGTAGAGGTGCGGGCCTACCCACCTCCCAGGATATCCTGGCTGAAAAACAATCTGACTCTGATTGAAAATCTCACTGAGATCACCACTGATGTGGAAAAGATTCAGGAAATAAGGTATCGAAGCAAATTAAAGCTGATCCGTGCTAAGGAAGAAGACAGTGGCCATTATACTATTGTAGCTCAAAATGAAGATGCTGTGAAGAGCTATACTTTTGAACTGTTAACTCAAGTTCCTTCATCCATTCTGGACTTGGTCGATGATCACCATGGCTCAACTGGGGGACAGACGGTGAGGTGCACAGCTGAAGGCACGCCGCTTCCTGATATTGAGTGGATGATATGCAAAGATATTAAGAAATGTAATAATGAAACTTCCTGGACTATTTTGGCCAACAATGTCTCAAACATCATCACGGAGATCCACTCCCGAGACAGGAGTACCGTGGAGGGCCGTGTGACTTTCGCCAAAGTGGAGGAGACCATCGCCGTGCGATGCCTGGCTAAGAATCTCCTTGGAGCTGAGAACCGAGAGCTGAAGCTGGTGGCTCCCACCCTGCGTTCTGAACTCACGGTGGCTGCTGCAGTCCTGGTGCTGTTGGTGATTGTGATCATCTCACTTATTGTCCTGGTTGTCATTTGGAAACAGAAACCGAGGTATGAAATTCGCTGGAGGGTCATTGAATCAATCAGCCCAGATGGACATGAATATATTTATGTGGACCCGATGCAGCTGCCTTATGACTCAAGATGGGAGTTTCCAAGAGATGGACTAGTGCTTGGTCGGGTCTTGGGGTCTGGAGCGTTTGGGAAGGTGGTTGAAGGAACAGCCTATGGATTAAGCCGGTCCCAACCTGTCATGAAAGTTGCAGTGAAGATGCTAAAACCCACGGCCAGATCCAGTGAAAAACAAGCTCTCATGTCTGAACTGAAGATAATGACTCACCTGGGGCCACATTTGAACATTGTAAACTTGCTGGGAGCCTGCACCAAGTCAGGCCCCATTTACATCATCACAGAGTATTGCTTCTATGGAGATTTGGTCAACTATTTGCATAAGAATAGGGATAGCTTCCTGAGCCACCACCCAGAGAAGCCAAAGAAAGAGCTGGATATCTTTGGATTGAACCCTGCTGATGAAAGCACACGGAGCTATGTTATTTTATCTTTTGAAAACAATGGTGACTACATGGACATGAAGCAGGCTGATACTACACAGTATGTCCCCATGCTAGAAAGGAAAGAGGTTTCTAAATATTCCGACATCCAGAGATCACTCTATGATCGTCCAGCCTCATATAAGAAGAAATCTATGTTAGACTCAGAAGTCAAAAACCTCCTTTCAGATGATAACTCAGAAGGCCTTACTTTATTGGATTTGTTGAGCTTCACCTATCAAGTTGCCCGAGGAATGGAGTTTTTGGCTTCAAAAAATTGTGTCCACCGTGATCTGGCTGCTCGCAACGTCCTCCTGGCACAAGGAAAAATTGTGAAGATCTGTGACTTTGGCCTGGCCAGAGACATCATGCATGATTCGAACTATGTGTCGAAAGGCAGTACCTTTCTGCCCGTGAAGTGGATGGCTCCTGAGAGCATCTTTGACAACCTCTACACCACACTGAGTGATGTCTGGTCTTATGGCATTCTGCTCTGGGAGATCTTTTCCCTTGGTGGCACCCCTTACCCCGGCATGATGGTGGATTCTACTTTCTACAATAAGATCAAGAGTGGGTACCGGATGGCCAAGCCTGACCACGCTACCAGTGAAGTCTACGAGATCATGGTGAAATGCTGGAACAGTGAGCCGGAGAAGAGACCCTCCTTTTACCACCTGAGTGAGATTGTGGAGAATCTGCTGCCTGGACAATATAAAAAGAGTTATGAAAAAATTCACCTGGACTTCCTGAAGAGTGACCATCCTGCTGTGGCACGCATGCGTGTGGACTCAGACAATGCATACATTGGTGTCACCTACAAAAACGAGGAAGACAAGCTGAAGGACTGGGAGGGTGGTCTGGATGAGCAGAGACTGAGCGCTGACAGTGGCTACATCATTCCTCTGCCTGACATTGACCCTGTCCCTGAGGAGGAGGACCTGGGCAAGAGGAACAGACACAGCTCGCAGACCTCTGAAGAGAGTGCCATTGAGACGGGTTCCAGCAGTTCCACCTTCATCAAGAGAGAGGACGAGACCATTGAAGACATCGACATGATGGATGACATCGGCATAGACTCTTCAGACCTGGTGGAAGACAGCTTCCTGTAA")]
        [InlineData("1", "ENST00000480326_chr1_Ensembl84", "NGGACCCAAGAGAGCCTAGCAGAGAAGGAGCTCCAGCTTCTGGTCATGATTCACCAGCTGTCCACCCTGCGGGACCAGCTCCTGACAGCCCACTCGGAGCAGAAGAACATGGCTGCCATGCTGTTTGAGAAGCAGCAGCAGCAGATGGAGCTTGCCCGGCAGCAGCAGGAGCAGATTGCAAAGCAGCAGCAGCAGCTGATTCAGCAGCAGCATAAGATCAACCTCCTTCAGCAGCAGATCCAGCAGGTTAACATGCCTTATGTCATGATCCCAGCCTTCCCCCCAAGCCACCAACCTCTGCCTGTCACCCCTGACTCCCAGCTGGCCTTACCCATTCAGCCCATTCCCTGCAAACCAGGACTTTTCTCCTTGCTGCCTTTTCCATAG")]
        //[InlineData("1", "GRCh37.ENST00000355439_chr1_Ensembl84", "ATGTCGTCCTCGGTGAAAACCCCAGCACTGGAAGAGCTGGTTCCTGGCTCCGAAGAGAAGCCGAAAGGCAGGTCGCCTCTCAGCTGGGGCTCTCTGTTTGGTCACCGAAGTGAGAAGATTGTTTTTGCCAAGAGCGACGGCGGCACAGATGAGAACGTACTGACCGTCACCATCACGGAGACCACGGTCATCGAGTCAGACTTGGGTGTGTGGAGCTCGCGGGCGCTGCTCTACCTCACGCTGTGGTTCTTCTTCAGCTTCTGCACGCTCTTCCTCAACAAGTACATCCTGTCCCTGCTGGGAGGCGAGCCCAGCATGCTAGGTGCGGTGCAGATGCTGTCCACCACGGTTATCGGGTGTGTGAAAACCCTCGTTCCTTGCTGTTTATATCAGCACAAGGCCCGGCTTTCCTACCCACCCAACTTCCTTATGACGATGCTGTTTGTGGGTCTGATGAGGTTTGCAACTGTGGTTTTGGGTTTGGTCAGCCTGAAAAATGTGGCGGTTTCGTTTGCTGAGACGGTGAAGAGCTCCGCCCCCATCTTCACGGTGATCATGTCTCGGATGATTCTGGGGGAGTACACAGGACGTCCCAGTGATCGGGAGGAGCGGGAAGAGCTTCAGCTACAACCAGGACGTGGTGCTGCTGCTTCTGACAGACGGAGTCCTGTTCCACCTTCAGAGCGTCACGGCGTACGCCCTCATGGGGAAAATCTCCCCGGTGACTTTCAGGCCCAGTAA")]
        //[InlineData("1", "GRCh37.ENST00000474953_chr1_Ensembl84", "NNCAAAAACTCTGATACTGCTCATATTAAGTCCATAGAAATTACTTCGATCCTTAATGGACTTCAAGCTTCTGAAAGTTCTGCTGAAGACAGTGAGCAGGAAGATGAGAGAGGTGCTCAAGACATGGATAATAATGGCAAAGAGGAATCTAAGATTGATCATTTGACCAACAACAGAAATGATCTTATTTCAAAGGAGGAACAGAACAGTTCATCTTTGCTAGAAGAAAACAAAGTTCATGCAGATTTGGTAATATCCAAACCAGTGTCAAAATCTCCAGAAAGATTAAGGAAAGATATAGAAGTATTATCCGAAGATACTGATTATGAAGAAGATGAAGTCACAAAAAAGAGAAAGGATGTCAAGAAGGACACAACAGATAAATCTTCAAAACCACAAATAAAACGTGGTAAAAGAAGGTATTGCAATACAGAAGAGTGTCTAAAAACTGGATCACCTGGCAAAAAGGAAGAGAAGGCCAAGAACAAAGAATCACTTTGCATGGAAAACAGTAGCAACAGCTCTTCAGATGAAGATGAAGAAGAAACAAAAGCAAAGATGACACCAACTAAGAAATACAATGGTTTGGAGGAAAAAAGAAAATCTCTACGGACAACTGGTTTCTATTCAGGATTTTCAGAAGTGGCAGAAAAAAGGATTAAACTTTTAAATAACTCTGATGAAAGACTTCAAAACAGCAGGGCCAAAGATCGAAAAGATGTCTGGTCAAGTATTCAGGGACAGTGGCCTAAAAAAACGCTGAAAGAGCTTTTTTCAGACTCTGATACTGAGGCTGCAGCTTCCCCACCGCATCCTGCCCCAGAGGAGGGGGTGGCAGAGGAGTCACTGCAGACTGTGGCTGAAGAGGAGAGTTGTTCACCCAGTGTAGAACTAGAAAAACCACCTCCAGTCAATGTCGATAGTAAACCCATTGAAGAAAAAACAGTAGAGGTCAATGACAGAAAAGCAGAATTTCCAAGTAGTGGCAGTAATTCAGTGCTAAATACCCCTCCTACTACACCTGAATCGCCTTCATCAGTCACTGTAACAGAAGGCAGCCGGCAGCAGTCTTCTGTAACAGTATCAGAACCACTGGCTCCAAACCAAGAAGAGGTTCGAAGTATCAAGAGTGAAACTGATAGCACAATTGAGGTGGATAGTGTTGCTGGGGAGCTCCAAGACCTCCAGTCTGAAGGGAATAGCTCGCCAGCAGGTTTTGATGCCAGTGTGAGCTCAAGCAGTAGTAATCAGCCAGAACCAGAACATCCTGAAAAAGCCTGTACAGGTCAGAAAAGAGTGAAAGATGCTCAGGGAGGAGGAAGTTCATCAAAAAAGCAGAAAAGAAGCCATAAAGCAACAGTGGTAAACAACAAAAAGAAGGGAAAAGGCACAAATAGTAGTGATAGTGAAGAACTTTCAGCTGGTGAAAGTATAACTAAGAGTCAGCCAGTCAAATCAGTTTCCACTGGAATGAAGTCTCATAGTACCAAATCTCCCGCAAGGACGCAGTCTCCAGGAAAATGTGGAAAGAATGGTGATAAGGATCCTGATCTCAAGGAACCCAGTAATCGATTACCCAAAGTTTACAAATGGAGTTTTCAGATGTCGGACCTGGAAAATATGACAAGTGCCGAACGCATCACAATTCTTCAAGAAAAACTTCAAGAAATCAGAAAACATTATCTGTCATTAAAATCTGAAGTAGCTTCCATTGATCGGAGGAGAAAGCGTTTAAAGAAGAAAGAGAGAGAAAGTGCTGCTACATCCTCATCCTCCTCTTCACCTTCATCCAGTTCCATAACAGCTGCTGTTATGTTAACTTTAGCTGAACCGTCAATGTCCAGCGCATCACAAAATGGAATGCTTCAACCACTCCCAGAAGACGTCCTTCACTCCCAAAATGAGGCTTTTCTGAAACGGCGAGGACCACCAACCGACGGCGACAAACCTGCTCCCTCACCCAGCGCCTCCCTTCGCCGCCGCCCGGCGGCCGACTGCCGGAGGGGAGGGGGCGTGGCCAGAGAGCGGAAGTGCCCGGAACCCGGAAGTGCGAGCTGGCGCGCAGCTGCAGTCTGGGAGTCTTTGGAGTAA")]
        public void Check(string ensemblRefName, string cacheStub, string expectedSequence)
        {
            var cacheData = DataUtilities.GetFirstTranscript(Resources.CacheGRCh37(cacheStub), ensemblRefName);
            var translateableSequence = cacheData.GetCodingSequence();
            var observedSequence = translateableSequence.Sequence();
            Assert.Equal(expectedSequence, observedSequence);
        }
    }
}
