using System;
using VariantAnnotation.AnnotatedPositions;
using VariantAnnotation.AnnotatedPositions.AminoAcids;
using Xunit;

namespace UnitTests.VariantAnnotation.AnnotatedPositions
{
    public sealed class HgvsProteinTests
    {
        private const string CdsSequence =
            "ATGGATGACTCGGAGACAGGTTTCAATCTGAAAGTCGTCCTGGTCAGTTTCAAGCAGTGTCTCGATGAGAAGGAAGAGGTCTTGCTGGACCCCTACATTGCCAGCTGGAAGGGCCTGGTCAGGTTTCTGAACAGCCTGGGCACCATCTTCTCATTCATCTCCAAGGACGTGGTCTCCAAGCTGCGGATCATGGAGCGCCTCAGGGGCGGCCCGCAGAGCGAGCACTACCGCAGCCTGCAGGCCATGGTGGCCCACGAGCTGAGCAACCGGCTGGTGGACCTGGAGCGCCGCTCCCACCACCCGGAGTCTGGCTGCCGGACGGTGCTGCGCCTGCACCGCGCCCTGCACTGGCTGCAGCTGTTCCTGGAGGGCCTGCGTACCAGCCCCGAGGACGCACGCACCTCCGCGCTCTGCGCCGACTCCTACAACGCCTCGCTGGCCGCCTACCACCCCTGGGTCGTGCGCCGCGCCGTCACCGTGGCCTTCTGCACGCTGCCCACACGCGAGGTCTTCCTGGAGGCCATGAACGTGGGGCCCCCGGAGCAGGCCGTGCAGATGCTAGGCGAGGCCCTCCCCTTCATCCAGCGTGTCTACAACGTCTCCCAGAAGCTCTACGCCGAGCACTCCCTGCTGGACCTGCCCTAGGGGCGGGAAGCCAGGGCCGCACCGGCTTTCCTGCTGCAGATCTGGGCTGCGGTGGCCAGGGCCGTGAGTCCCGTGGCAGAGCCTTCTGGGCGCTGCGGGAACAGGAGATCCTCTGTCGCCCCTGTGAGCTGAGCTGGTTAGGAACCACAGACTGTGACAGAGAAGGTGGCGACCAGCCCAGAAGAGGCCCACCCTCTCGGTCCGGAACAAGACGCCTCGGCCACGGCTCCCCCTCGGCCTATTACACGCGTGCGCAGCCAGGCCTCGCCAGGGTGCGGTGCAGAGCAGAGCAGGCAGGGGTGGGGGCCGGGCCTGCAAGAGCCCGAAAGGTCGCCACCCCCTAGCCTGTGGGGTGCATCTGCGAACCAGGGTGAAGTCACAGGTCCCGGGGTGTGGAGGCTCCATCCTTTCTCCTTTCTGCCAGCCGATGTGTCCTCATCTCAGGCCCGTGCCTGGGACCCCGTGTCTGCCCAGGTGGGCAGCCTTGAGCCCAGGGGACTCAGTGCCCTCCATGCCCTGGCTGGCAGAAACCCTCAACAGCAGTCTGGGCACTGTGGGGCTCTCCCCGCCTCTCCTGCCTTGTTTGCCCCTCAGCGTGCCAGGCAGACTGGGGGCAGGACAGCCGGAAGCTGAGACCAAGGCTCCTCACAGAAGGGCCCAGGAAGTCCCCGCCCTTGGGACAGCCTCCTCCGTAGCCCCTGCACGGCACCAGTTCCCCGAGGGACGCAGCAGGCCGCCTCCCGCAGCGGCCGTGGGTCTGCACAGCCCAGCCCAGCCCAAGGCCCCCAGGAGCTGGGACTCTGCTACACCCAGTGAAATGCTGTGTCCCTTCTCCCCCGTGCCCCTTGATGCCCCCTCCCCACAGTGCTCAGGAGACCCGTGGGGCACGGAACAGGAGGGTCTGGACCCTGTGGCCCAGCCAAAGGCTACCAGACAGCCACAACCAGCCCAGCCACCATCCAGTGCCTGGGGCCTGGCCACTGGCTCTTCACAGTGGACCCCAGCACCTCGGGGTGGCAGAGGGACGGCCCCCACGGCCCAGCAGACATGCGAGCTTCCAGAGTGCAATCTATGTGATGTCTTCCAACGTTAATAAATCACACAGCCTCCCAGGAGGGAGACGCTGGGGTGCAC";
        
        private const string AaSequence =
            "MDDSETGFNLKVVLVSFKQCLDEKEEVLLDPYIASWKGLVRFLNSLGTIFSFISKDVVSKLRIMERLRGGPQSEHYRSLQAMVAHELSNRLVDLERRSHHPESGCRTVLRLHRALHWLQLFLEGLRTSPEDARTSALCADSYNASLAAYHPWVVRRAVTVAFCTLPTREVFLEAMNVGPPEQAVQMLGEALPFIQRVYNVSQKLYAEHSLLDLP*";

        [Fact]
        public void GetHgvsProteinAnnotation_Substitution()
        {
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("ENSP00000343890.4", "ENST00000343938.4:c.5A>C",
                CdsSequence, AaSequence, 5, 5, 2, "D", "A", "C", false, AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("ENSP00000343890.4:p.(Asp2Ala)", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_Silent_SameAminoAcids()
        {
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("ENSP00000343890.4",
                "ENST00000343938.4:c.10_12delinsAGT", CdsSequence, AaSequence, 10, 12, 4, "S", "S", "AGT", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("ENST00000343938.4:c.10_12delinsAGT(p.(Ser4=))", actualResult);
        }
        
        [Fact]
        public void GetHgvsProteinAnnotation_Silent_StopRetained()
        {
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_001300882.1",
                "NM_001313953.1:c.937_938del", CdsSequence, AaSequence, 938, 937, 313, "*", "*", "", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NM_001313953.1:c.937_938del(p.(Ter313=))", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_Insertion_InsertStopCodon()
        {
            const string aaSequence = "MGRPRVRQAWPGCCGHTGRLPAGRGYLASHMCDPAGAELIGDGMSDPTPPSNACTGHIQDPASQRLTWNKSPKSVLVIKKMRDASLLQPFKELCTHLMEENMIVYVEKKVLEDPAIASDESFGAVKKKFCTFREDYDDISNQIDFIICLGGDGTLLYASSLFQGSVPPVMAFHLGSLGFLTPFSFENFQSQVTQVIEGNAAVVLRSRLKVRVVKELRGKKTAVHNGLGENGSQAAGLDMDVGKQAMQYQVLNEVVIDRGPSSYLSNVDVYLDGHLITTVQGDGVIVSTPTGSTAYAAAAGASMIHPNVPAIMITPICPHSLSFRPIVVPAGVELKIMLSPEARNTAWVSFDGRKRQEIRHGDSISITTSCYPLPSICVRDPVSDWFESLAQCLHWNVRKKQAHFEEEEEEEEEG";
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_001185924.1",
                "NM_001198995.1:c.1239_1240insTAG", CdsSequence, aaSequence, 1240, 1241, 414, "", "*", "TAG", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_001185924.1:p.(Gly414Ter)", actualResult);
        }
        
        [Fact]
        public void GetHgvsProteinAnnotation_Insertion()
        {
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("ENSP00000343890.4",
                "ENST00000343938.4:c.6_7insTTC", CdsSequence, AaSequence, 7, 6, 3, "", "F", "TTC", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("ENSP00000343890.4:p.(Asp2_Asp3insPhe)", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_Insertion_SilentTerminalCodon_TrimmedTooMuch()
        {
            // VID: chr2-48033998-A-AAG (NC_000002.11:g.48033998_48033999insAG), key: NM_001281493.1, expected: NP_001268422.1:p.(Ter1059Ter), actual: NP_001268422.1:p.(Xaa1060GlyfsTer)
            const string cdsSequence =
                "ATGGTGACTGGAAATGGCTCTCTTAAAAGGAAAAGCTCTAGGAAGGAAACGCCCTCAGCCACCAAACAAGCAACTAGCATTTCATCAGAAACCAAGAATACTTTGAGAGCTTTCTCTGCCCCTCAAAATTCTGAATCCCAAGCCCACGTTAGTGGAGGTGGTGATGACAGTAGTCGCCCTACTGTTTGGTATCATGAAACTTTAGAATGGCTTAAGGAGGAAAAGAGAAGAGATGAGCACAGGAGGAGGCCTGATCACCCCGATTTTGATGCATCTACACTCTATGTGCCTGAGGATTTCCTCAATTCTTGTACTCCTGGGATGAGGAAGTGGTGGCAGATTAAGTCTCAGAACTTTGATCTTGTCATCTGTTACAAGGTGGGGAAATTTTATGAGCTGTACCACATGGATGCTCTTATTGGAGTCAGTGAACTGGGGCTGGTATTCATGAAAGGCAACTGGGCCCATTCTGGCTTTCCTGAAATTGCATTTGGCCGTTATTCAGATTCCCTGGTGCAGAAGGGCTATAAAGTAGCACGAGTGGAACAGACTGAGACTCCAGAAATGATGGAGGCACGATGTAGAAAGATGGCACATATATCCAAGTATGATAGAGTGGTGAGGAGGGAGATCTGTAGGATCATTACCAAGGGTACACAGACTTACAGTGTGCTGGAAGGTGATCCCTCTGAGAACTACAGTAAGTATCTTCTTAGCCTCAAAGAAAAAGAGGAAGATTCTTCTGGCCATACTCGTGCATATGGTGTGTGCTTTGTTGATACTTCACTGGGAAAGTTTTTCATAGGTCAGTTTTCAGATGATCGCCATTGTTCGAGATTTAGGACTCTAGTGGCACACTATCCCCCAGTACAAGTTTTATTTGAAAAAGGAAATCTCTCAAAGGAAACTAAAACAATTCTAAAGAGTTCATTGTCCTGTTCTCTTCAGGAAGGTCTGATACCCGGCTCCCAGTTTTGGGATGCATCCAAAACTTTGAGAACTCTCCTTGAGGAAGAATATTTTAGGGAAAAGCTAAGTGATGGCATTGGGGTGATGTTACCCCAGGTGCTTAAAGGTATGACTTCAGAGTCTGATTCCATTGGGTTGACACCAGGAGAGAAAAGTGAATTGGCCCTCTCTGCTCTAGGTGGTTGTGTCTTCTACCTCAAAAAATGCCTTATTGATCAGGAGCTTTTATCAATGGCTAATTTTGAAGAATATATTCCCTTGGATTCTGACACAGTCAGCACTACAAGATCTGGTGCTATCTTCACCAAAGCCTATCAACGAATGGTGCTAGATGCAGTGACATTAAACAACTTGGAGATTTTTCTGAATGGAACAAATGGTTCTACTGAAGGAACCCTACTAGAGAGGGTTGATACTTGCCATACTCCTTTTGGTAAGCGGCTCCTAAAGCAATGGCTTTGTGCCCCACTCTGTAACCATTATGCTATTAATGATCGTCTAGATGCCATAGAAGACCTCATGGTTGTGCCTGACAAAATCTCCGAAGTTGTAGAGCTTCTAAAGAAGCTTCCAGATCTTGAGAGGCTACTCAGTAAAATTCATAATGTTGGGTCTCCCCTGAAGAGTCAGAACCACCCAGACAGCAGGGCTATAATGTATGAAGAAACTACATACAGCAAGAAGAAGATTATTGATTTTCTTTCTGCTCTGGAAGGATTCAAAGTAATGTGTAAAATTATAGGGATCATGGAAGAAGTTGCTGATGGTTTTAAGTCTAAAATCCTTAAGCAGGTCATCTCTCTGCAGACAAAAAATCCTGAAGGTCGTTTTCCTGATTTGACTGTAGAATTGAACCGATGGGATACAGCCTTTGACCATGAAAAGGCTCGAAAGACTGGACTTATTACTCCCAAAGCAGGCTTTGACTCTGATTATGACCAAGCTCTTGCTGACATAAGAGAAAATGAACAGAGCCTCCTGGAATACCTAGAGAAACAGCGCAACAGAATTGGCTGTAGGACCATAGTCTATTGGGGGATTGGTAGGAACCGTTACCAGCTGGAAATTCCTGAGAATTTCACCACTCGCAATTTGCCAGAAGAATACGAGTTGAAATCTACCAAGAAGGGCTGTAAACGATACTGGACCAAAACTATTGAAAAGAAGTTGGCTAATCTCATAAATGCTGAAGAACGGAGGGATGTATCATTGAAGGACTGCATGCGGCGACTGTTCTATAACTTTGATAAAAATTACAAGGACTGGCAGTCTGCTGTAGAGTGTATCGCAGTGTTGGATGTTTTACTGTGCCTGGCTAACTATAGTCGAGGGGGTGATGGTCCTATGTGTCGCCCAGTAATTCTGTTGCCGGAAGATACCCCCCCCTTCTTAGAGCTTAAAGGATCACGCCATCCTTGCATTACGAAGACTTTTTTTGGAGATGATTTTATTCCTAATGACATTCTAATAGGCTGTGAGGAAGAGGAGCAGGAAAATGGCAAAGCCTATTGTGTGCTTGTTACTGGACCAAATATGGGGGGCAAGTCTACGCTTATGAGACAGGCTGGCTTATTAGCTGTAATGGCCCAGATGGGTTGTTACGTCCCTGCTGAAGTGTGCAGGCTCACACCAATTGATAGAGTGTTTACTAGACTTGGTGCCTCAGACAGAATAATGTCAGGTGAAAGTACATTTTTTGTTGAATTAAGTGAAACTGCCAGCATACTCATGCATGCAACAGCACATTCTCTGGTGCTTGTGGATGAATTAGGAAGAGGTACTGCAACATTTGATGGGACGGCAATAGCAAATGCAGTTGTTAAAGAACTTGCTGAGACTATAAAATGTCGTACATTATTTTCAACTCACTACCATTCATTAGTAGAAGATTATTCTCAAAATGTTGCTGTGCGCCTAGGACATATGGCATGCATGGTAGAAAATGAATGTGAAGACCCCAGCCAGGAGACTATTACGTTCCTCTATAAATTCATTAAGGGAGCTTGTCCTAAAAGCTATGGCTTTAATGCAGCAAGGCTTGCTAATCTCCCAGAGGAAGTTATTCAAAAGGGACATAGAAAAGCAAGAGAATTTGAGAAGATGAATCAGTCACTACGATTATTTCGGGAAGTTTGCCTGGCTAGTGAAAGGTCAACTGTAGATGCTGAAGCTGTCCATAAATTGCTGACTTTGATTAAGGAATTATAGACTGACTACATTGGAAGCTTTGAGTTGACTTCTGACAAAGGTGGTAAATTCAGACAACATTATGATCTAATAAACTTTATTTTTTAAAAATGAAAAAAAAAAAAAAAAAAAA";
            const string aaSequence =
                "MVTGNGSLKRKSSRKETPSATKQATSISSETKNTLRAFSAPQNSESQAHVSGGGDDSSRPTVWYHETLEWLKEEKRRDEHRRRPDHPDFDASTLYVPEDFLNSCTPGMRKWWQIKSQNFDLVICYKVGKFYELYHMDALIGVSELGLVFMKGNWAHSGFPEIAFGRYSDSLVQKGYKVARVEQTETPEMMEARCRKMAHISKYDRVVRREICRIITKGTQTYSVLEGDPSENYSKYLLSLKEKEEDSSGHTRAYGVCFVDTSLGKFFIGQFSDDRHCSRFRTLVAHYPPVQVLFEKGNLSKETKTILKSSLSCSLQEGLIPGSQFWDASKTLRTLLEEEYFREKLSDGIGVMLPQVLKGMTSESDSIGLTPGEKSELALSALGGCVFYLKKCLIDQELLSMANFEEYIPLDSDTVSTTRSGAIFTKAYQRMVLDAVTLNNLEIFLNGTNGSTEGTLLERVDTCHTPFGKRLLKQWLCAPLCNHYAINDRLDAIEDLMVVPDKISEVVELLKKLPDLERLLSKIHNVGSPLKSQNHPDSRAIMYEETTYSKKKIIDFLSALEGFKVMCKIIGIMEEVADGFKSKILKQVISLQTKNPEGRFPDLTVELNRWDTAFDHEKARKTGLITPKAGFDSDYDQALADIRENEQSLLEYLEKQRNRIGCRTIVYWGIGRNRYQLEIPENFTTRNLPEEYELKSTKKGCKRYWTKTIEKKLANLINAEERRDVSLKDCMRRLFYNFDKNYKDWQSAVECIAVLDVLLCLANYSRGGDGPMCRPVILLPEDTPPFLELKGSRHPCITKTFFGDDFIPNDILIGCEEEEQENGKAYCVLVTGPNMGGKSTLMRQAGLLAVMAQMGCYVPAEVCRLTPIDRVFTRLGASDRIMSGESTFFVELSETASILMHATAHSLVLVDELGRGTATFDGTAIANAVVKELAETIKCRTLFSTHYHSLVEDYSQNVAVRLGHMACMVENECEDPSQETITFLYKFIKGACPKSYGFNAARLANLPEEVIQKGHRKAREFEKMNQSLRLFREVCLASERSTVDAEAVHKLLTLIKEL*";

            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_001268422.1",
                "NM_001281493.1:c.3176_3177insAG", cdsSequence, aaSequence, 3177, 3176, 1059, "*", "*X", "AG", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NM_001281493.1:c.3176_3177insAG(p.(Ter1059=))", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_Duplication_RightShifted()
        {
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("ENSP00000343890.4",
                "ENST00000343938.4:c.7_9dup", CdsSequence, AaSequence, 10, 9, 4, "", "D", "GAC", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("ENSP00000343890.4:p.(Asp3dup)", actualResult);
        }
        
        [Fact]
        public void GetHgvsProteinAnnotation_Duplication_MissingOutput()
        {
            // TODO: We still need to modify FullTranscriptAnnotator to provide this information
            // VID: chr1-120057267-G-GAG (NC_000001.10:g.120057267_120057268dup), key: NM_000862.2, expected: NP_000853.1:p.(=), actual:
            const string cdsSequence =
                "ATGACGGGCTGGAGCTGCCTTGTGACAGGAGCAGGAGGGTTTCTGGGACAGAGGATCATCCGCCTCTTGGTGAAGGAGAAGGAGCTGAAGGAGATCAGGGTCTTGGACAAGGCCTTCGGACCAGAATTGAGAGAGGAATTTTCTAAACTCCAGAACAAGACCAAGCTGACAGTGCTGGAAGGAGACATTCTGGATGAGCCATTCCTGAAGAGAGCCTGCCAGGACGTCTCGGTCATCATCCACACCGCCTGTATCATTGATGTCTTCGGTGTCACTCACAGAGAGTCTATCATGAATGTCAATGTGAAAGGTACCCAGCTCCTGTTAGAGGCCTGTGTCCAAGCTAGTGTGCCAGTCTTCATCTACACCAGTAGCATAGAGGTAGCCGGGCCCAACTCCTACAAGGAAATCATCCAGAATGGCCATGAAGAAGAGCCTCTGGAAAACACATGGCCCGCTCCATACCCACACAGCAAAAAGCTTGCTGAGAAGGCTGTACTGGCGGCTAACGGGTGGAATCTGAAAAACGGCGGCACCCTGTACACTTGTGCCTTACGACCCATGTATATCTATGGGGAAGGAAGCCGATTCCTTTCTGCTAGTATAAACGAGGCCCTGAACAACAATGGGATCCTGTCAAGTGTTGGAAAGTTCTCCACTGTTAACCCAGTCTATGTTGGCAATGTGGCCTGGGCCCACATTCTGGCCTTGAGGGCCCTGCAGGACCCCAAGAAGGCCCCAAGCATCCGAGGACAGTTCTACTATATCTCAGATGACACGCCTCACCAAAGCTATGATAACCTTAATTACACCCTGAGCAAAGAGTTCGGCCTCCGCCTTGATTCCAGATGGAGCTTTCCTTTATCCCTGATGTATTGGATTGGCTTCCTGCTGGAAATAGTGAGCTTCCTACTCAGGCCAATTTACACCTATCGACCGCCCTTCAACCGCCACATAGTCACATTGTCAAATAGCGTATTCACCTTCTCTTATAAGAAGGCTCAGCGAGATCTGGCGTATAAGCCACTCTACAGCTGGGAGGAAGCCAAGCAGAAAACGGTGGAGTGGGTTGGTTCCCTTGTGGACCGGCACAAGGAGACCCTGAAGTCCAAGACTCAGTGATTTAAGGATGACAGAGATGTGCATGTGGGTATTGTTAGGAGATGTCATCAAGCTCCACCCTCCTGGCCTCATACAGAAAGTGACAAGGGCACAAGCTCAGGTCCTGCTGCCTCCCTTTCATACAATGGCCAACTTATTGTATTCCTCATGTCATCAAAACCTGCGCAGTCATTGGCCCAACAAGAAGGTTTCTGTCCTAATCATATACCAGAGGAAAGACCATGTGGTTTGCTGTTACCAAATCTCAGTAGCTGATTCTGAACAATTTAGGGACTCTTTTAACTTGAGGGTCGTTTTGACTACTAGAGCTCCATTTCTACTCTTAAATGAGAAAGGATTTCCTTTCTTTTTAATCTTCCATTCCTTCACATAGTTTGATAAAAAGATCAATAAATGTTTGAATGTTTAATGTGAAAAAAAAA";
            const string aaSequence =
                "MTGWSCLVTGAGGFLGQRIIRLLVKEKELKEIRVLDKAFGPELREEFSKLQNKTKLTVLEGDILDEPFLKRACQDVSVIIHTACIIDVFGVTHRESIMNVNVKGTQLLLEACVQASVPVFIYTSSIEVAGPNSYKEIIQNGHEEEPLENTWPAPYPHSKKLAEKAVLAANGWNLKNGGTLYTCALRPMYIYGEGSRFLSASINEALNNNGILSSVGKFSTVNPVYVGNVAWAHILALRALQDPKKAPSIRGQFYYISDDTPHQSYDNLNYTLSKEFGLRLDSRWSFPLSLMYWIGFLLEIVSFLLRPIYTYRPPFNRHIVTLSNSVFTFSYKKAQRDLAYKPLYSWEEAKQKTVEWVGSLVDRHKETLKSKTQ*";

            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_000853.1",
                "NM_000862.2:c.1121_1122dup", cdsSequence, aaSequence, 1123, 1122, 374, "*", "X", "AG", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NM_000862.2:c.1121_1122dup(p.(Ter374=))", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_Deletion()
        {
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("ENSP00000343890.4",
                "ENST00000343938.4:c.10_12del", CdsSequence, AaSequence, 10, 12, 4, "S", "", "", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("ENSP00000343890.4:p.(Ser4del)", actualResult);
        }
        
        [Fact]
        public void GetHgvsProteinAnnotation_Deletion_StartLost()
        {
            const string cdsSequence =
                "ATGCTGAAAAAGCCTCTCTCAGCTGTGACCTGGCTCTGCATTTTCATCGTGGCCTTTGTCAGCCACCCAGCGTGGCTGCAGAAGCTCTCTAAGCACAAGACACCAGCACAGCCACAGCTCAAAGCGGCCAACTGCTGTGAGGAGGTGAAGGAGCTCAAGGCCCAAGTTGCCAACCTTAGCAGCCTGCTGAGTGAACTGAACAAGAAGCAGGAGAGGGACTGGGTCAGCGTGGTCATGCAGGTGATGGAGCTGGAGAGCAACAGCAAGCGCATGGAGTCGCGGCTCACAGATGCTGAGAGCAAGTACTCCGAGATGAACAACCAAATTGACATCATGCAGCTGCAGGCAGCACAGACGGTCACTCAGACCTCCGCAGATGCCATCTACGACTGCTCTTCCCTCTACCAGAAGAACTACCGCATCTCTGGAGTGTATAAGCTTCCTCCTGATGACTTCCTGGGCAGCCCTGAACTGGAGGTGTTCTGTGACATGGAGACTTCAGGCGGAGGCTGGACCATCATCCAGAGACGAAAAAGTGGCCTTGTCTCCTTCTACCGGGACTGGAAGCAGTACAAGCAGGGCTTTGGCAGCATCCGTGGGGACTTCTGGCTGGGGAACGAACACATCCACCGGCTCTCCAGACAGCCAACCCGGCTGCGTGTAGAGATGGAGGACTGGGAGGGCAACCTGCGCTACGCTGAGTATAGCCACTTTGTTTTGGGCAATGAACTCAACAGCTATCGCCTCTTCCTGGGGAACTACACTGGCAATGTGGGGAACGACGCCCTCCAGTATCATAACAACACAGCCTTCAGCACCAAGGACAAGGACAATGACAACTGCTTGGACAAGTGTGCACAGCTCCGCAAAGGTGGCTACTGGTACAACTGCTGCACAGACTCCAACCTCAATGGAGTGTACTACCGCCTGGGTGAGCACAATAAGCACCTGGATGGCATCACCTGGTATGGCTGGCATGGATCTACCTACTCCCTCAAACGGGTGGAGATGAAAATCCGCCCAGAAGACTTCAAGCCTTAAAAGGAGGCTGCCGTGGAGCACGGATACAGAAACTGAGACACGTGGAGACTGGATGAGGGCAGATGAGGACAGGAAGAGAGTGTTAGAAAGGGTAGGACTGAGAAACAGCCTATAATCTCCAAAGAAAGAATAAGTCTCCAAGGAGCACAAAAAAATCATATGTACCAAGGATGTTACAGTAAACAGGATGAACTATTTAAACCCACTGGGTCCTGCCACATCCTTCTCAAGGTGGTAGACTGAGTGGGGTCTCTCTGCCCAAGATCCCTGACATAGCAGTAGCTTGTCTTTTCCACATGATTTGTCTGTGAAAGAAAATAATTTTGAGATCGTTTTATCTATTTTCTCTACGGCTTAGGCTATGTGAGGGCAAAACACAAATCCCTTTGCTAAAAAGAACCATATTATTTTGATTCTCAAAGGATAGGCCTTTGAGTGTTAGAGAAAGGAGTGAAGGAGGCAGGTGGGAAATGGTATTTCTATTTTTAAATCCAGTGAAATTATCTTGAGTCTACACATTATTTTTAAAACACAAAAATTGTTCGGCTGGAACTGACCCAGGCTGGACTTGCGGGGAGGAAACTCCAGGGCACTGCATCTGGCGATCAGACTCTGAGCACTGCCCCTGCTCGCCTTGGTCATGTACAGCACTGAAAGGAATGAAGCACCAGCAGGAGGTGGACAGAGTCTCTCATGGATGCCGGCACAAAACTGCCTTAAAATATTCATAGTTAATACAGGTATATCTATTTTTATTTACTTTGTAAGAAACAAGCTCAAGGAGCTTCCTTTTAAATTTTGTCTGTAGGAAATGGTTGAAAACTGAAGGTAGATGGTGTTATAGTTAATAATAAATGCTGTAAATAAGCATCTCACTTTGTAAAAATAAAATATTGTGGTTTTGTTTTAAACATTCAACGTTTCTTTTCCTTCTACAATAAACACTTTCAAAATGTGAAAAAAAAAAAAAAAAAA";
            const string aaSequence =
                "MLKKPLSAVTWLCIFIVAFVSHPAWLQKLSKHKTPAQPQLKAANCCEEVKELKAQVANLSSLLSELNKKQERDWVSVVMQVMELESNSKRMESRLTDAESKYSEMNNQIDIMQLQAAQTVTQTSADAIYDCSSLYQKNYRISGVYKLPPDDFLGSPELEVFCDMETSGGGWTIIQRRKSGLVSFYRDWKQYKQGFGSIRGDFWLGNEHIHRLSRQPTRLRVEMEDWEGNLRYAEYSHFVLGNELNSYRLFLGNYTGNVGNDALQYHNNTAFSTKDKDNDNCLDKCAQLRKGGYWYNCCTDSNLNGVYYRLGEHNKHLDGITWYGWHGSTYSLKRVEMKIRPEDFKP*";

            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_066969.1",
                "NM_021146.3:c.3_4del", cdsSequence, aaSequence, 3, 4, 1, "ML", "IX", "", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_066969.1:p.Met1?", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_Deletion_TerminalCodon()
        {
            const string cdsSequence =
                "ATGCCCCCTGGGGTGGACTGCCCCATGGAATTCTGGACCAAGGAGGAGAATCAGAGCGTTGTGGTTGACTTCCTGCTGCCCACAGGGGTCTACCTGAACTTCCCTGTGTCCCGCAATGCCAACCTCAGCACCATCAAGCAGCTGCTGTGGCACCGCGCCCAGTATGAGCCGCTCTTCCACATGCTCAGTGGCCCCGAGGCCTATGTGTTCACCTGCATCAACCAGACAGCGGAGCAGCAAGAGCTGGAGGACGAGCAACGGCGTCTGTGTGACGTGCAGCCCTTCCTGCCCGTCCTGCGCCTGGTGGCCCGTGAGGGCGACCGCGTGAAGAAGCTCATCAACTCACAGATCAGCCTCCTCATCGGCAAAGGCCTCCACGAGTTTGACTCCTTGTGCGACCCAGAAGTGAACGACTTTCGCGCCAAGATGTGCCAATTCTGCGAGGAGGCGGCCGCCCGCCGGCAGCAGCTGGGCTGGGAGGCCTGGCTGCAGTACAGTTTCCCCCTGCAGCTGGAGCCCTCGGCTCAAACCTGGGGGCCTGGTACCCTGCGGCTCCCGAACCGGGCCCTTCTGGTCAACGTTAAGTTTGAGGGCAGCGAGGAGAGCTTCACCTTCCAGGTGTCCACCAAGGACGTGCCGCTGGCGCTGATGGCCTGTGCCCTGCGGAAGAAGGCCACAGTGTTCCGGCAGCCGCTGGTGGAGCAGCCGGAAGACTACACGCTGCAGGTGAACGGCAGGCATGAGTACCTGTATGGCAGCTACCCGCTCTGCCAGTTCCAGTACATCTGCAGCTGCCTGCACAGTGGGTTGACCCCTCACCTGACCATGGTCCATTCCTCCTCCATCCTCGCCATGCGGGATGAGCAGAGCAACCCTGCCCCCCAGGTCCAGAAACCGCGTGCCAAACCACCTCCCATTCCTGCGAAGAAGCCTTCCTCTGTGTCCCTGTGGTCCCTGGAGCAGCCGTTCCGCATCGAGCTCATCCAGGGCAGCAAAGTGAACGCCGACGAGCGGATGAAGCTGGTGGTGCAGGCCGGGCTTTTCCACGGCAACGAGATGCTGTGCAAGACGGTGTCCAGCTCGGAGGTGAGCGTGTGCTCGGAGCCCGTGTGGAAGCAGCGGCTGGAGTTCGACATCAACATCTGCGACCTGCCCCGCATGGCCCGTCTCTGCTTTGCGCTGTACGCCGTGATCGAGAAAGCCAAGAAGGCTCGCTCCACCAAGAAGAAGTCCAAGAAGGCGGACTGCCCCATTGCCTGGGCCAACCTCATGCTGTTTGACTACAAGGACCAGCTTAAGACCGGGGAACGCTGCCTCTACATGTGGCCCTCCGTCCCAGATGAGAAGGGCGAGCTGCTGAACCCCACGGGCACTGTGCGCAGTAACCCCAACACGGATAGCGCCGCTGCCCTGCTCATCTGCCTGCCCGAGGTGGCCCCGCACCCCGTGTACTACCCCGCCCTGGAGAAGATCTTGGAGCTGGGGCGACACAGCGAGTGTGTGCATGTCACCGAGGAGGAGCAGCTGCAGCTGCGGGAAATCCTGGAGCGGCGGGGGTCTGGGGAGCTGTATGAGCACGAGAAGGACCTGGTGTGGAAGCTGCGGCATGAAGTCCAGGAGCACTTCCCGGAGGCGCTAGCCCGGCTGCTGCTGGTCACCAAGTGGAACAAGCATGAGGATGTGGCCCAGATGCTCTACCTGCTGTGCTCCTGGCCGGAGCTGCCCGTCCTGAGCGCCCTGGAGCTGCTAGACTTCAGCTTCCCCGATTGCCACGTAGGCTCCTTCGCCATCAAGTCGCTGCGGAAACTGACGGACGATGAGCTGTTCCAGTACCTGCTGCAGCTGGTGCAGGTGCTCAAGTACGAGTCCTACCTGGACTGCGAGCTGACCAAATTCCTGCTGGACCGGGCCCTGGCCAACCGCAAGATCGGCCACTTCCTTTTCTGGCACCTCCGCTCCGAGATGCACGTGCCGTCGGTGGCCCTGCGCTTCGGCCTCATCCTGGAGGCCTACTGCAGGGGCAGCACCCACCACATGAAGGTGCTGATGAAGCAGGGGGAAGCACTGAGCAAACTGAAGGCCCTGAATGACTTCGTCAAGCTGAGCTCTCAGAAGACCCCCAAGCCCCAGACCAAGGAGCTGATGCACTTGTGCATGCGGCAGGAGGCCTACCTAGAGGCCCTCTCCCACCTGCAGTCCCCACTCGACCCCAGCACCCTGCTGGCTGAAGTCTGCGTGGAGCAGTGCACCTTCATGGACTCCAAGATGAAGCCCCTGTGGATCATGTACAGCAACGAGGAGGCAGGCAGCGGCGGCAGCGTGGGCATCATCTTTAAGAACGGGGATGACCTCCGGCAGGACATGCTGACCCTGCAGATGATCCAGCTCATGGACGTCCTGTGGAAGCAGGAGGGGCTGGACCTGAGGATGACCCCCTATGGCTGCCTCCCCACCGGGGACCGCACAGGCCTCATTGAGGTGGTACTCCGTTCAGACACCATCGCCAACATCCAACTCAACAAGAGCAACATGGCAGCCACAGCCGCCTTCAACAAGGATGCCCTGCTCAACTGGCTGAAGTCCAAGAACCCGGGGGAGGCCCTGGATCGAGCCATTGAGGAGTTCACCCTCTCCTGTGCTGGCTATTGTGTGGCCACATATGTGCTGGGCATTGGCGATCGGCACAGCGACAACATCATGATCCGAGAGAGTGGGCAGCTGTTCCACATTGATTTTGGCCACTTTCTGGGGAATTTCAAGACCAAGTTTGGAATCAACCGCGAGCGTGTCCCATTCATCCTCACCTACGACTTTGTCCATGTGATTCAGCAGGGGAAGACTAATAATAGTGAGAAATTTGAACGGTTCCGGGGCTACTGTGAAAGGGCCTACACCATCCTGCGGCGCCACGGGCTTCTCTTCCTCCACCTCTTTGCCCTGATGCGGGCGGCAGGCCTGCCTGAGCTCAGCTGCTCCAAAGACATCCAGTATCTCAAGGACTCCCTGGCACTGGGGAAAACAGAGGAGGAGGCACTGAAGCACTTCCGAGTGAAGTTTAACGAAGCCCTCCGTGAGAGCTGGAAAACCAAAGTGAACTGGCTGGCCCACAACGTGTCCAAAGACAACAGGCAGTAGTGGCTCCTCCCAGCCCTGGGCCCAAGAGGAGGCGGCTGCGGGTCGTGGGGACCAAGCACATTGGTCCTAAAGGGGCTGAAGAGCCTGAACTGCACCTAACGGGAAAGAACCGACATGGCTGCCTTTTGTTTACACTGGTTATTTATTTATGACTTGAAATAGTTTAAGGAGCTAAACAGCCATAAACGGAAACGCCTCCTTCATGCAGCGGCGGTGCTGGGCCCCCCGAGGCTGCACCTGGCTCTCGGCTGAGGATTGTCACCCCAAGTCTTCCAGCTGGTGGATCTGGGCCCAGCAAAGACTGTTCTCCTCCCGAGGGAACCTTCTTCCCAGGCCTCCCGCCAGACTGCCTGGGTCCTGGCGCCTGGCGGTCACCTGGTGCCTACTGTCCGACAGGATGCCTTGATCCTCGTGCGACCCACCCTGTGTATCCTCCCTAGACTGAGTTCTGGCAGCTCCCCGAGGCAGCCGGGGTACCCTCTAGATTCAGGGATGCTTGCTCTCCACTTTTCAAGTGGGTCTTGGGTACGAGAATTCCCTCATCTTTCTCTACTGTAAAGTGATTTTGTTTGCAGGTAAGAAAATAATAGATGACTCACCACACCTCTACGGCTGGGGAGATCAGGCCCAGCCCCATAAAGGAGAATCTACGCTGGTCCTCAGGACGTGTTAAAGAGATCTGGGCCTCATGTAGCTCACCCCGGTCACGCATGAAGGCAAAAGCAGGTCAGAAGCGAATACTCTGCCATTATCTCAAAAATCTTTTTTTTTTTTTTGAGATGGGGTCTTCCTCTGTTGCCCAGGCTGGAGTGCAGTGGTGCAATCTTGGCTCACTGTAACCTCCGCCTCCCAGGTTCAAGTGATTCTTCTGCCTCAGCCTCCTGAGTAGCTGGGATTACAGGTGTGCACCACCGTACCCAGCTAATTTTTGTATTTTAGTAGAGACGGGGGTTTCACCATGTTGGCTGGGCTGGTCTCGAACTCCTGACCTCAGGTGATCCACCCGCCTGAGCCTCCCAAAGTGCTGGGATTACAGGCATGAGCCACCGCGCCCGGCCCACTCTGCCATTGTCTAAGCCACCTCTGAAAGCAGGTTTTAACAAAAGGATGAGGCCAGAACTCTTCCAGAACCATCACCTTTGGGAACCTGCTGTGAGAGTGCTGAGGTACCAGAAGTGTGAGAACGAGGGGGCGTGCTGGGATCTTTCTCTCTGACTATACTTAGTTTGAAATGGTGCAGGCTTAGTCTTAAGCCTCCAAAGGCCTGGATTTGAGCAGCTTTAGAAATGCAGGTTCTAGGGCTTCTCCCAGCCTTCAGAAGCCAACTAACTCTGCAGATGGGGCTAGGACTGTGGGCTTTTAGCAGCCCACAGGTGATCCTAACATATCAGGCCATGGACTCAGGACCTGCCCGGTGATGCTGTTGATTTCTCAAAGGTCTTCCAAAACTCAACAGAGCCAGAAGTAGCCGCCCGCTCAGCGGCTCAGGTGCCAGCTCTGTTCTGATTCACCAGGGGTCCGTCAGTAGTCATTGCCACCCGCGGGGCACCTCCCTGGCCACACGCCTGTTCCCAGCAAGTGCTGAAACTCACTAGACCGTCTGCCTGTTTCGAAATGGGGAAAGCCGTGCGTGCGCGTTATTTATTTAAGTGCGCCTGTGTGCGCGGGTGTGGGAGCACACTTTGCAAAGCCACAGCGTTTCTGGTTTTGGGTGTACAGTCTTGTGTGCCTGGCGAGAAGAATATTTTCTATTTTTTTAAGTCATTTCATGTTTCTGTCTGGGGAAGGCAAGTTAGTTAAGTATCACTGATGTGGGTTGAGACCAGCACTCTGTGAAACCTTGAAATGAGAAGTAAAGGCAGATGAAAAGAAAGAAAAAGCCTTTTTATGTTCTTTTATGTTCTCGGCTCAAAAAGAAACAAGGGAGTGTAGGTTTAAAACCAAAACAGGAGAGAAGACAAACCCCGCTCCGGCTGGAGTTAGTTAGAACCAGAACTTTATTGTAGCGGATACACTTTCTGACCTATCATGAGTATACACATCTGCGAAGGGAAACCGCGCGGCGACA";
            const string aaSequence =
                "MPPGVDCPMEFWTKEENQSVVVDFLLPTGVYLNFPVSRNANLSTIKQLLWHRAQYEPLFHMLSGPEAYVFTCINQTAEQQELEDEQRRLCDVQPFLPVLRLVAREGDRVKKLINSQISLLIGKGLHEFDSLCDPEVNDFRAKMCQFCEEAAARRQQLGWEAWLQYSFPLQLEPSAQTWGPGTLRLPNRALLVNVKFEGSEESFTFQVSTKDVPLALMACALRKKATVFRQPLVEQPEDYTLQVNGRHEYLYGSYPLCQFQYICSCLHSGLTPHLTMVHSSSILAMRDEQSNPAPQVQKPRAKPPPIPAKKPSSVSLWSLEQPFRIELIQGSKVNADERMKLVVQAGLFHGNEMLCKTVSSSEVSVCSEPVWKQRLEFDINICDLPRMARLCFALYAVIEKAKKARSTKKKSKKADCPIAWANLMLFDYKDQLKTGERCLYMWPSVPDEKGELLNPTGTVRSNPNTDSAAALLICLPEVAPHPVYYPALEKILELGRHSECVHVTEEEQLQLREILERRGSGELYEHEKDLVWKLRHEVQEHFPEALARLLLVTKWNKHEDVAQMLYLLCSWPELPVLSALELLDFSFPDCHVGSFAIKSLRKLTDDELFQYLLQLVQVLKYESYLDCELTKFLLDRALANRKIGHFLFWHLRSEMHVPSVALRFGLILEAYCRGSTHHMKVLMKQGEALSKLKALNDFVKLSSQKTPKPQTKELMHLCMRQEAYLEALSHLQSPLDPSTLLAEVCVEQCTFMDSKMKPLWIMYSNEEAGSGGSVGIIFKNGDDLRQDMLTLQMIQLMDVLWKQEGLDLRMTPYGCLPTGDRTGLIEVVLRSDTIANIQLNKSNMAATAAFNKDALLNWLKSKNPGEALDRAIEEFTLSCAGYCVATYVLGIGDRHSDNIMIRESGQLFHIDFGHFLGNFKTKFGINRERVPFILTYDFVHVIQQGKTNNSEKFERFRGYCERAYTILRRHGLLFLHLFALMRAAGLPELSCSKDIQYLKDSLALGKTEEEALKHFRVKFNEALRESWKTKVNWLAHNVSKDNRQ*";
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_005017.3",
                "NM_005026.3:c.164_165del", cdsSequence, aaSequence, 164, 165, 55, "Y", "X", "", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_005017.3:p.(Tyr55Ter)", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_Deletion_TerminalCodon_GivenWrongAltAminoAcid()
        {
            // VID: chr1-8073599-GGG-G (NC_000001.10:g.8073600_8073601del), key: NM_018948.3, expected: NP_061821.1:p.(Pro354Ter), actual: NM_018948.3:c.1060_1061del(p.(Pro354=))
            const string cdsSequence =
                "ATGTCAATAGCAGGAGTTGCTGCTCAGGAGATCAGAGTCCCATTAAAAACTGGATTTCTACATAATGGCCGAGCCATGGGGAATATGAGGAAGACCTACTGGAGCAGTCGCAGTGAGTTTAAAAACAACTTTTTAAATATTGACCCGATAACCATGGCCTACAGTCTGAACTCTTCTGCTCAGGAGCGCCTAATACCACTTGGGCATGCTTCCAAATCTGCTCCGATGAATGGCCACTGCTTTGCAGAAAATGGTCCATCTCAAAAGTCCAGCTTGCCCCCTCTTCTTATTCCCCCAAGTGAAAACTTGGGACCACATGAAGAGGATCAAGTTGTATGTGGTTTTAAGAAACTCACAGTGAATGGGGTTTGTGCTTCCACCCCTCCACTGACACCCATAAAAAACTCCCCTTCCCTTTTCCCCTGTGCCCCTCTTTGTGAACGGGGTTCTAGGCCTCTTCCACCGTTGCCAATCTCTGAAGCCCTCTCTCTGGATGACACAGACTGTGAGGTGGAATTCCTAACTAGCTCAGATACAGACTTCCTTTTAGAAGACTCTACACTTTCTGATTTCAAATATGATGTTCCTGGCAGGCGAAGCTTCCGTGGGTGTGGACAAATCAACTATGCATATTTTGATACCCCAGCTGTTTCTGCAGCAGATCTCAGCTATGTGTCTGACCAAAATGGAGGTGTCCCAGATCCAAATCCTCCTCCACCTCAGACCCACCGAAGATTAAGAAGGTCTCATTCGGGACCAGCTGGCTCCTTTAACAAGCCAGCCATAAGGATATCCAACTGTTGTATACACAGAGCTTCTCCTAACTCCGATGAAGACAAACCTGAGGTTCCCCCCAGAGTTCCCATACCTCCTAGACCAGTAAAGCCAGATTATAGAAGATGGTCAGCAGAAGTTACTTCGAGCACCTATAGTGATGAAGACAGGCCTCCCAAAGTACCGCCAAGAGAACCTTTGTCACCGAGTAACTCGCGCACACCGAGTCCCAAAAGCCTTCCGTCTTACCTCAATGGGGTCATGCCCCCGACACAGAGCTTTGCCCCTGATCCCAAGTATGTCAGCAGCAAAGCACTGCAAAGACAGAACAGCGAAGGATCTGCCAGTAAGGTTCCTTGCATTCTGCCCATTATTGAAAATGGGAAGAAGGTTAGTTCAACACATTATTACCTACTACCTGAACGACCACCATACCTGGACAAATATGAAAAATTTTTTAGGGAAGCAGAAGAAACAAATGGAGGCGCCCAAATCCAGCCATTACCTGCTGACTGCGGTATATCTTCAGCCACAGAAAAGCCAGACTCAAAAACAAAAATGGATCTGGGTGGCCACGTGAAGCGTAAACATTTATCCTATGTGGTTTCTCCTTAGACCTTGGGGTCATGGTTCAGCAGAGGTTACATAGGAGCAAATGGTTCTCAATTTTCCAGTTTGATTGAAGTGCAGAGAAAAATCCCTTAGATTGCAAAATAAAATAGTTGAACTCTCTGTCTTCATGTGGAAGGTTTAGAGCAGTTGTGAGATGCTGTTATGCTGAGAAACCCTGACTTTGTTAGTGTTGGAAAAAAGTCTTACAAGTCTATAATTTAAAGATGTGATGGTGGGGAGGGGAGGATGGGGAAGCTTTTTATATATGCATACATTACATACCTATATATAAACTTGTGGTATAACCATAGACCATAGCTGCAGGTTAACCAATTAGTTACTATCGTAGAGTAATATATATTCAGAATAATAAACTCAAGCTGGAGAAATGAGTCCTGATAGACTGAAAATTGAGCAAATGGAAGAAGATACAGTATTGTTTAGATCAGAATCATTAAAAAATATTTTTGTTTAGTAAGTTTGAAGATTTCTGGCTTTTAGGCCTTTTCTATTTTGTTCCATTTATTTTTGCAGGCAATCTTTTCCATGGAGGGCAGGGTATCCATTCTTTACCATGGGTGTACCTGCTTAGGTTAAAAATCATACCAAGGCCTCATACTTCCAGGTTTCATGTTGCGTCTTGTTGAGGGAGGGAGAGCAGGTTACTTGGCAACCATATTGTCACCTGTACCTGTCACACATCTTGAAAAATAAAACGATAATAGAACTAGTGACTAATTTTCCCTTACAGTTCCTGCTTGGTCCCACCCACTGAAGTAGCTCATCGTAGTGCGGGCCGTATTAGAGGCAGTGGGGTACGTTAGACTCAGATGGAAAAGTATTCTAGGTGCCAGTGTTAGGATGTCAGTTTTACAAAATAATGAAGCAATTAGCTATGTGATTGAGAGTTATTGTTTGGGGATGTGTGTTGTGGTTTTGCTTTTTTTTTTTAGACTGTATTAATAAACATACAACACAAGCTGGCCTTGTGTTGCTGGTTCCTATTCAGTATTTCCTGGGGATTGTTTGCTTTTTAAGTAAAACACTTCTGACCCATAGCTCAGTATGTCTGAATTCCAGAGGTCACATCAGCATCTTTCTGCTTTGAAAACTCTCACAGCTGTGGCTGCTTCACTTAGATGCAGTGAGACACATAGTTGGTGTTCCGATTTTCACATCCTTCCATGTATTTATCTTGAAGAGATAAGCACAGAAGAGAAGGTGCTCACTAACAGAGGTACATTACTGCAATGTTCTCTTAACAGTTAAACAAGCTGTTTACAGTTTAAACTGCTGAATATTATTTGAGCTATTTAAAGCTTATTATATTTTAGTATGAACTAAATGAAGGTTAAAACATGCTTAAGAAAAATGCACTGATTTCTGCATTATGTGTACAGTATTGGACAAAGGATTTTATTCATTTTGTTGCATTATTTTGAATATTGTCTTTTCATTTTAATAAAGTTATAATACTTATTTATGATACCATTAAAAAAAAAAAAAAAA";
            const string aaSequence =
                "MSIAGVAAQEIRVPLKTGFLHNGRAMGNMRKTYWSSRSEFKNNFLNIDPITMAYSLNSSAQERLIPLGHASKSAPMNGHCFAENGPSQKSSLPPLLIPPSENLGPHEEDQVVCGFKKLTVNGVCASTPPLTPIKNSPSLFPCAPLCERGSRPLPPLPISEALSLDDTDCEVEFLTSSDTDFLLEDSTLSDFKYDVPGRRSFRGCGQINYAYFDTPAVSAADLSYVSDQNGGVPDPNPPPPQTHRRLRRSHSGPAGSFNKPAIRISNCCIHRASPNSDEDKPEVPPRVPIPPRPVKPDYRRWSAEVTSSTYSDEDRPPKVPPREPLSPSNSRTPSPKSLPSYLNGVMPPTQSFAPDPKYVSSKALQRQNSEGSASKVPCILPIIENGKKVSSTHYYLLPERPPYLDKYEKFFREAEETNGGAQIQPLPADCGISSATEKPDSKTKMDLGGHVKRKHLSYVVSP*";
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_061821.1",
                "NM_018948.3:c.1060_1061del", cdsSequence, aaSequence, 1060, 1061, 354, "P", "*", "", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_061821.1:p.(Pro354Ter)", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_DeletionInsertion()
        {
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("ENSP00000343890.4",
                "ENST00000343938.4:c.10_15delinsGAGACA", CdsSequence, AaSequence, 10, 15, 4, "SE", "ET", "GAGACA",
                false, AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("ENSP00000343890.4:p.(Ser4_Glu5delinsGluThr)", actualResult);
        }
        
        [Fact]
        public void GetHgvsProteinAnnotation_DeletionInsertion_TerminalCodon()
        {
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_003001.1",
                "NM_003010.3:c.494_495insAG", CdsSequence, AaSequence, 495, 494, 165, "Y", "*X", "AG",
                false, AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_003001.1:p.(Tyr165Ter)", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_Extension_ViaDeletion()
        {
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("ENSP00000343890.4",
                "ENST00000343938.4:c.643_645del", CdsSequence, AaSequence, 643, 645, 215, "*", "", "", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("ENSP00000343890.4:p.(Ter215GlyextTer43)", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_Extension_ViaDeletion_CodonBug()
        {
            const string cdsSequence =
                "ATGCTCTTTCAGTCTCACATGGCAACGAAAACAACTTGTATGTCTTCACAAGGATCAGATGATGAACAGATAAAAAGAGAAAACATTCGTTCGTTGACTATGTCTGGCCATGTTGGTTTTGAGAGTTTGCCTGATCAGCTGGTGAACAGATCCATTCAGCAAGGTTTCTGCTTTAATATTCTCTGTGTGGGGGAAACTGGAATTGGAAAATCAACACTGATTGACACATTGTTTAATACTAATTTTGAAGACTATGAATCCTCACATTTTTGCCCAAATGTTAAACTTAAAGCTCAGACATATGAACTCCAGGAAAGTAATGTTCAATTGAAATTGACCATTGTGAATACAGTGGGATTTGGTGACCAAATAAATAAAGAAGAGAGCTACCAACCAATAGTTGACTACATAGATGCTCAGTTTGAGGCCTATCTCCAAGAAGAACTGAAGATTAAGCGTTCTCTCTTTACCTACCATGATTCTCGCATCCATGTGTGTCTCTACTTCATTTCACCGACAGGCCACTCTCTGAAGACACTTGATCTCTTAACCATGAAGAACCTTGACAGCAAGGTAAACATTATACCAGTGATTGCCAAAGCAGATACGGTTTCTAAAACTGAATTACAGAAGTTTAAGATCAAGCTCATGAGTGAATTGGTCAGCAATGGCGTCCAGATATACCAGTTCCCAACGGATGATGACACTATTGCTAAGGTCAACGCTGCAATGAATGGACAGTTGCCGTTTGCTGTTGTGGGAAGTATGGATGAGGTAAAAGTCGGAAACAAGATGGTCAAAGCTCGCCAGTACCCTTGGGGTGTTGTACAAGTGGAAAATGAAAACCACTGTGACTTTGTAAAGCTGCGGGAAATGCTCATTTGTACAAATATGGAGGACCTGCGAGAGCAGACCCATACCAGGCACTATGAGCTTTACAGGCGCTGCAAACTGGAGGAAATGGGCTTTACAGATGTGGGCCCAGAAAACAAGCCAGTCAGTGTTCAAGAGACCTATGAAGCCAAAAGACATGAGTTCCATGGTGAACGTCAGAGGAAGGAAGAAGAAATGAAACAGATGTTTGTGCAGCGAGTAAAGGAGAAAGAAGCCATATTGAAAGAAGCTGAGAGAGAGCTACAGGCCAAATTTGAGCACCTTAAGAGACTTCACCAAGAAGAGAGAATGAAGCTTGAAGAAAAGAGAAGACTTTTGGAAGAAGAAATAATTGCTTTCTCTAAAAAGAAAGCTACCTCCGAGATATTTCACAGCCAGTCCTTTCTGGCAACAGGCAGCAACCTGAGGAAGGACAAGGACCGTAAGAAGTAAGAGGCCCAGCCACCCTCCCTGGCAGCCCTGCCCACACTTGTCACATTGCCCTGTCGGATCTTCCTAGCGCTTCTTACTTCTGCTTCCTTATGCTTTGTCTTCCTTCTCCAACTAAATGTCAGCTCCTGGAGAGGAGAGACCTTGTCCCTCTTGTTCACTGCTGTTTCCCCAGCATCCAGAACAGCACCTGGCACATGTTATGTGTTCAGTATTTGCCAAAATGAATGAATGAACAAAATAAAAATACATCACAGTGTGAAAAGGATCAGTTAGCTGGGGGAAAATGGCTGCTCTTATTGAATAGCCCAGCCGTGGCCCTAGTACACAGCTAATGGCTGCTGACCTACCATGAGTTATTTTGAATTTCATGTCTAAATAAAGCTGTGCCCTTTGTTGGGGAATTATAGACATAAGATAGTATTTTATTGAATTAATTCTTAGGTTCAGTTTTTTAGAACAAATTCTACTGATACTGATTTTGTGAGAATTTTTATTTTAATAAGGGAACCAGGCTGTCGATTCGAACTCCTGTGCATTGATGTCAGAGCTTGTGAAACCAATGGTGGACGTAAAGACGCAGAGAAAGGTAGAGAGGGCCACAGTGCAAGGGGGCAGCCATGAGTAGCATGTGGATGATAATCGCAAGGCGTGTAGGTTTGGGGTATGTGTTAAAATCAGTTACCCAAGTTTTAGAAAATAAGTTTATTTTTCCTTTTTGATAATTTCCTTCTGTACTTTGTGTCCCTTGTTTTATTTCTCCCACTTAAGTATCCCTGTCGGTTTAACTATTTGGCTCTTGAGGAAATTCATCATGCCTTGTTCTATTCAGAATGCTCATTTGGGGGACTCTGCCTCAGTTTACTCTAGCTACCTCTGTGCTAGCAGCGTTGCATGCTCCCATGTTCCCCACAGAGCAACACATCTGGTTTAATGCTCTCACTGCATCTATTTCAGACCCATTTTCAGAATATTGCAACTCAACTTTAAAATAGGAAAACATAACCTTGGCCCATTGGTGGCTTTCAATTTTTAAATATGGAGAAGTAAACCACAGGACTTTGGCAGATTTTATTGGCTTATATATTTTACAGGTATTTTTGTTTGTTTGTTTGTTTTTTTGGAAAAGAGGAAGGAATTCTCATGTATGATCTTTCAATGCAAGCTCTCCAAGGGCATGGATCTTTATCTTGTTCATTGATATAGCCATCCCCAGAGCCTAGAGCAGTTGTCTGGTACATAGTAGGCATGCAATTATTTTTGAAAGAATAAATAGTATAAAAGCTGTATTTTATTCAAGCATTGAATTTAGAAAGATAAACTATAAATTTATTACTGCTTTTCAACATGCTTTGGATTTTAAAGCTAATGGATCTTTTATTAATACCTTTTTTCCTTTCATCTTAACCCAGTGTTACTAAAATTAGATTTCCCATTTTTTCCCCTATATGAAAGATAATTTACATTTACCTTGTAAAAATTATCACCCTGCTCCACTTGAGAACCCTGCTGTTGTTTGCAAAATCAGGACCAAGCCCATATTTTTTGAGAGCTCTCTAGAAGAATTTATCTTCAAGAAAATATGGTTTGGTGTTTTTGGTTTTTTCTTTTCTTTTTCAAAGTCCCATGGCCAGATATCCTATAATATACTAGATGCATGTTTGCTAATTTTTACTTGAATTTTTTTTAAATTGTACCAATCAAAAGGTTCTTTTTCTTTCCAGCTCCAATTTTTTGTAAAACAGAAGTTCCAGAGCACAGAAGGTCATCATCACAAGCAAACTTTATTAAAAAAAAACTAGAAGTGTGCTTTGATTTTGCTGTTATTTGTTTTATCACTTCTATATTTGGTGAACAGCCACAGTTACTGATATTTATGGAAAAGTACTTTCAAGTACAAGGTCAATACATAAGCCAGAGTGAATGATACTACAAGTTGAGCATCTCTAATTCAAAAATCTGAAATCCAGAAGCTTCAAAATCTGAATCTTTTTGAGCACTGACTTGACCCCACAAGTGGAAAATTCCCCACCCGACACCTTTGCTTTCTGATGGTTCAGTTTAAACAGATTTTGTTTCTTGCACAAAATTTTTGTATAAATTACTTTCAGGCTATATGTATAAGGTGGATGTGAAACATGAATTATGTAATTAGAGTCGGGTCCCGTTGTGTATATGCAGATATTCCAAACCTGAAATCCAAAACACTTCTGGTCCCTAGCATTTTGGATAAGGGATACTCAGCTTGTACCTATATATTCATATATATTCACTGTTGTTAGAAATGTTTAAGTTGCTGTTCTGTGATGAATCTAAATCTTTTCTCTTGCTACCAAGCTATTGTCACTGCAGTGCATTATACCAAAGAGCGAAGTCAGTGCCACTGAAAATACAGAACCCATTAATATCGTGGCTATCTGATTACATTTATATTCCAAGATGAACCTTTTTTATATATGCTAAAAATTTTGGGGAATATGTTTTGGGATGTATTATGGAGCTAAAACTCTAACCTCTTAATAGTTTTATAGAACTTAAAAATTTTTTATACAATTACCCAATTGGTGATATGATCTTAAGCTTTTGTGTCAGATTATTTAATATGATGACTTCATGCTTTATTATGCCTTATTATGGCTGACGTATTACTGTGGTGAAACAAAATATCTTTAAAAGTTAAAACATCCAGATATATAAGCTATTTTTTCCTAAGGATAAAGTACCTTTGAGCATGAGTGTATCACAGCTTTCATTAGGAAAACTTTTCATTACATACTTGTTTAAACTCTGTCTTCCAGGGTAAAAATAATAAGGTTGAATCATTTTATTAAAAATACTTTTTAAGAAAATAACTATGAACATCTGAATATTAAAGATATAAAAATGCACATAATTCATATTTCAGGTGGTATTTGCATTCAGTGCCTTACTGGTATTCTCAGAACATTTTAATGATTTCTAACATTTCTTAACAGTCATAGATATATACATTTTCATTTTTTGTACTTGAATATTCTAAATAAAACTGACATTTACTCTTGACAAATAAAACATATATTTACTAAAATGTGTTTAATTTTCCTTTCTGAAAACTCTCATTTTAAAAACGTTCATTTAATTATGTATTTGAATTATTTTGGAGATGAGGTATTTTATGAGTATTTTCAGACAATGAAACTTATTAGTCTGTGTCAGATTCTGAGCAATCATAGAGTCATCTAAGTTGTAAATAAAACCTTGCATAGCACAATT";
            const string aaSequence =
                "MLFQSHMATKTTCMSSQGSDDEQIKRENIRSLTMSGHVGFESLPDQLVNRSIQQGFCFNILCVGETGIGKSTLIDTLFNTNFEDYESSHFCPNVKLKAQTYELQESNVQLKLTIVNTVGFGDQINKEESYQPIVDYIDAQFEAYLQEELKIKRSLFTYHDSRIHVCLYFISPTGHSLKTLDLLTMKNLDSKVNIIPVIAKADTVSKTELQKFKIKLMSELVSNGVQIYQFPTDDDTIAKVNAAMNGQLPFAVVGSMDEVKVGNKMVKARQYPWGVVQVENENHCDFVKLREMLICTNMEDLREQTHTRHYELYRRCKLEEMGFTDVGPENKPVSVQETYEAKRHEFHGERQRKEEEMKQMFVQRVKEKEAILKEAERELQAKFEHLKRLHQEERMKLEEKRRLLEEEIIAFSKKKATSEIFHSQSFLATGSNLRKDKDRKK*";
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_001308442.1",
                "NM_001321513.1:c.1324_1326del", cdsSequence, aaSequence, 1324, 1326, 442, "*", "", "", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_001308442.1:p.(Ter442GluextTer75)", actualResult);
        }
        
        [Fact]
        public void GetHgvsProteinAnnotation_Extension_ViaDeletion_MissingOutput()
        {
            // VID: chr1-16265921-GAG-G (NC_000001.10:g.16265922_16265923del), key: NM_015001.2, expected: NP_055816.2:p.(Ter3665CysextTer2), actual:
            const string cdsSequence =
                "ATGGTCCGGGAAACCAGGCATCTCTGGGTGGGCAACTTACCCGAGAACGTGCGGGAAGAGAAGATCATCGAGCATTTCAAACGATATGGCCGCGTGGAAAGTGTCAAAATTCTTCCCAAGAGGGGATCTGAAGGAGGAGTGGCTGCCTTTGTGGATTTTGTGGACATCAAAAGTGCACAGAAAGCTCACAACTCGGTCAACAAAATGGGTGACAGAGACCTACGCACGGATTATAATGAACCAGGCACCATCCCGAGTGCTGCTCGGGGATTGGATGATACAGTTTCCATAGCATCTCGTAGTAGAGAGGTTTCTGGGTTCAGAGGAGGTGGTGGAGGGCCTGCTTATGGTCCCCCACCGTCACTTCATGCACGAGAAGGACGTTATGAGCGGAGACTTGATGGGGCTTCAGATAACAGGGAGCGTGCTTATGAACATAGTGCCTATGGACACCATGAACGGGGGACGGGAGGATTTGATCGGACAAGACATTACGATCAGGATTACTATAGAGATCCTCGAGAGCGGACTTTACAACATGGGCTCTATTACGCTTCTCGGAGTCGAAGTCCAAATCGCTTTGATGCTCATGACCCCCGATATGAACCTAGGGCTCGCGAGCAGTTTACACTGCCCAGTGTGGTACACAGGGATATCTACAGGGATGATATTACCCGGGAGGTACGAGGCAGAAGGCCAGAGCGGAATTACCAGCACAGCAGGAGTCGGTCACCACATTCATCCCAGTCTAGAAATCAGTCTCCTCAGAGACTGGCTAGCCAAGCATCTAGACCCACAAGGTCCCCTAGCGGCAGCGGCTCTAGAAGTAGATCCTCCAGTAGTGATTCAATCAGCAGCAGCAGTAGTACCAGCAGTGACAGCAGTGATTCCAGCAGTAGTTCAAGTGATGATTCTCCAGCTCGATCAGTTCAGTCTGCAGCAGTCCCTGCACCCACTTCCCAGTTGCTTTCATCTCTGGAAAAAGATGAGCCCCGTAAAAGTTTTGGCATCAAGGTCCAGAATCTTCCAGTACGCTCTACAGATACAAGCCTTAAAGATGGCCTTTTCCATGAATTTAAGAAATTTGGAAAAGTAACTTCAGTGCAGATACATGGAACTTCAGAAGAGAGGTATGGTCTGGTATTCTTTCGGCAGCAAGAGGACCAAGAAAAAGCCTTGACTGCATCAAAAGGAAAACTTTTCTTTGGCATGCAGATTGAAGTAACAGCATGGATAGGTCCAGAAACAGAAAGTGAAAATGAATTTCGCCCCTTGGATGAAAGGATAGATGAATTTCACCCCAAAGCAACAAGAACTCTCTTTATTGGCAACCTTGAAAAAACCACTACTTACCATGACCTTCGCAACATCTTCCAGCGCTTTGGAGAAATTGTGGATATTGACATTAAGAAAGTAAATGGAGTTCCTCAGTATGCGTTTCTGCAATACTGTGATATTGCTAGCGTTTGTAAAGCTATTAAGAAGATGGATGGGGAATATCTTGGAAATAATCGCCTCAAGCTGGGTTTTGGAAAGAGCATGCCTACAAACTGCGTGTGGCTAGATGGGCTTTCTTCGAATGTGTCAGATCAGTATTTAACACGACATTTCTGCCGATATGGGCCTGTGGTAAAGGTGGTGTTTGACCGCTTAAAAGGCATGGCCCTGGTTCTCTACAATGAAATTGAATATGCACAAGCAGCTGTAAAAGAGACCAAAGGGAGGAAAATCGGTGGGAATAAAATTAAGGTGGATTTTGCAAATCGGGAAAGTCAGCTGGCTTTTTATCACTGCATGGAGAAATCTGGTCAAGACATCAGAGACTTTTATGAAATGTTAGCCGAAAGAAGAGAGGAACGAAGGGCATCCTACGACTATAACCAAGATCGTACATATTATGAGAGTGTTCGAACTCCAGGCACTTATCCTGAGGATTCCAGGCGGGACTATCCAGCTCGAGGGAGAGAGTTTTATTCAGAATGGGAAACTTACCAAGGAGACTACTATGAATCACGATACTACGATGATCCTCGGGAATACAGGGATTACAGGAATGATCCTTATGAACAAGATATTAGGGAATATAGTTACAGGCAAAGGGAACGAGAAAGAGAACGTGAAAGATTTGAGTCTGACCGGGACAGAGACCATGAGAGGAGGCCGATTGAACGAAGTCAAAGTCCTGTTCACTTGCGACGTCCACAGAGTCCTGGAGCGTCTCCCTCTCAGGCAGAGAGGTTGCCGAGTGATTCTGAGAGGAGGCTTTACAGCCGATCCTCAGACCGGAGTGGAAGCTGTAGCTCACTCTCCCCTCCAAGATATGAGAAACTGGACAAGTCTCGTTTGGAGCGCTATACAAAAAATGAAAAGACAGATAAAGAACGAACTTTTGATCCGGAGAGAGTGGAGAGAGAGAGACGCTTAATACGGAAGGAAAAAGTGGAAAAGGACAAAACTGACAAGCAGAAACGCAAAGGAAAGGTTCACTCCCCTAGTTCTCAGTCTTCAGAAACGGACCAAGAAAATGAGCGAGAGCAAAGCCCTGAAAAGCCCAGGAGTTGTAATAAACTGAGCAGAGAGAAAGCTGACAAAGAGGGAATAGCGAAAAACCGCCTGGAACTCATGCCTTGCGTGGTTTTGACTCGAGTGAAAGAGAAAGAGGGAAAGGTCATTGACCACACTCCTGTGGAAAAGTTGAAAGCCAAGCTTGATAATGACACTGTCAAATCTTCTGCCCTGGACCAGAAACTTCAGGTCTCTCAGACGGAGCCTGCAAAATCTGACTTGTCTAAACTGGAATCAGTTAGAATGAAAGTACCAAAGGAAAAGGGGCTTTCAAGCCATGTTGAAGTGGTGGAGAAGGAAGGCAGGCTTAAAGCCAGGAAGCACCTCAAGCCTGAGCAGCCTGCAGATGGGGTAAGTGCTGTGGATCTGGAGAAGCTGGAAGCCAGGAAAAGGCGCTTTGCAGATTCCAATTTAAAAGCAGAAAAGCAAAAACCAGAGGTCAAGAAAAGCAGTCCAGAGATGGAGGATGCTCGCGTGCTTTCAAAAAAGCAGCCTGACGTGTCCTCTAGAGAGGTCATTCTGCTGAGGGAAGGAGAGGCTGAAAGAAAGCCTGTGAGGAAAGAAATTCTTAAAAGAGAATCTAAAAAAATCAAACTGGACAGACTTAATACTGTTGCCAGCCCCAAAGACTGTCAGGAGCTTGCCAGTATTTCTGTTGGGTCTGGCTCAAGGCCCAGCTCAGACCTACAAGCAAGACTGGGAGAACTAGCAGGTGAATCTGTGGAAAATCAAGAAGTCCAATCAAAAAAGCCCATTCCCTCAAAACCACAGCTCAAACAGCTGCAGGTATTAGATGATCAAGGACCAGAGAGAGAAGACGTTAGGAAAAACTATTGCAGTCTTCGTGATGAAACACCTGAACGTAAATCAGGCCAAGAGAAATCACATTCAGTAAATACTGAAGAAAAAATTGGCATTGACATCGATCACACGCAGAGTTACCGAAAACAAATGGAACAGAGTCGTAGGAAACAGCAGATGGAAATGGAAATAGCCAAGTCTGAGAAGTTTGGCAGTCCTAAAAAAGATGTAGATGAATATGAAAGACGTAGCCTCGTTCACGAGGTAGGCAAACCCCCTCAAGATGTCACTGATGACTCTCCTCCTAGCAAAAAGAAAAGGATGGATCATGTCGATTTTGATATCTGCACCAAGCGAGAACGGAATTACAGAAGTTCACGCCAAATCAGCGAAGATTCTGAAAGGACTGGTGGTTCTCCCAGTGTCCGACATGGTTCCTTCCATGAAGATGAGGATCCCATAGGCTCCCCTAGGCTACTGTCAGTAAAAGGGTCTCCTAAAGTAGATGAAAAAGTCCTCCCCTATTCTAACATAACAGTCAGGGAAGAGTCTTTAAAATTTAATCCTTATGATTCTAGCAGGAGAGAACAGATGGCAGATATGGCCAAAATAAAACTATCTGTCTTGAATTCTGAAGATGAACTAAATCGTTGGGACTCTCAGATGAAACAGGATGCTGGCAGATTTGATGTGAGTTTCCCAAACAGCATAATTAAGAGAGATAGCCTTCGAAAAAGGTCTGTACGAGATCTGGAACCTGGTGAGGTGCCTTCTGATTCTGACGAAGATGGTGAACACAAATCCCACTCACCCAGAGCCTCTGCATTATATGAAAGTTCTCGATTGTCTTTTTTATTGAGGGACAGAGAAGACAAGCTACGTGAGCGAGATGAAAGACTCTCTAGTTCTTTAGAAAGGAACAAATTTTACTCTTTTGCATTGGATAAGACAATCACACCAGACACTAAAGCTTTGCTTGAAAGAGCTAAATCCCTCTCTTCATCTCGTGAAGAAAATTGGTCTTTTCTTGATTGGGACTCCCGATTTGCAAATTTTCGAAACAACAAAGATAAAGAAAAGGTTGACTCTGCTCCAAGACCTATTCCATCCTGGTACATGAAAAAGAAGAAAATTAGGACTGATTCAGAAGGGAAAATGGATGATAAGAAAGAGGACCATAAAGAAGAAGAGCAAGAGAGGCAGGAATTGTTTGCTTCTCGTTTTTTACACAGCTCAATCTTTGAACAAGATTCCAAGCGATTGCAGCATCTAGAGAGAAAAGAGGAAGATTCTGACTTCATTTCTGGTAGGATCTATGGGAAGCAGACATCTGAGGGAGCAAACAGCACAACTGATTCCATTCAAGAACCAGTAGTTCTGTTCCATAGCAGATTTATGGAGCTCACACGGATGCAACAGAAAGAAAAAGAAAAAGACCAGAAACCCAAAGAGGTTGAGAAACAGGAAGATACAGAGAATCATCCCAAGACCCCAGAATCTGCTCCTGAGAATAAAGATTCAGAACTGAAAACTCCACCTTCCGTTGGGCCTCCAAGTGTCACAGTCGTAACTCTAGAATCAGCCCCATCAGCACTAGAGAAGACCACTGGTGACAAAACGGTAGAGGCGCCTTTGGTAACAGAAGAGAAGACTGTGGAGCCAGCTACCGTCTCAGAAGAAGCAAAGCCTGCATCTGAACCTGCTCCTGCCCCTGTGGAACAGCTGGAACAAGTAGACCTGCCCCCAGGAGCAGACCCCGATAAAGAAGCTGCCATGATGCCTGCGGGTGTTGAGGAAGGTTCATCAGGTGACCAGCCGCCTTATCTGGATGCCAAGCCTCCAACTCCCGGGGCCTCGTTTTCCCAGGCAGAGAGCAACGTAGATCCAGAGCCTGACAGTACCCAGCCACTTTCAAAACCAGCTCAGAAGTCTGAGGAAGCCAATGAGCCAAAGGCCGAAAAGCCAGACGCCACTGCAGATGCTGAGCCTGATGCAAACCAGAAAGCCGAAGCTGCTCCTGAGTCTCAGCCCCCAGCTTCTGAAGATTTAGAGGTTGATCCTCCAGTTGCTGCAAAGGATAAAAAGCCAAACAAAAGCAAGCGTTCAAAGACCCCTGTTCAGGCAGCTGCAGTGAGTATCGTGGAGAAGCCCGTCACAAGGAAGAGTGAGAGGATAGACCGGGAAAAACTCAAGCGGTCCAATTCTCCTCGGGGAGAAGCACAGAAGCTTTTGGAATTGAAGATGGAGGCAGAGAAGATTACAAGGACTGCTTCTAAAAACTCTGCTGCAGACCTTGAACATCCCGAACCAAGTTTGCCTCTCAGCCGAACAAGGCGCCGGAATGTAAGGAGCGTCTATGCAACCATGGGTGACCATGAAAACCGCTCTCCTGTCAAAGAGCCCGTTGAGCAACCAAGAGTGACCAGAAAGAGATTGGAGCGAGAGCTTCAGGAGGCTGCAGCGGTTCCCACCACCCCTCGGAGGGGAAGGCCTCCAAAGACACGCCGGCGAGCCGATGAAGAGGAGGAGAACGAGGCCAAGGAACCTGCAGAAACACTCAAGCCACCTGAGGGATGGCGGTCGCCAAGGTCCCAGAAAACTGCAGCTGGTGGTGGACCCCAAGGGAAAAAGGGAAAAAATGAACCGAAGGTGGATGCTACACGTCCTGAGGCCACCACTGAGGTGGGCCCCCAAATAGGCGTGAAAGAGAGCTCCATGGAACCCAAGGCTGCTGAGGAGGAGGCAGGGAGTGAACAGAAACGTGACAGAAAAGATGCTGGCACAGACAAAAACCCCCCTGAAACCGCCCCTGTTGAAGTTGTAGAGAAAAAACCGGCCCCTGAAAAAAACTCCAAATCAAAGAGAGGAAGATCTCGAAACTCCAGGTTAGCAGTGGACAAATCTGCAAGTCTGAAAAATGTGGATGCTGCTGTCAGTCCCAGGGGGGCTGCAGCACAGGCAGGGGAGAGGGAATCTGGGGTGGTGGCAGTCTCCCCTGAGAAAAGTGAGAGTCCCCAAAAGGAGGATGGTTTATCATCCCAGTTGAAAAGTGATCCAGTTGATCCAGACAAGGAACCAGAGAAAGAAGACGTGTCTGCCTCTGGGCCGTCCCCAGAAGCCACCCAGTTAGCCAAGCAGATGGAGCTGGAGCAGGCCGTGGAACACATCGCAAAGCTCGCTGAGGCCTCTGCCTCTGCTGCCTATAAGGCAGATGCACCAGAGGGCCTTGCCCCAGAGGACAGGGACAAGCCTGCACACCAAGCAAGTGAAACAGAGCTGGCTGCGGCCATCGGCTCCATCATCAATGACATTTCTGGGGAGCCAGAAAACTTCCCAGCACCTCCACCTTATCCTGGAGAATCCCAGACAGATCTGCAACCCCCCGCAGGTGCACAGGCGCTGCAGCCTTCTGAGGAAGGAATGGAGACAGATGAGGCTGTATCTGGCATCCTGGAAACTGAGGCTGCTACAGAATCTTCTAGGCCTCCAGTCAATGCTCCTGACCCCTCAGCCGGCCCAACAGATACCAAGGAAGCCAGAGGAAATAGCAGTGAAACCTCACACTCAGTGCCAGAAGCCAAAGGGTCTAAAGAAGTGGAAGTCACTCTTGTTCGGAAAGACAAAGGGCGCCAGAAAACAACCCGATCACGCCGCAAGCGAAACACAAACAAGAAAGTGGTGGCTCCTGTAGAGAGCCATGTCCCTGAATCCAACCAAGCTCAAGGTGAGAGTCCTGCTGCAAATGAGGGGACAACAGTACAGCACCCCGAAGCCCCACAGGAAGAAAAGCAGAGTGAGAAACCCCATTCCACTCCTCCTCAGTCATGTACTTCTGACCTAAGCAAGATTCCCTCCACAGAGAATTCGTCCCAAGAAATCAGTGTTGAGGAAAGGACTCCAACCAAAGCATCTGTGCCCCCAGACCTTCCCCCACCTCCCCAGCCAGCACCGGTGGATGAGGAGCCTCAAGCCAGGTTCAGGGTGCATTCCATCATTGAAAGTGACCCGGTGACCCCACCCAGCGATCCAAGCATCCCCATACCCACACTGCCTTCTGTAACTGCAGCAAAGCTCTCACCTCCTGTCGCCTCTGGGGGGATCCCACACCAGAGCCCCCCTACTAAGGTGACAGAGTGGATCACAAGGCAGGAGGAGCCACGGGCTCAGTCTACTCCATCTCCAGCTCTTCCCCCAGACACAAAGGCCTCTGATGTTGACACCAGCTCCAGCACCCTGAGGAAGATTCTCATGGACCCCAAGTATGTGTCTGCCACAAGTGTCACTTCCACAAGTGTCACCACAGCCATTGCAGAGCCTGTCAGTGCTGCCCCTTGCCTACATGAGGCCCCGCCCCCGCCAGTTGACTCTAAAAAGCCTTTAGAAGAAAAAACAGCACCTCCAGTGACAAACAACTCTGAGATACAAGCCTCGGAGGTGCTGGTAGCTGCTGACAAGGAAAAGGTGGCTCCAGTCATTGCTCCCAAAATTACCTCTGTTATTAGCCGGATGCCTGTCAGCATTGACCTGGAAAATTCACAGAAGATAACCTTGGCAAAACCAGCTCCTCAAACCCTCACTGGTCTGGTGAGCGCACTCACTGGCCTGGTGAACGTCTCCCTGGTCCCGGTGAATGCCCTGAAAGGCCCCGTGAAGGGCTCAGTGACCACACTGAAAAGTTTGGTGAGCACCCCTGCTGGGCCCGTGAACGTCCTGAAAGGGCCTGTGAATGTTCTTACGGGGCCAGTGAATGTTCTCACCACTCCAGTGAACGCCACGGTGGGCACAGTGAATGCCGCCCCAGGCACAGTCAATGCCGCTGCGAGTGCAGTGAATGCCACAGCAAGTGCAGTGACCGTCACAGCGGGTGCGGTTACTGCTGCATCTGGTGGTGTAACGGCCACAACAGGCACGGTGACAATGGCAGGGGCAGTGATTGCGCCGTCAACAAAGTGCAAACAGAGAGCGAGTGCTAATGAAAACAGTCGGTTCCACCCAGGGTCCATGCCTGTGATCGACGATCGTCCGGCAGACGCGGGCTCAGGGGCGGGGCTGCGTGTGAACACTTCTGAAGGGGTTGTGCTCCTGAGTTACTCAGGGCAGAAGACCGAAGGCCCACAGCGGATCAGCGCCAAGATCAGCCAGATCCCCCCGGCCAGTGCAATGGACATTGAATTTCAGCAGTCAGTGTCCAAGTCCCAGGTCAAACCTGATTCTGTCACAGCATCGCAGCCTCCATCCAAAGGCCCTCAAGCTCCTGCAGGCTATGCGAACGTGGCCACCCATTCCACGTTGGTACTGACCGCCCAGACATATAATGCCTCTCCTGTGATTTCGTCTGTGAAGGCCGATAGGCCATCCTTGGAGAAGCCCGAGCCCATTCACCTCTCGGTGTCCACGCCTGTCACCCAGGGAGGCACAGTGAAGGTTCTCACCCAGGGGATCAACACACCCCCTGTGCTGGTTCACAACCAGCTGGTCCTCACCCCAAGCATTGTCACCACAAACAAGAAGCTTGCTGACCCCGTCACCCTTAAAATCGAGACCAAGGTCCTTCAGCCGGCCAACCTGGGGTCCACGCTCACGCCCCACCACCCTCCTGCTCTGCCCAGCAAACTGCCTACAGAAGTCAACCATGTCCCCTCGGGGCCCAGCATCCCAGCAGATCGAACTGTCTCCCATTTGGCAGCTGCAAAGCTAGATGCTCATTCTCCTCGACCAAGTGGACCCGGGCCATCCTCATTCCCAAGGGCAAGCCACCCCAGCAGTACTGCATCTACGGCGCTCTCCACCAACGCCACAGTCATGCTGGCTGCAGGCATCCCAGTGCCCCAGTTCATCTCCAGCATCCACCCAGAGCAGTCTGTCATCATGCCACCCCACAGCATCACCCAGACTGTGTCCCTGAGCCACCTCTCCCAGGGCGAGGTGAGAATGAACACTCCCACGCTGCCCAGTATCACCTACAGCATCCGGCCAGAAGCGCTTCACTCTCCTCGGGCTCCGCTGCAGCCCCAGCAAATAGAGGTCAGGGCCCCACAGCGTGCCAGCACCCCGCAGCCAGCCCCAGCTGGTGTGCCTGCACTGGCCTCCCAGCACCCTCCCGAGGAGGAAGTGCATTATCACCTTCCTGTCGCTCGAGCCACAGCCCCTGTGCAGTCAGAGGTACTAGTCATGCAGTCTGAGTACCGACTGCACCCCTATACTGTGCCACGGGATGTGAGGATCATGGTGCATCCACATGTGACGGCAGTCAGCGAGCAGCCCAGGGCCGCGGATGGGGTGGTGAAGGTGCCACCAGCCAGCAAGGCCCCTCAGCAGCCAGGGAAGGAAGCTGCCAAGACACCAGATGCCAAAGCTGCCCCCACCCCCACCCCTGCCCCCGTCCCTGTCCCTGTCCCCCTTCCTGCCCCTGCTCCTGCCCCTCATGGTGAGGCCCGTATCCTCACAGTTACCCCCAGTAACCAACTCCAGGGGCTGCCTCTGACCCCTCCTGTGGTGGTGACCCATGGGGTGCAGATTGTGCACTCCAGCGGGGAGCTGTTTCAAGAGTACCGGTACGGCGACATCCGCACCTACCACCCCCCGGCCCAGCTCACACACACTCAGTTTCCCGCCGCTTCCTCTGTTGGCCTGCCTTCCCGGACCAAGACAGCTGCTCAGGGCCCTCCTCCTGAAGGTGAGCCCCTGCAGCCTCCTCAGCCTGTGCAGTCCACACAGCCTGCCCAGCCTGCACCACCCTGCCCGCCCTCCCAGCTCGGTCAGCCCGGCCAGCCACCAAGCAGCAAGATGCCTCAAGTGTCCCAGGAGGCAAAGGGGACCCAGACGGGAGTAGAGCAGCCTCGCCTCCCAGCTGGACCTGCAAACAGGCCACCTGAGCCTCACACCCAGGTTCAGAGGGCACAAGCAGAAACAGGCCCGACTTCCTTCCCCTCCCCTGTGTCTGTCTCCATGAAGCCTGACCTTCCAGTCTCTCTTCCCACTCAGACTGCCCCAAAACAGCCGTTGTTTGTCCCAACAACCTCTGGCCCCAGCACCCCACCAGGACTGGTTCTGCCACACACTGAATTCCAGCCAGCCCCCAAACAAGATTCCTCTCCACACCTGACTTCCCAGAGACCCGTGGATATGGTTCAACTTCTGAAGAAGTACCCCATCGTGTGGCAGGGCCTGCTGGCCCTCAAGAATGACACAGCTGCTGTGCAGCTCCACTTCGTCTCTGGCAACAACGTCCTGGCCCATCGGTCCCTGCCCCTTTCTGAAGGAGGGCCCCCACTAAGGATCGCCCAGAGGATGCGGCTGGAGGCAACGCAGCTGGAAGGGGTTGCCCGAAGGATGACGGTGGAGACAGATTACTGTCTGCTGCTGGCTCTGCCCTGTGGCCGTGACCAAGAGGATGTTGTGAGCCAGACCGAGTCCCTCAAGGCTGCCTTCATCACTTACCTGCAGGCCAAGCAGGCGGCAGGGATCATCAACGTTCCCAACCCTGGCTCCAATCAGCCTGCCTACGTGCTGCAGATCTTCCCGCCCTGTGAGTTCTCTGAGAGTCACCTGTCCCGCCTGGCCCCTGACCTCCTTGCCAGCATCTCCAACATCTCTCCCCACCTCATGATTGTCATTGCCTCCGTGTGAGCCACTGAGTGGTTATCACCTCAGTGAATCTTCCCAGGGCTCTGCAGTAAAAACAAAGGACAACCCAGCCAAGCAGAGGAAGAAGCTGCCGAAGGGGACAGACTCCACTGCCAGACGGCCAGCCGTTTGCTGTCCTGCCGCCCGGCTCAGTCGGCCAGACTTCCTCTAGGAGTGGTGCTGCTACCTTGTATGTTTACATAATGCTTTAGCCCAAGGACACATCACCAACCCATGGACTCGCAGACACCGGGGCTGGGTTTCTCTTTCCTCTTTTTGGAGAAAAGGAACAGGGCAGTGGAATGAAAATTTTTTGTTTGTTTGTTTTTAAGAAACAAGAAAACAGAACTGCCTTTGCACTAAATTAGTGACTTGGACTTTTGCCCAGTGAAGACAGGCTGTGACACTCTGGATGTCTTGGTGTGTGTAGACACACATTGCAGACTCTTAACGCAGGAAGGACTTCAAACTTCTGCTGAGACCTTGGGGTCAAGGAACATTTCATTGGTTTTTTTTGTCCACCCCCATCTCCCTTGCTCATTTGGATGCGTCACCTTAATTCTCCTGCTGCCACCGTCTTTGATTCACCGGGATGTACAGTTTACAGTTGAAGAGCAAACAGAAAGGTTTTCTCTTGGTGGGATATGCAGAACTTGGGATGTGTGTATATATAAATATATAATATATATAAATATATATAATACTGACTTAAAAAATCAAATCCCCCGACATACGTTTTTTTTAATCTGTGCCAAAAATGTGTTTTCAGAGGAAATCTTATTTTCATATTCAGACTTTGTATTGCCCACTCATTTGTATAAGTGCGCTTCGGTACAGCACGGGTCCTGCTCCCGCGATGTGGAAGTGTCACACGGCACCTGTACAAAAAGACTGGCTAACCCCTCTTCCTATTACCTTGATCTCTTCCCCCAACTTCCTAACACTTATTAATTTATGAAACTGTTTTTCTCAGCGCAGTTTTGTTTTGTGTGTCCATTGGATTACAAACTTTATTAAAAAATATAAAACAC";
            const string aaSequence =
                "MVRETRHLWVGNLPENVREEKIIEHFKRYGRVESVKILPKRGSEGGVAAFVDFVDIKSAQKAHNSVNKMGDRDLRTDYNEPGTIPSAARGLDDTVSIASRSREVSGFRGGGGGPAYGPPPSLHAREGRYERRLDGASDNRERAYEHSAYGHHERGTGGFDRTRHYDQDYYRDPRERTLQHGLYYASRSRSPNRFDAHDPRYEPRAREQFTLPSVVHRDIYRDDITREVRGRRPERNYQHSRSRSPHSSQSRNQSPQRLASQASRPTRSPSGSGSRSRSSSSDSISSSSSTSSDSSDSSSSSSDDSPARSVQSAAVPAPTSQLLSSLEKDEPRKSFGIKVQNLPVRSTDTSLKDGLFHEFKKFGKVTSVQIHGTSEERYGLVFFRQQEDQEKALTASKGKLFFGMQIEVTAWIGPETESENEFRPLDERIDEFHPKATRTLFIGNLEKTTTYHDLRNIFQRFGEIVDIDIKKVNGVPQYAFLQYCDIASVCKAIKKMDGEYLGNNRLKLGFGKSMPTNCVWLDGLSSNVSDQYLTRHFCRYGPVVKVVFDRLKGMALVLYNEIEYAQAAVKETKGRKIGGNKIKVDFANRESQLAFYHCMEKSGQDIRDFYEMLAERREERRASYDYNQDRTYYESVRTPGTYPEDSRRDYPARGREFYSEWETYQGDYYESRYYDDPREYRDYRNDPYEQDIREYSYRQRERERERERFESDRDRDHERRPIERSQSPVHLRRPQSPGASPSQAERLPSDSERRLYSRSSDRSGSCSSLSPPRYEKLDKSRLERYTKNEKTDKERTFDPERVERERRLIRKEKVEKDKTDKQKRKGKVHSPSSQSSETDQENEREQSPEKPRSCNKLSREKADKEGIAKNRLELMPCVVLTRVKEKEGKVIDHTPVEKLKAKLDNDTVKSSALDQKLQVSQTEPAKSDLSKLESVRMKVPKEKGLSSHVEVVEKEGRLKARKHLKPEQPADGVSAVDLEKLEARKRRFADSNLKAEKQKPEVKKSSPEMEDARVLSKKQPDVSSREVILLREGEAERKPVRKEILKRESKKIKLDRLNTVASPKDCQELASISVGSGSRPSSDLQARLGELAGESVENQEVQSKKPIPSKPQLKQLQVLDDQGPEREDVRKNYCSLRDETPERKSGQEKSHSVNTEEKIGIDIDHTQSYRKQMEQSRRKQQMEMEIAKSEKFGSPKKDVDEYERRSLVHEVGKPPQDVTDDSPPSKKKRMDHVDFDICTKRERNYRSSRQISEDSERTGGSPSVRHGSFHEDEDPIGSPRLLSVKGSPKVDEKVLPYSNITVREESLKFNPYDSSRREQMADMAKIKLSVLNSEDELNRWDSQMKQDAGRFDVSFPNSIIKRDSLRKRSVRDLEPGEVPSDSDEDGEHKSHSPRASALYESSRLSFLLRDREDKLRERDERLSSSLERNKFYSFALDKTITPDTKALLERAKSLSSSREENWSFLDWDSRFANFRNNKDKEKVDSAPRPIPSWYMKKKKIRTDSEGKMDDKKEDHKEEEQERQELFASRFLHSSIFEQDSKRLQHLERKEEDSDFISGRIYGKQTSEGANSTTDSIQEPVVLFHSRFMELTRMQQKEKEKDQKPKEVEKQEDTENHPKTPESAPENKDSELKTPPSVGPPSVTVVTLESAPSALEKTTGDKTVEAPLVTEEKTVEPATVSEEAKPASEPAPAPVEQLEQVDLPPGADPDKEAAMMPAGVEEGSSGDQPPYLDAKPPTPGASFSQAESNVDPEPDSTQPLSKPAQKSEEANEPKAEKPDATADAEPDANQKAEAAPESQPPASEDLEVDPPVAAKDKKPNKSKRSKTPVQAAAVSIVEKPVTRKSERIDREKLKRSNSPRGEAQKLLELKMEAEKITRTASKNSAADLEHPEPSLPLSRTRRRNVRSVYATMGDHENRSPVKEPVEQPRVTRKRLERELQEAAAVPTTPRRGRPPKTRRRADEEEENEAKEPAETLKPPEGWRSPRSQKTAAGGGPQGKKGKNEPKVDATRPEATTEVGPQIGVKESSMEPKAAEEEAGSEQKRDRKDAGTDKNPPETAPVEVVEKKPAPEKNSKSKRGRSRNSRLAVDKSASLKNVDAAVSPRGAAAQAGERESGVVAVSPEKSESPQKEDGLSSQLKSDPVDPDKEPEKEDVSASGPSPEATQLAKQMELEQAVEHIAKLAEASASAAYKADAPEGLAPEDRDKPAHQASETELAAAIGSIINDISGEPENFPAPPPYPGESQTDLQPPAGAQALQPSEEGMETDEAVSGILETEAATESSRPPVNAPDPSAGPTDTKEARGNSSETSHSVPEAKGSKEVEVTLVRKDKGRQKTTRSRRKRNTNKKVVAPVESHVPESNQAQGESPAANEGTTVQHPEAPQEEKQSEKPHSTPPQSCTSDLSKIPSTENSSQEISVEERTPTKASVPPDLPPPPQPAPVDEEPQARFRVHSIIESDPVTPPSDPSIPIPTLPSVTAAKLSPPVASGGIPHQSPPTKVTEWITRQEEPRAQSTPSPALPPDTKASDVDTSSSTLRKILMDPKYVSATSVTSTSVTTAIAEPVSAAPCLHEAPPPPVDSKKPLEEKTAPPVTNNSEIQASEVLVAADKEKVAPVIAPKITSVISRMPVSIDLENSQKITLAKPAPQTLTGLVSALTGLVNVSLVPVNALKGPVKGSVTTLKSLVSTPAGPVNVLKGPVNVLTGPVNVLTTPVNATVGTVNAAPGTVNAAASAVNATASAVTVTAGAVTAASGGVTATTGTVTMAGAVIAPSTKCKQRASANENSRFHPGSMPVIDDRPADAGSGAGLRVNTSEGVVLLSYSGQKTEGPQRISAKISQIPPASAMDIEFQQSVSKSQVKPDSVTASQPPSKGPQAPAGYANVATHSTLVLTAQTYNASPVISSVKADRPSLEKPEPIHLSVSTPVTQGGTVKVLTQGINTPPVLVHNQLVLTPSIVTTNKKLADPVTLKIETKVLQPANLGSTLTPHHPPALPSKLPTEVNHVPSGPSIPADRTVSHLAAAKLDAHSPRPSGPGPSSFPRASHPSSTASTALSTNATVMLAAGIPVPQFISSIHPEQSVIMPPHSITQTVSLSHLSQGEVRMNTPTLPSITYSIRPEALHSPRAPLQPQQIEVRAPQRASTPQPAPAGVPALASQHPPEEEVHYHLPVARATAPVQSEVLVMQSEYRLHPYTVPRDVRIMVHPHVTAVSEQPRAADGVVKVPPASKAPQQPGKEAAKTPDAKAAPTPTPAPVPVPVPLPAPAPAPHGEARILTVTPSNQLQGLPLTPPVVVTHGVQIVHSSGELFQEYRYGDIRTYHPPAQLTHTQFPAASSVGLPSRTKTAAQGPPPEGEPLQPPQPVQSTQPAQPAPPCPPSQLGQPGQPPSSKMPQVSQEAKGTQTGVEQPRLPAGPANRPPEPHTQVQRAQAETGPTSFPSPVSVSMKPDLPVSLPTQTAPKQPLFVPTTSGPSTPPGLVLPHTEFQPAPKQDSSPHLTSQRPVDMVQLLKKYPIVWQGLLALKNDTAAVQLHFVSGNNVLAHRSLPLSEGGPPLRIAQRMRLEATQLEGVARRMTVETDYCLLLALPCGRDQEDVVSQTESLKAAFITYLQAKQAAGIINVPNPGSNQPAYVLQIFPPCEFSESHLSRLAPDLLASISNISPHLMIVIASV*";
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_055816.2",
                "NM_015001.2:c.10995_*1del", cdsSequence, aaSequence, 10995, 10996, 3665, "*", "C", "", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_055816.2:p.(Ter3665CysextTer2)", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_Extension_ViaInsertion()
        {
            const string cdsSequence =
                "ATGCCCTCCTGGGCCCTCTTCATGGTCACCTCCTGCCTCCTCCTGGCCCCTCAAAACCTGGCCCAAGTCAGCAGCCAAGATGTCTCCTTGCTGGCATCAGACTCAGAGCCCCTGAAGTGTTTCTCCCGAACATTTGAGGACCTCACTTGCTTCTGGGATGAGGAAGAGGCAGCGCCCAGTGGGACATACCAGCTGCTGTATGCCTACCCGCGGGAGAAGCCCCGTGCTTGCCCCCTGAGTTCCCAGAGCATGCCCCACTTTGGAACCCGATACGTGTGCCAGTTTCCAGACCAGGAGGAAGTGCGTCTCTTCTTTCCGCTGCACCTCTGGGTGAAGAATGTGTTCCTAAACCAGACTCGGACTCAGCGAGTCCTCTTTGTGGACAGTGTAGGCCTGCCGGCTCCCCCCAGTATCATCAAGGCCATGGGTGGGAGCCAGCCAGGGGAACTTCAGATCAGCTGGGAGGAGCCAGCTCCAGAAATCAGTGATTTCCTGAGGTACGAACTCCGCTATGGCCCCAGAGATCCCAAGAACTCCACTGGTCCCACGGTCATACAGCTGATTGCCACAGAAACCTGCTGCCCTGCTCTGCAGAGGCCTCACTCAGCCTCTGCTCTGGACCAGTCTCCATGTGCTCAGCCCACAATGCCCTGGCAAGATGGACCAAAGCAGACCTCCCCAAGTAGAGAAGCTTCAGCTCTGACAGCAGAGGGTGGAAGCTGCCTCATCTCAGGACTCCAGCCTGGCAACTCCTACTGGCTGCAGCTGCGCAGCGAACCTGATGGGATCTCCCTCGGTGGCTCCTGGGGATCCTGGTCCCTCCCTGTGACTGTGGACCTGCCTGGAGATGCAGTGGCACTTGGACTGCAATGCTTTACCTTGGACCTGAAGAATGTTACCTGTCAATGGCAGCAACAGGACCATGCTAGCTCCCAAGGCTTCTTCTACCACAGCAGGGCACGGTGCTGCCCCAGAGACAGGTACCCCATCTGGGAGAACTGCGAAGAGGAAGAGAAAACAAATCCAGGACTACAGACCCCACAGTTCTCTCGCTGCCACTTCAAGTCACGAAATGACAGCATTATTCACATCCTTGTGGAGGTGACCACAGCCCCGGGTACTGTTCACAGCTACCTGGGCTCCCCTTTCTGGATCCACCAGGCTGTGCGCCTCCCCACCCCAAACTTGCACTGGAGGGAGATCTCCAGTGGGCATCTGGAATTGGAGTGGCAGCACCCATCGTCCTGGGCAGCCCAAGAGACCTGTTATCAACTCCGATACACAGGAGAAGGCCATCAGGACTGGAAGGTGCTGGAGCCGCCTCTCGGGGCCCGAGGAGGGACCCTGGAGCTGCGCCCGCGATCTCGCTACCGTTTACAGCTGCGCGCCAGGCTCAACGGCCCCACCTACCAAGGTCCCTGGAGCTCGTGGTCGGACCCAACTAGGGTGGAGACCGCCACCGAGACCGCCTGGATCTCCTTGGTGACCGCTCTGCATCTAGTGCTGGGCCTCAGCGCCGTCCTGGGCCTGCTGCTGCTGAGGTGGCAGTTTCCTGCACACTACAGGAGACTGAGGCATGCCCTGTGGCCCTCACTTCCAGACCTGCACCGGGTCCTAGGCCAGTACCTTAGGGACACTGCAGCCCTGAGCCCGCCCAAGGCCACAGTCTCAGATACCTGTGAAGAAGTGGAACCCAGCCTCCTTGAAATCCTCCCCAAGTCCTCAGAGAGGACTCCTTTGCCCCTGTGTTCCTCCCAGGCCCAGATGGACTACCGAAGATTGCAGCCTTCTTGCCTGGGGACCATGCCCCTGTCTGTGTGCCCACCCATGGCTGAGTCAGGGTCCTGCTGTACCACCCACATTGCCAACCATTCCTACCTACCACTAAGCTATTGGCAGCAGCCTTGAGGACAGGCTCCTCACTCCCAGTTCCCTGGACAGAGCTAAACTCTCGAGACTTCTCTGTGAACTTCCCTACCCTACCCCCACAACACAAGCACCCCAGACCTCACCTCCATCCCCCTCTGTCTGCCCTCACAATTAGGCTTCATTGCACTGATCTTACTCTACTGCTGCTGACATAAAACCAGGACCCTTTCTCCACAGGCAGGCTCATTTCACTAAGCTCCTCCTTTACTTTCTCTCTCCTCTTTGATGTCAAACGCCTTGAAAACAAGCCTCCACTTCCCCACACTTCCCATTTACTCTTGAGACTACTTCAATTAGTTCCCCTACTACACTTTGCTAGTGAAACTGCCCAGGCAAAGTGCACCTCAAATCTTCTAATTCCAAGATCCAATAGGATCTCGTTAATCATCAGTTCCTTTGATCTCGCTGTAAGATTTGTCAAGGCTGACTACTCACTTCTCCTTTAAATTCTTTCCTACCTTGGTCCTGCCTCTTTGAGTATATTAGTAGGTTTTTTTTATTTGTTTGAGACAGGGTCTCACTCTGTCACCCAGGCTGCAGTGCAATGGCGCGATCTCAGCTCACTGCAACCTCCACCTCCGGGTTCAAGCGATTCTTGTGCCTCGGCCTCCCTAGTAGCTGGGATTACAGGCGCACACCACCACACACAGCTAATTTTTTTTTTTTTTTTTTTTTTTTTTTTTTAGACGGAGCCTTGCTCTGTTGCCAGACTGGAGTGCAGTGGCACGATCTCGGCTCACTGCAACCTCTGCCTCCCGGGTTCAAGCCATTCTGCCTCAGCCTCCCAAGTAGCTGGGAGTACAGGCGTCTGCCACCATGCCTAATTTTTTTCTATTTTTAGGAGAGACCGGTTTTCACCACGTTGGCCAGGATGGTCTCGATATCCTGATCTCGTGATCCGCCTGCCTCTGCCTCCCAAAGTGCTGGGATTACAGGTGTGACCCACTGCGCACAGCCCCAGCTAATTTTCATATTTTTAGTAGAGACAGGGTTTTGCCATGTTGCCCAGGCTGGTCTTGAACTCCTAACCTCGGGTGATCCACCCACCTTGGCCTCCCAAAGTGTTAGGATTACAGGCATGAGCCACTGCGCCCGGCTGAGTGTACTAGTAGTTAAGAGAATAAACTAGATCTAGAATCAGAGCTGGATTCAATTCCTGTCCTTCACATTTACTAGCTGTGCAACCTTGGGCACATAACTTAATGTCTTTGAGCCTTAGTTTTTTCATCTGTAAAACAGGGATAATAACAGCACCCCATAGAGTTGTGACGAGGATTGAGATAATCTAAGTAAAGCACAGTCCCTAGGACATAGTAAATGATTCATATATCCGAACTACTGTTATAATTATTCCTTCTTACTCTCCTCTTCTAGCATTTCTTCCAATTATTACAGTCCTTCAAGATTCCATTTCTTAACAGTCTCCAATCCCATCTATTCTCTGCCTTTACTATATGTTGACCATTCCAAAGTTCTTATCTCTAGCTCAGACATCTACTACAGCACTGTGATGCTTTATGCAACTAACTGTTTACATATCTGTCCCCTGCTACTAGATTGTGAGCTCCTTGAGGGAAAGGAACATGATTTATTTGTCCTTTTCCCCCAGCACCTAGAGTAGTGCTTGGTGCATGATAGTAGGCCTTCAATAAATTTTTTCTAAATGAATGA";
            const string aaSequence =
                "MPSWALFMVTSCLLLAPQNLAQVSSQDVSLLASDSEPLKCFSRTFEDLTCFWDEEEAAPSGTYQLLYAYPREKPRACPLSSQSMPHFGTRYVCQFPDQEEVRLFFPLHLWVKNVFLNQTRTQRVLFVDSVGLPAPPSIIKAMGGSQPGELQISWEEPAPEISDFLRYELRYGPRDPKNSTGPTVIQLIATETCCPALQRPHSASALDQSPCAQPTMPWQDGPKQTSPSREASALTAEGGSCLISGLQPGNSYWLQLRSEPDGISLGGSWGSWSLPVTVDLPGDAVALGLQCFTLDLKNVTCQWQQQDHASSQGFFYHSRARCCPRDRYPIWENCEEEEKTNPGLQTPQFSRCHFKSRNDSIIHILVEVTTAPGTVHSYLGSPFWIHQAVRLPTPNLHWREISSGHLELEWQHPSSWAAQETCYQLRYTGEGHQDWKVLEPPLGARGGTLELRPRSRYRLQLRARLNGPTYQGPWSSWSDPTRVETATETAWISLVTALHLVLGLSAVLGLLLLRWQFPAHYRRLRHALWPSLPDLHRVLGQYLRDTAALSPPKATVSDTCEEVEPSLLEILPKSSERTPLPLCSSQAQMDYRRLQPSCLGTMPLSVCPPMAESGSCCTTHIANHSYLPLSYWQQP*";
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_005364.1",
                "NM_005373.2:c.1904_1905insAG", cdsSequence, aaSequence, 1905, 1904, 635, "P", "PX", "AG", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_005364.1:p.(Ter636ValextTer46)", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_Extension_ViaInsertion2()
        {
            // chr1-158581056-A-AAG
            const string cdsSequence =
                "ATGGAGCAATTTCCAAAGGAAACCGTTGTGGAGAGCAGTGGGCCAAAGGTTTTGGAAACAGCAGAAGAGATCCAGGAGAGGCGTCAGGAAGTGTTGACTCGGTATCAAAGTTTCAAGGAGCGGGTCGCTGAGAGGGGTCAGAAGCTTGAGGATTCCTATCACTTACAAGTTTTCAAGCGAGATGCAGATGATCTGGGGAAGTGGATCATGGAGAAAGTCAATATCTTAACCGATAAGAGCTATGAAGACCCAACTAATATACAGGGGAAATATCAGAAGCATCAATCCCTTGAAGCAGAGGTGCAAACAAAATCAAGACTCATGTCTGAACTGGAAAAAACAAGGGAAGAACGATTTACCATGGGTCATTCTGCCCACGAAGAAACGAAGGCCCATATAGAGGAGCTACGCCACCTGTGGGACCTGCTGTTAGAGCTGACCCTGGAGAAGGGTGACCAGTTGCTGCGGGCCCTGAAGTTCCAGCAGTATGTACAGGAGTGTGCTGACATCTTAGAGTGGATTGGAGACAAGGAGGCTATAGCGACATCAGTGGAGCTAGGTGAAGACTGGGAGCGCACCGAAGTTCTGCATAAGAAATTTGAAGACTTCCAAGTGGAGCTGGTAGCTAAAGAAGGGAGAGTTGTTGAAGTGAACCAATATGCCAATGAGTGTGCCGAGGAAAACCATCCTGACCTACCCTTAATTCAGTCTAAGCAAAATGAGGTGAATGCTGCCTGGGAGCGCCTTCGTGGTTTGGCTCTCCAGAGACAGAAAGCTCTGTCCAATGCTGCAAACTTACAACGATTCAAAAGGGATGTGACTGAAGCCATCCAGTGGATCAAGGAGAAGGAACCTGTACTCACCTCTGAGGACTATGGCAAAGACCTTGTTGCCTCTGAAGGACTGTTTCACAGTCACAAGGGACTTGAGAGAAATCTTGCTGTCATGAGTGACAAGGTGAAGGAGTTATGTGCTAAAGCAGAGAAGCTGACACTTTCCCATCCTTCAGATGCACCTCAGATCCAGGAGATGAAAGAAGATCTGGTCTCCAGCTGGGAGCATATTCGTGCCCTGGCCACCAGCAGATATGAAAAACTGCAGGCTACTTATTGGTACCATCGATTTTCATCTGACTTTGATGAACTCTCAGGCTGGATGAACGAGAAGACTGCTGCGATCAATGCTGATGAGCTGCCAACAGATGTGGCTGGTGGAGAAGTTCTGCTGGACAGGCATCAGCAGCATAAGCATGAGATTGACTCTTACGATGACCGATTTCAATCTGCTGATGAGACTGGTCAAGACCTCGTGAATGCCAATCATGAAGCCTCTGATGAAGTTCGGGAAAAGATGGAAATACTTGACAACAACTGGACTGCCCTGCTGGAACTGTGGGACGAGCGTCATCGTCAGTATGAGCAGTGCTTGGACTTTCATCTCTTCTACAGAGACAGTGAGCAAGTGGACAGTTGGATGAGTAGACAAGAGGCCTTCCTGGAAAACGAGGATCTGGGAAACTCACTGGGCAGTGCAGAAGCCCTTCTTCAGAAGCATGAAGACTTTGAGGAAGCCTTTACTGCCCAGGAAGAGAAGATCATAACTGTAGACAAGACTGCAACCAAATTGATTGGTGATGACCATTATGATTCAGAGAACATCAAGGCTATCCGTGACGGGCTGTTAGCCCGGCGGGATGCCCTACGTGAAAAGGCTGCCACTAGACGTAGATTGCTGAAGGAGTCATTGCTTCTGCAAAAACTGTATGAGGACTCAGATGACCTAAAGAACTGGATCAACAAGAAGAAAAAGTTGGCAGATGATGAAGATTACAAGGACATACAGAACTTGAAGAGCAGGGTTCAAAAGCAGCAAGTCTTTGAAAAGGAGTTGGCAGTTAATAAGACCCAGCTGGAAAACATACAGAAAACTGGCCAAGAGATGATTGAGGGTGGTCACTATGCCTCTGACAATGTGACCACTCGTCTGAGTGAAGTTGCCAGCCTCTGGGAGGAGTTGCTGGAGGCTACAAAACAGAAAGGGACCCAGTTGCATGAGGCCAACCAGCAGCTGCAATTTGAAAATAATGCAGAAGATTTGCAGCGCTGGCTGGAGGATGTTGAGTGGCAAGTCACCTCTGAGGATTATGGGAAAGGCCTGGCCGAGGTACAGAATCGACTCAGGAAACACGGCCTCCTGGAGTCGGCTGTGGCTGCTCGTCAGGATCAGGTGGATATCCTTACAGACCTGGCTGCATATTTTGAAGAAATAGGCCATCCTGATTCTAAGGATATAAGGGCAAGGCAAGAGTCCTTGGTATGCCGATTTGAAGCTCTGAAAGAGCCACTGGCCACCCGAAAGAAGAAGCTCTTAGACCTTCTCCATCTGCAGCTGATTTGTAGAGACACAGAGGATGAGGAGGCCTGGATCCAAGAGACTGAACCCTCAGCTACTTCCACCTACCTTGGAAAGGACCTGATTGCTTCCAAAAAGCTTCTGAATAGGCATAGAGTCATCCTGGAGAACATTGCCAGCCATGAACCACGCATTCAAGAGATAACAGAAAGGGGAAACAAAATGGTAGAGGAAGGACACTTTGCTGCAGAAGATGTGGCCTCTAGGGTCAAGAGTTTGAACCAGAATATGGAGTCTCTCCGTGCTCGAGCTGCTAGGCGACAAAATGATCTTGAAGCCAATGTCCAGTTCCAGCAGTACCTGGCTGACCTGCATGAAGCAGAAACATGGATCAGAGAGAAGGAACCTATTGTAGATAATACTAACTATGGTGCTGATGAAGAAGCAGCTGGGGCTCTTCTAAAGAAGCATGAGGCCTTTCTATTAGATCTCAATTCATTTGGAGACAGTATGAAAGCTCTGCGGAATCAGGCAAACGCCTGCCAGCAACAACAGGCTGCACCAGTGGAGGGAGTTGCTGGAGAACAAAGGGTCATGGCTTTATATGACTTCCAGGCCCGCAGCCCCCGAGAAGTCACCATGAAGAAAGGTGATGTCTTAACGCTGCTCAGTTCCATCAATAAGGACTGGTGGAAGGTGGAAGCTGCTGATCATCAGGGCATTGTCCCAGCTGTCTATGTCAGAAGACTGGCCCACGATGAGTTCCCGATGCTCCCACAGCGGCGACGAGAAGAGCCAGGAAACATCACCCAGCGCCAGGAGCAGATTGAGAACCAATACCGCTCCCTCTTGGATCGGGCAGAAGAACGCAGACGTCGTCTATTGCAACGTTATAATGAATTTTTATTGGCCTATGAGGCAGGAGACATGCTGGAATGGATTCAAGAGAAAAAGGCAGAAAACACTGGAGTGGAACTAGATGATGTTTGGGAGCTGCAGAAAAAGTTTGATGAGTTCCAAAAGGATTTGAATACCAATGAGCCTCGGCTAAGGGATATCAACAAGGTAGCTGATGATCTACTATTTGAAGGACTTCTAACACCAGAAGGAGCTCAAATCCGGCAGGAATTGAATTCCCGCTGGGGTTCTTTGCAGAGGCTTGCAGATGAACAGCGGCAGCTGCTGGGCAGTGCCCATGCTGTTGAAGTGTTTCACAGAGAAGCAGATGACACGAAGGAGCAGATTGAGAAGAAATGCCAGGCCCTCAGTGCTGCAGACCCTGGCTCAGATCTGTTCAGTGTTCAGGCTCTTCAGCGACGGCATGAGGGCTTTGAAAGGGACCTCGTACCCCTGGGAGATAAGGTGACCATACTGGGGGAGACAGCAGAGCGGCTCAGTGAGTCCCATCCAGATGCCACTGAGGACCTGCAGAGACAGAAAATGGAGCTGAATGAGGCCTGGGAAGACCTGCAGGGGCGTACAAAGGATCGTAAGGAGAGCCTAAATGAGGCCCAGAAATTCTACCTGTTCCTCAGCAAGGCCAGGGATCTGCAGAACTGGATCAGTAGCATTGGTGGCATGGTATCATCACAGGAGCTGGCCGAAGACTTAACTGGCATAGAGATCTTGCTGGAGAGACATCAGGAGCACCGTGCTGACATGGAGGCAGAGGCTCCCACCTTCCAGGCCTTAGAGGACTTCAGTGCAGAACTTATCGACAGTGGGCACCATGCTAGCCCTGAAATTGAAAAAAAGCTTCAAGCTGTCAAGCTAGAGAGAGATGATTTGGAGAAGGCTTGGGAAAAACGCAAGAAGATCCTAGACCAGTGCCTGGAGTTGCAGATGTTCCAGGGGAACTGTGATCAAGTTGAGAGCTGGATGGTGGCACGTGAGAATTCCCTGAGGTCAGATGACAAAAGTTCCTTAGACAGTCTGGAGGCTTTGATGAAGAAACGGGACGATTTGGACAAAGCAATCACTGCCCAGGAAGGGAAGATCACTGACCTAGAACATTTTGCTGAGAGCCTCATTGCTGATGAACACTATGCCAAAGAAGAGATTGCTACGCGGCTCCAACGTGTACTAGACAGGTGGAAGGCTCTCAAAGCACAACTGATTGATGAGCGGACAAAGCTTGGAGACTATGCCAACCTAAAACAATTCTACCGAGACCTTGAGGAGCTGGAAGAATGGATCAGTGAGATGCTGCCCACAGCCTGTGATGAATCCTACAAAGACGCCACTAACATTCAGAGGAAATACCTGAAACACCAGACCTTTGCACATGAAGTCGATGGCCGATCTGAGCAGGTGCATGGCGTCATCAACCTGGGGAACTCCCTGATTGAGTGTAGCGCTTGTGATGGCAATGAAGAGGCCATGAAGGAGCAACTGGAACAGCTGAAGGAACATTGGGATCATCTGCTTGAGAGAACAAATGACAAAGGGAAGAAGCTCAATGAGGCCAGTCGTCAACAGAGGTTCAACACAAGCATCCGGGACTTTGAGTTCTGGCTCTCAGAGGCAGAGACATTGCTGGCCATGAAAGATCAGGCCAGGGACTTGGCTTCAGCAGGAAACCTACTCAAGAAGCATCAGCTATTGGAGAGAGAGATGTTGGCTCGAGAGGATGCACTCAAGGACCTGAATACATTGGCTGAAGATTTGCTCTCCAGCGGGACTTTCAACGTTGATCAGATTGTGAAGAAAAAAGATAATGTCAACAAGCGTTTCCTGAATGTCCAAGAATTGGCAGCTGCACACCACGAAAAATTGAAAGAGGCCTATGCCTTGTTCCAGTTCTTCCAGGATCTAGATGATGAGGAATCCTGGATAGAGGAGAAGTTGATACGAGTGAGCTCCCAGGACTATGGGAGAGATCTTCAGGGGGTTCAGAACTTGCTGAAGAAGCACAAACGCCTAGAGGGGGAGCTGGTGGCCCATGAGCCTGCCATCCAGAATGTGCTGGATATGGCAGAGAAGCTGAAAGACAAGGCTGCTGTGGGGCAAGAGGAGATCCAGTTGCGGCTGGCTCAGTTTGTTGAACACTGGGAGAAGCTCAAAGAGTTGGCCAAGGCCCGAGGACTTAAGTTGGAAGAATCCCTAGAATACTTGCAATTCATGCAGAATGCTGAGGAAGAGGAAGCTTGGATCAATGAAAAGAATGCTTTGGCTGTCCGAGGAGATTGTGGAGATACATTAGCTGCTACTCAGAGCTTGCTAATGAAGCATGAAGCTTTGGAAAATGACTTTGCTGTCCATGAGACCCGAGTACAAAATGTGTGTGCACAAGGAGAAGACATCCTAAATAAGGTGTTGCAGGAGGAAAGTCAGAACAAAGAGATTTCTTCCAAGATAGAGGCTCTGAATGAAAAGACCCCTTCTCTGGCTAAGGCAATAGCTGCTTGGAAGTTGCAATTGGAAGACGATTATGCCTTTCAGGAATTCAACTGGAAGGCTGATGTGGTAGAGGCTTGGATAGCTGATAAGGAAACAAGCCTAAAGACCAATGGCAATGGTGCAGACCTTGGTGACTTCCTCACTCTTCTGGCAAAACAGGACACTCTGGATGCCAGTCTGCAGAGTTTCCAGCAAGAGAGACTTCCCGAGATCACTGACCTGAAGGACAAACTGATTTCTGCTCAACACAACCAGTCTAAAGCCATTGAAGAGCGTTATGCCGCTCTGCTGAAGCGCTGGGAACAGTTGCTGGAAGCCTCGGCAGTCCACAGACAGAAATTGCTGGAGAAACAGCTGCCTCTACAGAAGGCTGAGGACCTGTTCGTGGAATTTGCACATAAGGCTTCAGCTTTGAACAACTGGTGTGAAAAGATGGAAGAAAACTTGTCAGAGCCTGTGCACTGTGTCTCCCTGAATGAAATTCGGCAGCTGCAGAAAGACCATGAGGACTTCTTGGCCTCCCTGGCTAGGGCTCAAGCAGACTTTAAATGTTTGCTGGAGCTAGACCAGCAGATTAAGGCCTTAGGTGTGCCTTCCAGCCCTTATACCTGGTTAACAGTGGAGGTGCTGGAAAGGACCTGGAAGCACCTATCTGACATCATTGAGGAACGGGAGCAGGAGCTGCAAAAGGAAGAGGCAAGACAGGTCAAGAACTTTGAGATGTGTCAGGAGTTTGAACAGAATGCCAGTACCTTCCTTCAATGGATCCTGGAAACCAGGGCTTACTTTCTGGATGGATCATTGCTCAAAGAAACAGGAACTCTGGAATCTCAGCTGGAAGCAAATAAAAGAAAACAGAAGGAGATCCAGGCGATGAAGCGTCAACTAACCAAGATTGTGGACCTGGGGGACAACTTGGAAGACGCTCTGATCCTTGATATCAAATACAGCACCATTGGATTGGCTCAGCAGTGGGACCAGCTCTACCAGCTTGGGTTGCGGATGCAACACAACCTGGAGCAACAGATCCAGGCCAAGGACATCAAAGGTGTGAGTGAAGAGACTCTAAAGGAATTTAGCACAATCTATAAACACTTTGATGAGAATTTGACAGGGCGCCTGACTCACAAAGAGTTCCGGTCCTGCCTGAGAGGACTCAATTACTACTTGCCCATGGTGGAGGAGGATGAACATGAGCCCAAGTTTGAGAAGTTCCTGGATGCTGTGGATCCAGGGAGGAAGGGCTATGTCTCACTGGAGGACTATACTGCTTTCCTGATTGACAAGGAGTCAGAAAACATCAAGTCCAGTGATGAAATAGAGAATGCCTTCCAAGCCCTGGCAGAGGGCAAGTCATATATTACCAAAGAAGACATGAAGCAGGCCCTTACCCCAGAGCAAGTGTCATTCTGTGCCACACATATGCAGCAATATATGGACCCACGGGGTCGAAGCCATCTCTCTGGCTATGACTACGTTGGCTTCACCAATTCCTACTTTGGCAACTAATAAGCAGCTCCTCGTGGATCGTAGAAAATCTTAGTGTCGTGGGAAATTTACTGGGGGGCAAAGAGTACAGGCAAATGTGGAAGATAAAGATGGCCTCGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGCTTGTGTTTGTGTGCATATTACATTTATTGTAGGATCTTAAAAAATCTCAAGGGTGGGAGATAGAAAGGTTAATAGAGTTGGAGGAGTGGAAGCTATTTTGTATGCAACTAGTCACTGCTGAGGGGTGTCAAAGTTTCTATTTTTATTTGTTCTGTTTTGCACGTCTTTATCATTTTGCTTTATTCCGATTATAGAATAAAGTAATTCTTTTTAAAAATATTTTTTGGGGCAAAGTTAAGTAAAATGTTGAGCTTCTATATTTCTGGGAACTGTACTCATATAAGAGTGGGCAGCTAATTTTACTGTAAAGAAGGGCCATGGTATAGTAGATAAATAAAATCCAAGGCAATTTTCAAACAATTTTTTTAAACTTTGGAATGTGTTTAAATTTAAATTTGAAAATAAAGATATTTGATTTTCTGGGG";
            const string aaSequence =
                "MEQFPKETVVESSGPKVLETAEEIQERRQEVLTRYQSFKERVAERGQKLEDSYHLQVFKRDADDLGKWIMEKVNILTDKSYEDPTNIQGKYQKHQSLEAEVQTKSRLMSELEKTREERFTMGHSAHEETKAHIEELRHLWDLLLELTLEKGDQLLRALKFQQYVQECADILEWIGDKEAIATSVELGEDWERTEVLHKKFEDFQVELVAKEGRVVEVNQYANECAEENHPDLPLIQSKQNEVNAAWERLRGLALQRQKALSNAANLQRFKRDVTEAIQWIKEKEPVLTSEDYGKDLVASEGLFHSHKGLERNLAVMSDKVKELCAKAEKLTLSHPSDAPQIQEMKEDLVSSWEHIRALATSRYEKLQATYWYHRFSSDFDELSGWMNEKTAAINADELPTDVAGGEVLLDRHQQHKHEIDSYDDRFQSADETGQDLVNANHEASDEVREKMEILDNNWTALLELWDERHRQYEQCLDFHLFYRDSEQVDSWMSRQEAFLENEDLGNSLGSAEALLQKHEDFEEAFTAQEEKIITVDKTATKLIGDDHYDSENIKAIRDGLLARRDALREKAATRRRLLKESLLLQKLYEDSDDLKNWINKKKKLADDEDYKDIQNLKSRVQKQQVFEKELAVNKTQLENIQKTGQEMIEGGHYASDNVTTRLSEVASLWEELLEATKQKGTQLHEANQQLQFENNAEDLQRWLEDVEWQVTSEDYGKGLAEVQNRLRKHGLLESAVAARQDQVDILTDLAAYFEEIGHPDSKDIRARQESLVCRFEALKEPLATRKKKLLDLLHLQLICRDTEDEEAWIQETEPSATSTYLGKDLIASKKLLNRHRVILENIASHEPRIQEITERGNKMVEEGHFAAEDVASRVKSLNQNMESLRARAARRQNDLEANVQFQQYLADLHEAETWIREKEPIVDNTNYGADEEAAGALLKKHEAFLLDLNSFGDSMKALRNQANACQQQQAAPVEGVAGEQRVMALYDFQARSPREVTMKKGDVLTLLSSINKDWWKVEAADHQGIVPAVYVRRLAHDEFPMLPQRRREEPGNITQRQEQIENQYRSLLDRAEERRRRLLQRYNEFLLAYEAGDMLEWIQEKKAENTGVELDDVWELQKKFDEFQKDLNTNEPRLRDINKVADDLLFEGLLTPEGAQIRQELNSRWGSLQRLADEQRQLLGSAHAVEVFHREADDTKEQIEKKCQALSAADPGSDLFSVQALQRRHEGFERDLVPLGDKVTILGETAERLSESHPDATEDLQRQKMELNEAWEDLQGRTKDRKESLNEAQKFYLFLSKARDLQNWISSIGGMVSSQELAEDLTGIEILLERHQEHRADMEAEAPTFQALEDFSAELIDSGHHASPEIEKKLQAVKLERDDLEKAWEKRKKILDQCLELQMFQGNCDQVESWMVARENSLRSDDKSSLDSLEALMKKRDDLDKAITAQEGKITDLEHFAESLIADEHYAKEEIATRLQRVLDRWKALKAQLIDERTKLGDYANLKQFYRDLEELEEWISEMLPTACDESYKDATNIQRKYLKHQTFAHEVDGRSEQVHGVINLGNSLIECSACDGNEEAMKEQLEQLKEHWDHLLERTNDKGKKLNEASRQQRFNTSIRDFEFWLSEAETLLAMKDQARDLASAGNLLKKHQLLEREMLAREDALKDLNTLAEDLLSSGTFNVDQIVKKKDNVNKRFLNVQELAAAHHEKLKEAYALFQFFQDLDDEESWIEEKLIRVSSQDYGRDLQGVQNLLKKHKRLEGELVAHEPAIQNVLDMAEKLKDKAAVGQEEIQLRLAQFVEHWEKLKELAKARGLKLEESLEYLQFMQNAEEEEAWINEKNALAVRGDCGDTLAATQSLLMKHEALENDFAVHETRVQNVCAQGEDILNKVLQEESQNKEISSKIEALNEKTPSLAKAIAAWKLQLEDDYAFQEFNWKADVVEAWIADKETSLKTNGNGADLGDFLTLLAKQDTLDASLQSFQQERLPEITDLKDKLISAQHNQSKAIEERYAALLKRWEQLLEASAVHRQKLLEKQLPLQKAEDLFVEFAHKASALNNWCEKMEENLSEPVHCVSLNEIRQLQKDHEDFLASLARAQADFKCLLELDQQIKALGVPSSPYTWLTVEVLERTWKHLSDIIEEREQELQKEEARQVKNFEMCQEFEQNASTFLQWILETRAYFLDGSLLKETGTLESQLEANKRKQKEIQAMKRQLTKIVDLGDNLEDALILDIKYSTIGLAQQWDQLYQLGLRMQHNLEQQIQAKDIKGVSEETLKEFSTIYKHFDENLTGRLTHKEFRSCLRGLNYYLPMVEEDEHEPKFEKFLDAVDPGRKGYVSLEDYTAFLIDKESENIKSSDEIENAFQALAEGKSYITKEDMKQALTPEQVSFCATHMQQYMDPRGRSHLSGYDYVGFTNSYFGN*";
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_003117.2",
                "NM_003126.2:c.7257_7258insCT", cdsSequence, aaSequence, 7258, 7257, 2420, "", "X", "CT", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_003117.2:p.(Ter2420LeuextTer12)", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_Extension_ViaInsertion3()
        {
            // VID: chr1-175914292-T-TAG (NC_000001.10:g.175914293_175914294insGA), key: NM_001001740.3, expected: NP_001001740.1:p.(Ter708TyrextTer19), actual: NP_001001740.1:p.(Ter708TyrfsTer20)
            const string cdsSequence =
                "ATGTCTGGTAGCCGCCAGGCCGGGTCGGGCTCCGCTGGGACAAGCCCCGGGTCCTCGGCGGCCTCCTCGGTGACTTCCGCCTCCTCGTCTTTATCCTCTTCCCCGTCGCCGCCTTCCGTGGCGGTTTCGGCGGCAGCGCTGGTGTCCGGCGGGGTGGCCCAGGCCGCCGGCTCGGGCGGCCTCGGGGGCCCGGTGCGGCCTGTGTTGGTGGCGCCCGCCGTATCGGGTAGCGGCGGCGGGGCGGTGTCCACGGGCCTGTCCCGGCACAGCTGCGCGGCCAGGCCCAGCGCCGGCGTAGGAGGCAGCAGCTCCAGCCTAGGCAGCGGCAGCAGGAAGCGACCTCTCCTCGCCCCCCTCTGCAACGGGCTCATCAACTCCTACGAGGACAAAAGCAACGACTTCGTATGCCCCATCTGCTTTGATATGATTGAAGAAGCATACATGACAAAATGTGGCCACAGCTTTTGCTACAAGTGTATTCATCAGAGTTTGGAGGACAATAATAGATGTCCCAAGTGTAACTATGTTGTGGACAATATTGACCATCTGTATCCTAATTTCTTGGTGAATGAACTCATTCTTAAACAGAAGCAAAGATTTGAGGAAAAGAGGTTCAAATTGGACCACTCAAATGGCCACAGGTGGCAGATATTTCAAGATTGGTTGGGAACTGACCAAGATAACCTTGATTTGGCCAATGTCAATCTTATGTTGGAGTTACTAGTGCAGAAGAAGAAACAACTGGAAGCAGAATCACATGCAGCCCAACTACAGATTCTTATGGAATTCCTCAAGGTTGCAAGAAGAAATAAGAGAGAGGAAATGAGTGGCTTATACTCTCCTGTCAGTGAGGATAGCACAGTGCCTCAATTTGAAGCTCCTTCTCCATCACACAGTAGTATTATTGATTCCACAGAATACAGCCAACCTCCAGGTTTCAGTGGCAGTTCTCAGACAAAGAAACAGCCTTGGTATAATAGCACGTTAGCATCAAGACGAAAACGACTTACTGCTCATTTTGAAGACTTGGAGCAGTGTTACTTTTCTACAAGGATGTCTCGTATCTCAGATGACAGTCGAACTGCAAGCCAGTTGGATGAATTTCAGGAATGCTTGTCCAAGTTTACTCGATATAATTCAGTACGACCTTTAGCCACATTGTCATATGCTAGTGATCTCTATAATGGTTCCAGTATAGTCTCTAGTATTGAATTTGACCGGGATTGTGACTATTTTGCGATTGCTGGAGTTACAAAGAAGATTAAAGTCTATGAATATGACACTGTCATCCAGGATGCAGTGGATATTCATTACCCTGAGAATGAAATGACCTGCAATTCGAAAATCAGCTGTATCAGTTGGAGTAGTTACCATAAGAACCTGTTAGCTAGCAGTGATTATGAAGGCACTGTTATTTTATGGGATGGATTCACAGGACAGAGGTCAAAGGTCTATCAGGAGCATGAGAAGAGGTGTTGGAGTGTTGACTTTAATTTGATGGATCCTAAACTCTTGGCTTCAGGTTCTGATGATGCAAAAGTGAAGCTGTGGTCTACCAATCTAGACAACTCAGTGGCAAGCATTGAGGCAAAGGCTAATGTGTGCTGTGTTAAATTCAGCCCCTCTTCCAGATACCATTTGGCTTTCGGCTGTGCAGATCACTGTGTCCACTACTATGATCTTCGTAACACTAAACAGCCAATCATGGTATTCAAAGGACACCGTAAAGCAGTCTCTTATGCAAAGTTTGTGAGTGGTGAGGAAATTGTCTCTGCCTCAACAGACAGTCAGCTAAAACTGTGGAATGTAGGGAAACCATACTGCCTACGTTCCTTCAAGGGTCATATCAATGAAAAAAACTTTGTAGGCCTGGCTTCCAATGGAGATTATATAGCTTGTGGAAGTGAAAATAACTCTCTCTACCTGTACTATAAAGGACTTTCTAAGACTTTGCTAACTTTTAAGTTTGATACAGTCAAAAGTGTTCTCGACAAAGACCGAAAAGAAGATGATACAAATGAATTTGTTAGTGCTGTGTGCTGGAGGGCACTACCAGATGGGGAGTCCAATGTGCTGATTGCTGCTAACAGTCAGGGTACAATTAAGGTGCTAGAATTGGTATGAAGGGTTAACTCAAGTCAAATTGTACTTGATCCTGCTGAAATACATCTGCAGCTGACAATGAGAGAAGAAACAGAAAATGTCATGTGATGTCTCTCCCCAAAGTCATCATGGGTTTTGGATTTGTTTTGAATATTTTTTTCTTTTTTTCTTTTCCCTCCTTTATGACCTTTGGGACATTGGGAATACCCAGCCAACTCTCCACCATCAATGTAACTCCATGGACATTGCTGCTCTTGGTGGTGTTATCTAATTTTTGTGATAGGGAAACAAATTCTTTTGAATAAAAATAAATAACAAAACAATAAAAGTTTATTGAGCCACAGTTGAAAAAAAAAAAAAAAAAA";
            const string aaSequence =
                "MSGSRQAGSGSAGTSPGSSAASSVTSASSSLSSSPSPPSVAVSAAALVSGGVAQAAGSGGLGGPVRPVLVAPAVSGSGGGAVSTGLSRHSCAARPSAGVGGSSSSLGSGSRKRPLLAPLCNGLINSYEDKSNDFVCPICFDMIEEAYMTKCGHSFCYKCIHQSLEDNNRCPKCNYVVDNIDHLYPNFLVNELILKQKQRFEEKRFKLDHSNGHRWQIFQDWLGTDQDNLDLANVNLMLELLVQKKKQLEAESHAAQLQILMEFLKVARRNKREEMSGLYSPVSEDSTVPQFEAPSPSHSSIIDSTEYSQPPGFSGSSQTKKQPWYNSTLASRRKRLTAHFEDLEQCYFSTRMSRISDDSRTASQLDEFQECLSKFTRYNSVRPLATLSYASDLYNGSSIVSSIEFDRDCDYFAIAGVTKKIKVYEYDTVIQDAVDIHYPENEMTCNSKISCISWSSYHKNLLASSDYEGTVILWDGFTGQRSKVYQEHEKRCWSVDFNLMDPKLLASGSDDAKVKLWSTNLDNSVASIEAKANVCCVKFSPSSRYHLAFGCADHCVHYYDLRNTKQPIMVFKGHRKAVSYAKFVSGEEIVSASTDSQLKLWNVGKPYCLRSFKGHINEKNFVGLASNGDYIACGSENNSLYLYYKGLSKTLLTFKFDTVKSVLDKDRKEDDTNEFVSAVCWRALPDGESNVLIAANSQGTIKVLELV*";
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_001001740.1",
                "NM_001001740.3:c.2120_2121insCT", cdsSequence, aaSequence, 2121, 2120, 707, "V", "VX", "CT", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_001001740.1:p.(Ter708TyrextTer19)", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_Extension_ViaSnv()
        {
            // VID: chr1-40363046-A-C (NC_000001.10:g.40363046A>C), key: NM_001033081.2, expected: NP_001028253.1:p.(Ter365GluextTer18), actual: NP_001028253.1:p.(Ter365Glu)
            const string cdsSequence =
                "ATGGACTACGACTCGTACCAGCACTATTTCTACGACTATGACTGCGGGGAGGATTTCTACCGCTCCACGGCGCCCAGCGAGGACATCTGGAAGAAATTCGAGCTGGTGCCATCGCCCCCCACGTCGCCGCCCTGGGGCTTGGGTCCCGGCGCAGGGGACCCGGCCCCCGGGATTGGTCCCCCGGAGCCGTGGCCCGGAGGGTGCACCGGAGACGAAGCGGAATCCCGGGGCCACTCGAAAGGCTGGGGCAGGAACTACGCCTCCATCATACGCCGTGACTGCATGTGGAGCGGCTTCTCGGCCCGGGAACGGCTGGAGAGAGCTGTGAGCGACCGGCTCGCTCCTGGCGCGCCCCGGGGGAACCCGCCCAAGGCGTCCGCCGCCCCGGACTGCACTCCCAGCCTCGAAGCCGGCAACCCGGCGCCCGCCGCCCCCTGTCCGCTGGGCGAACCCAAGACCCAGGCCTGCTCCGGGTCCGAGAGCCCAAGCGACTCGGAGAATGAAGAAATTGATGTTGTGACAGTAGAGAAGAGGCAGTCTCTGGGTATTCGGAAGCCGGTCACCATCACGGTGCGAGCAGACCCCCTGGATCCCTGCATGAAGCATTTCCACATCTCCATCCATCAGCAACAGCACAACTATGCTGCCCGTTTTCCTCCAGAAAGCTGCTCCCAAGAAGAGGCTTCAGAGAGGGGTCCCCAAGAAGAGGTTCTGGAGAGAGATGCTGCAGGGGAAAAGGAAGATGAGGAGGATGAAGAGATTGTGAGTCCCCCACCTGTAGAAAGTGAGGCTGCCCAGTCCTGCCACCCCAAACCTGTCAGTTCTGATACTGAGGATGTGACCAAGAGGAAGAATCACAACTTCCTGGAGCGCAAGAGGCGGAATGACCTGCGTTCGCGATTCTTGGCGCTGAGGGACCAGGTGCCCACCCTGGCCAGCTGCTCCAAGGCCCCCAAAGTAGTGATCCTAAGCAAGGCCTTGGAATACTTGCAAGCCCTGGTGGGGGCTGAGAAGAGGATGGCTACAGAGAAAAGACAGCTCCGATGCCGGCAGCAGCAGTTGCAGAAAAGAATTGCATACCTCACTGGCTACTAACTGACCAAAAAGCCTGACAGTTCTGTCTTACGAAGACACAAGTTTATTTTTTAACCTCCCTCTCCCCTTTAGTAATTTGCACATTTTGGTTATGGTGGGACAGTCTGGACAGTAGATCCCAGAATGCATTGCAGCCGGTGCACACACAATAAAGGCTTGCATTCTTGGAAACCTTGAAACCCAGCTCTCCCTCTTCCCTGACTCATGGGAGTGCTGTATGTTCTCTGGCGCCTTTGGCTTCCCAGCAGGCAGCTGACTGAGGAGCCTTGGGGTCTGCCTAGCTCACTAGCTCTGAAGAAAAGGCTGACAGATGCTATGCAACAGGTGGTGGATGTTGTCAGGGGCTCCAGCCTGCATGAAATCTCACACTCTGCATGAGCTTTAGGCTAGGAAAGGATGCTCCCAACTGGTGTCTCTGGGGTGATGCAAGGACAGCTGGGCCTGGATGCTCTCCCTGAGGCTCCTTTTTCCAGAAGACACACGAGCTGTCTTGGGTGAAGACAAGCTTGCAGACTTGATCAACATTGACCATTACCTCACTGTCAGACACTTTACAGTAGCCAAGGAGTTGGAAACCTTTATATATTATGATGTTAGCTGACCCCCTTCCTCCCACTCCCAATGCTGCGACCCTGGGAACACTTAAAAAGCTTGGCCTCTAGATTCTTTGTCTCAGAGCCCTCTGGGCTCTCTCCTCTGAGGGAGGGACCTTTCTTTCCTCACAAGGGACTTTTTTGTTCCATTATGCCTTGTTATGCAATGGGCTCTACAGCACCCTTTCCCACAGGTCAGAAATATTTCCCCAAGACACAGGGAAATCGGTCCTAGCCTGGGGCCTGGGGATAGCTTGGAGTCCTGGCCCATGAACTTGATCCCTGCCCAGGTGTTTTCCGAGGGGCACTTGAGGCCCAGTCTTTTCTCAAGGCAGGTGTAAGACACCTCAGAGGGAGAACTGTACTGCTGCCTCTTTCCCACCTGCCTCATCTCAATCCTTGAGCGGCAAGTTTGAAGTTCTTCTGGAACCATGCAAATCTGTCCTCCTCATGCAATTCCAAGGAGCTTGCTGGCTCTGCAGCCACCCTTGGGCCCCTTCCAGCCTGCCATGAATCAGATATCTTTCCCAGAATCTGGGCGTTTCTGAAGTTTTGGGGAGAGCTGTTGGGACTCATCCAGTGCTCCAGAAGGTGGACTTGCTTCTGGTGGGTTTTAAAGGAGCCTCCAGGAGATATGCTTAGCCAACCATGATGGATTTTACCCCAGCTGGACTCGGCAGCTCCAAGTGGAATCCACGTGCAGCTTCTAGTCTGGGAAAGTCACCCAACCTAGCAGTTGTCATGTGGGTAACCTCAGGCACCTCTAAGCCTGTCCTGGAAGAAGGACCAGCAGCCCCTCCAGAACTCTGCCCAGGACAGCAGGTGCCTGCTGGCTCTGGGTTTGGAAGTTGGGGTGGGTAGGGGGTGGTAAGTACTATATATGGCTCTGGAAAACCAGCTGCTACTTCCAAATCTATTGTCCATAATGGTTTCTTTCTGAGGTTGCTTCTTGGCCTCAGAGGACCCCAGGGGATGTTTGGAAATAGCCTCTCTACCCTTCTGGAGCATGGTTTACAAAAGCCAGCTGACTTCTGGAATTGTCTATGGAGGACAGTTTGGGTGTAGGTTACTGATGTCTCAACTGAATAGCTTGTGTTTTATAAGCTGCTGTTGGCTATTATGCTGGGGGAGTCTTTTTTTTTTATATTGTATTTTTGTATGCCTTTTGCAAAGTGGTGTTAACTGTTTTTGTACAAGGAAAAAAACTCTTGGGGCAATTTCCTGTTGCAAGGGTCTGATTTATTTTGAAAGGCAAGTTCACCTGAAATTTTGTATTTAGTTGTGATTACTGATTGCCTGATTTTAAAATGTTGCCTTCTGGGACATCTTCTAATAAAAGATTTCTCAAACATGTC";
            const string aaSequence =
                "MDYDSYQHYFYDYDCGEDFYRSTAPSEDIWKKFELVPSPPTSPPWGLGPGAGDPAPGIGPPEPWPGGCTGDEAESRGHSKGWGRNYASIIRRDCMWSGFSARERLERAVSDRLAPGAPRGNPPKASAAPDCTPSLEAGNPAPAAPCPLGEPKTQACSGSESPSDSENEEIDVVTVEKRQSLGIRKPVTITVRADPLDPCMKHFHISIHQQQHNYAARFPPESCSQEEASERGPQEEVLERDAAGEKEDEEDEEIVSPPPVESEAAQSCHPKPVSSDTEDVTKRKNHNFLERKRRNDLRSRFLALRDQVPTLASCSKAPKVVILSKALEYLQALVGAEKRMATEKRQLRCRQQQLQKRIAYLTGY*";
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_001028253.1",
                "NM_001033081.2:c.1093T>G", cdsSequence, aaSequence, 1093, 1093, 365, "*", "E", "G", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_001028253.1:p.(Ter365GluextTer18)", actualResult);
        }
        
        [Fact]
        public void GetHgvsProteinAnnotation_Frameshift_ViaDeletion()
        {
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("ENSP00000343890.4",
                "ENST00000343938.4:c.10_11del", CdsSequence, AaSequence, 10, 11, 4, "S", "X", "", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("ENSP00000343890.4:p.(Ser4GlyfsTer19)", actualResult);
        }
        
        [Fact]
        public void GetHgvsProteinAnnotation_Frameshift_ViaDeletion2()
        {
            // VID: chr1-156851289-CAC-C (NC_000001.10:g.156851290_156851291del), key: NM_001007792.1, expected: NP_001007793.1:p.(Arg714CysfsTer117), actual: NP_001007793.1:p.(Arg714CysfsTer?)
            const string cdsSequence =
                "ATGAAGGAGGCCGCCCTCATCTGCCTGGCACCCTCTGTACCCCCGATCTTGACGGTGAAGTCCTGGGACACCATGCAGTTGCGGGCTGCTAGATCTCGGTGCACAAACTTGTTGGCAGCAAGCTACATCGAGAACCAGCAGCATCTGCAGCATCTGGAGCTCCGTGATCTGAGGGGCCTGGGGGAGCTGAGAAACCTCACCATCGTGAAGAGTGGTCTCCGTTTCGTGGCGCCAGATGCCTTCCATTTCACTCCTCGGCTCAGTCGCCTGAATCTCTCCTTCAACGCTCTGGAGTCTCTCTCCTGGAAAACTGTGCAGGGCCTCTCCTTACAGGAACTGGTCCTGTCGGGGAACCCTCTGCACTGTTCTTGTGCCCTGCGCTGGCTACAGCGCTGGGAGGAGGAGGGACTGGGCGGAGTGCCTGAACAGAAGCTGCAGTGTCATGGGCAAGGGCCCCTGGCCCACATGCCCAATGCCAGCTGTGGTGTGCCCACGCTGAAGGTCCAGGTGCCCAATGCCTCGGTGGATGTGGGGGACGACGTGCTGCTGCGGTGCCAGGTGGAGGGGCGGGGCCTGGAGCAGGCCGGCTGGATCCTCACAGAGCTGGAGCAGTCAGCCACGGTGATGAAATCTGGGGGTCTGCCATCCCTGGGGCTGACCCTGGCCAATGTCACCAGTGACCTCAACAGGAAGAACGTGACGTGCTGGGCAGAGAACGATGTGGGCCGGGCAGAGGTCTCTGTTCAGGTCAACGTCTCCTTCCCGGCCAGTGTGCAGCTGCACACGGCGGTGGAGATGCACCACTGGTGCATCCCCTTCTCTGTGGATGGGCAGCCGGCACCGTCTCTGCGCTGGCTCTTCAATGGCTCCGTGCTCAATGAGACCAGCTTCATCTTCACTGAGTTCCTGGAGCCGGCAGCCAATGAGACCGTGCGGCACGGGTGTCTGCGCCTCAACCAGCCCACCCACGTCAACAACGGCAACTACACGCTGCTGGCTGCCAACCCCTTCGGCCAGGCCTCCGCCTCCATCATGGCTGCCTTCATGGACAACCCTTTCGAGTTCAACCCCGAGGACCCCATCCCTGACACTAACAGCACATCTGGAGACCCGGTGGAGAAGAAGGACGAAACACCTTTTGGGGTCTCGGTGGCTGTGGGCCTGGCCGTCTTTGCCTGCCTCTTCCTTTCTACGCTGCTCCTTGTGCTCAACAAATGTGGACGGAGAAACAAGTTTGGGATCAACCGCCCGGCTGTGCTGGCTCCAGAGGATGGGCTGGCCATGTCCCTGCATTTCATGACATTGGGTGGCAGCTCCCTGTCCCCCACCGAGGGCAAAGGCTCTGGGCTCCAAGGCCACATCATCGAGAACCCACAATACTTCAGTGATGCCTGTGTTCACCACATCAAGCGCCGGGACATCGTGCTCAAGTGGGAGCTGGGGGAGGGCGCCTTTGGGAAGGTCTTCCTTGCTGAGTGCCACAACCTCCTGCCTGAGCAGGACAAGATGCTGGTGGCTGTCAAGGCACTGAAGGAGGCGTCCGAGAGTGCTCGGCAGGACTTCCAGCGTGAGGCTGAGCTGCTCACCATGCTGCAGCACCAGCACATCGTGCGCTTCTTCGGCGTCTGCACCGAGGGCCGCCCCCTGCTCATGGTCTTTGAGTATATGCGGCACGGGGACCTCAACCGCTTCCTCCGATCCCATGGACCTGATGCCAAGCTGCTGGCTGGTGGGGAGGATGTGGCTCCAGGCCCCCTGGGTCTGGGGCAGCTGCTGGCCGTGGCTAGCCAGGTCGCTGCGGGGATGGTGTACCTGGCGGGTCTGCATTTTGTGCACCGGGACCTGGCCACACGCAACTGTCTAGTGGGCCAGGGACTGGTGGTCAAGATTGGTGATTTTGGCATGAGCAGGGATATCTACAGCACCGACTATTACCGTGTGGGAGGCCGCACCATGCTGCCCATTCGCTGGATGCCGCCCGAGAGCATCCTGTACCGTAAGTTCACCACCGAGAGCGACGTGTGGAGCTTCGGCGTGGTGCTCTGGGAGATCTTCACCTACGGCAAGCAGCCCTGGTACCAGCTCTCCAACACGGAGGCAATCGACTGCATCACGCAGGGACGTGAGTTGGAGCGGCCACGTGCCTGCCCACCAGAGGTCTACGCCATCATGCGGGGCTGCTGGCAGCGGGAGCCCCAGCAACGCCACAGCATCAAGGATGTGCACGCCCGGCTGCAAGCCCTGGCCCAGGCACCTCCTGTCTACCTGGATGTCCTGGGCTAGGGGGCCGGCCCAGGGGCTGGGAGTGGTTAGCCGGAATACTGGGGCCTGCCCTCAGCATCCCCCATAGCTCCCAGCAGCCCCAGGGTGATCTCAAAGTATCTAATTCACCCTCAGCATGTGGGAAGGGACAGGTGGGGGCTGGGAGTAGAGGATGTTCCTGCTTCTCTAGGCAAGGTCCCGTCATAGCAATTATATTTATTATCCCTTGAAAAAAAAAA";
            const string aaSequence =
                "MKEAALICLAPSVPPILTVKSWDTMQLRAARSRCTNLLAASYIENQQHLQHLELRDLRGLGELRNLTIVKSGLRFVAPDAFHFTPRLSRLNLSFNALESLSWKTVQGLSLQELVLSGNPLHCSCALRWLQRWEEEGLGGVPEQKLQCHGQGPLAHMPNASCGVPTLKVQVPNASVDVGDDVLLRCQVEGRGLEQAGWILTELEQSATVMKSGGLPSLGLTLANVTSDLNRKNVTCWAENDVGRAEVSVQVNVSFPASVQLHTAVEMHHWCIPFSVDGQPAPSLRWLFNGSVLNETSFIFTEFLEPAANETVRHGCLRLNQPTHVNNGNYTLLAANPFGQASASIMAAFMDNPFEFNPEDPIPDTNSTSGDPVEKKDETPFGVSVAVGLAVFACLFLSTLLLVLNKCGRRNKFGINRPAVLAPEDGLAMSLHFMTLGGSSLSPTEGKGSGLQGHIIENPQYFSDACVHHIKRRDIVLKWELGEGAFGKVFLAECHNLLPEQDKMLVAVKALKEASESARQDFQREAELLTMLQHQHIVRFFGVCTEGRPLLMVFEYMRHGDLNRFLRSHGPDAKLLAGGEDVAPGPLGLGQLLAVASQVAAGMVYLAGLHFVHRDLATRNCLVGQGLVVKIGDFGMSRDIYSTDYYRVGGRTMLPIRWMPPESILYRKFTTESDVWSFGVVLWEIFTYGKQPWYQLSNTEAIDCITQGRELERPRACPPEVYAIMRGCWQREPQQRHSIKDVHARLQALAQAPPVYLDVLG";
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_001007793.1",
                "NM_001007792.1:c.2139_2140del", cdsSequence, aaSequence, 2139, 2140, 714, "R", "X", "", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_001007793.1:p.(Arg714CysfsTer117)", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_Frameshift_IncorrectTranslationPeptideSeq()
        {
            // VID: chr2-42515387-TAT-T (NC_000002.11:g.42515388_42515389del), key: NM_001145076.1, expected: NP_001138548.1:p.(Val324TyrfsTer2), actual: NP_001138548.1:p.(Ile324TyrfsTer2)
            const string cdsSequence =
                "ATGGACGGTTTCGCCGGCAGTCTCGATGATAGTATTTCTGCTGCAAGTACTTCTGATGTTCAAGATCGCCTGTCAGCTCTTGAGTCACGAGTTCAGCAACAAGAAGATGAAATCACTGTGCTAAAGGCGGCTTTGGCTGATGTTTTGAGGCGTCTTGCAATCTCTGAAGATCATGTGGCCTCAGTGAAAAAATCAGTCTCAAGTAAAGGCCAACCAAGCCCTCGAGCAGTTATTCCCATGTCCTGTATAACCAATGGAAGTGGTGCAAACAGAAAACCAAGTCATACCAGTGCTGTCTCAATTGCAGGAAAAGAAACTCTTTCATCTGCTGCTAAAAGCATAAAACGACCATCACCAGCTGAAAAGTCACATAATTCTTGGGAAAATTCAGATGATAGCCGTAATAAATTGTCGAAAATACCTTCAACACCCAAATTAATACCAAAAGTTACCAAAACTGCAGACAAGCATAAAGATGTCATCATCAACCAAGAAGGAGAATATATTAAAATGTTTATGCGCGGTCGGCCAATTACCATGTTCATTCCTTCCGATGTTGACAACTATGATGACATCAGAACGGAACTGCCTCCTGAGAAGCTCAAACTGGAGTGGGCATATGGTTATCGAGGAAAGGACTGTAGAGCTAATGTTTACCTTCTTCCGACCGGGGAAATAGTTTATTTCATTGCATCAGTAGTAGTACTATTTAATTATGAGGAGAGAACTCAGCGACACTACCTGGGCCATACAGACTGTGTGAAATGCCTTGCTATACATCCTGACAAAATTAGGATTGCAACTGGACAGATAGCTGGCGTGGATAAAGATGGAAGGCCTCTACAACCCCACGTCAGAGTGTGGGATTCTGTTACTCTATCCACACTGCAGATTATTGGACTTGGCACTTTTGAGCGTGGAGTAGGATGCCTGGATTTTTCAAAAGCAGATTCAGGTGTTCATTTATGTGTTATTGATGACTCCAATGAGCATATGCTTACTGTATGGGACTGGCAGAAGAAAGCAAAAGGAGCAGAAATAAAGACAACAAATGAAGTTGTTTTGGCTGTGGAGTTTCACCCAACAGATGCAAATACCATAATTACATGCGGTAAATCTCATATTTTCTTCTGGACCTGGAGCGGCAATTCACTAACAAGAAAACAGGGAATTTTTGGGAAATATGAAAAGCCAAAATTTGTGCAGTGTTTAGCATTCTTGGGGAATGGAGATGTTCTTACTGGAGACTCAGGTGGAGTCATGCTTATATGGAGCAAAACTACTGTAGAGCCCACACCTGGGAAAGGACCTAAAGGTGTATATCAAATCAGCAAACAAATCAAAGCTCATGATGGCAGTGTGTTCACACTTTGTCAGATGAGAAATGGGATGTTATTAACTGGAGGAGGGAAAGACAGAAAAATAATTCTGTGGGATCATGATCTGAATCCTGAAAGAGAAATAGAGGTTCCTGATCAGTATGGCACAATCAGAGCTGTAGCAGAAGGAAAGGCAGATCAATTTTTAGTAGGCACATCACGAAACTTTATTTTACGAGGAACATTTAATGATGGCTTCCAAATAGAAGTACAGGGTCATACAGATGAGCTTTGGGGTCTTGCCACACATCCCTTCAAAGATTTGCTCTTGACATGTGCTCAGGACAGGCAGGTGTGCCTGTGGAACTCAATGGAACACAGGCTGGAATGGACCAGGCTGGTAGATGAACCAGGACACTGTGCAGATTTTCATCCAAGTGGCACAGTGGTGGCCATAGGAACGCACTCAGGCAGGTGGTTTGTTCTGGATGCAGAAACCAGAGATCTAGTTTCTATCCACACAGACGGGAATGAACAGCTCTCTGTGATGCGCTACTCAATAGATGGTACCTTCCTGGCTGTAGGATCTCATGACAACTTTATTTACCTCTATGTAGTCTCTGAAAATGGAAGAAAATATAGCAGATATGGAAGGTGCACTGGACATTCCAGCTACATCACACACCTTGACTGGTCCCCAGACAACAAGTATATAATGTCTAACTCGGGAGACTATGAAATATTGTACTGGGACATTCCAAATGGCTGCAAACTAATCAGGAATCGATCGGATTGTAAGGACATTGATTGGACGACATATACCTGTGTGCTAGGATTTCAAGTATTTGGTGTCTGGCCAGAAGGATCTGATGGGACAGATATCAATGCACTGGTGCGATCCCACAATAGAAAGGTGATAGCTGTTGCCGATGACTTTTGTAAAGTCCATCTGTTTCAGTATCCCTGCTCCAAAGCAAAGGCTCCCAGTCACAAGTACAGTGCCCACAGCAGCCATGTCACCAATGTCAGTTTTACTCACAATGACAGTCACCTGATATCAACTGGTGGAAAAGACATGAGCATCATTCAGTGGAAACTTGTGGAAAAGTTATCTTTGCCTCAGAATGAGACTGTAGCGGATACTACTCTAACCAAAGCCCCCGTCTCTTCCACTGAAAGTGTCATCCAATCTAATACTCCCACACCGCCTCCTTCTCAGCCCTTAAATGAGACAGCTGAAGAGGAAAGTAGAATAAGCAGTTCTCCCACACTTCTGGAGAACAGCCTGGAACAAACTGTGGAGCCAAGTGAAGACCACAGCGAGGAGGAGAGTGAAGAGGGCAGCGGAGACCTTGGTGAGCCTCTTTATGAAGAGCCATGCAACGAGATAAGCAAGGAGCAGGCCAAAGCCACCCTTCTGGAGGACCAGCAAGACCCTTCGCCCTCGTCCTAACACCCTGGCTTCAGTGCAACTCTTTTCCTTCAGCTGCATGTGATTTTGTGATAAAGTTCAGGTAACAGGATGGGCAGTGATGGAGAATCACTGTTGATTGAGATTTTGGTTTCCATGTGATTTGTTTTCTTCAATAGTCTTATTTTCAGTCTCTCAAATACAGCCAACTTAAAGTTTTAGTTTGGTGTTTATTGAAAATTAACCAAACTTAATACTAGGAGAAGACTGAATCATTAATGATGTCTCACAAATTACTGTGTACCTAAGTGGTGTGATGTAAATACTGGAAACAAAAACAGCAGTTGCATTGATTTTGAAAACAAACCCCCTTGTTATCTGAACATGTTTTCTTCAGGAACAACCAGAGGTATCACAAACACTGTTACTCATCTACTGGCTCAGACTGTACTACTTTTTTTTTTTTTTTTCCTGAAAAAGAAACCAGAAAAAAATGTACTCTTACTGAGATACCCTCTCACCCCAAATGTGTAATGGAAAATTTTTAATTAAGAAAAACTTCAGTTTTGCCAAGTGCAATGGTGTTGCCTTCTTTAAAAAATGCCGTTTTCTTACACTACCAGTGGATGTCCAGACATGCTCTTAGTCTACTAGAGAGGTGCTGCCTTTTCTAAGTCATAATGAGGAACAGTCCCTTAATTTCTTGTGTGCAACTCTGTTTTATCCTAGAACTAAGAGAGCATTGGTTTGTTAAAGAGCTTTCAATGTATATTAAAACCTTCAATACTCAGAAATGATGGATTCCTCCAAGGAGTCCTTTACTAGCCTAAACATTCTCAAATGTTTGAGATTCAAGTGAATGGAAGGAAAACCACATGCCTTTAAAACTAAACTGTAATAATTACCTGGCTAATTTCAGCTAAGCCTTCATCATAATTTGTTCCCTCAGTAATAGGAGAAATATAAATACAGTAAGTTTAGATTATTGAATTGGTGCTTGAAATTTATTGGTTTTGTTGTAATTTTATACAGATTATATGAGGGATAAGATACTCATCAAATTGCAAATTCTTTTTTTTACAGAAGTGTGGGTAACAGTCACAGCAGTTTTTTTTACCAACAGCATACTTAACAGACTTGCTGTGTAGCAGTTTTTTTCTGGTGGAGTTGCTGTAAGTCTTGTAAGTCTAATGTGGCTATCCTACTCTTTTGGGCAATGCATGTATTATGCATTGGAAAGGTATTTTTTTTAAGTTCTGTTGGCTAGCTATGGTTTTCAGTACATTTCCTACTTTAAGAGTAATTACTGACAAATATGTATTTCCTATATGTTTATACTTTGATTATAAAAAAGTATTTTGTTTTGATTTTTTAACTTGCTGCATTGTTTTGATACTTTCTATTTTTTTGGTCAAATCATGTTTAGAAACTTTGGATGAGTTAAGAAGTCTTAAGTATGCAGGCGTTTACGTGATTGTGCCATTCCAAAGTGCATCAGAACTGTCATTCCCTTCTAATATCTTCTCAGGAGTAATACAAATCAGGTATTTCATCATCATTTGGTAATATGAAAACTCCAGTGAACTCCCAAGGACATTTACAACATTTATATTCACACGCTGTATGGAAGGGTGTGGGTGTGTGTGAAGGGGCGAGTGGAGACACTGTGTGTATCTCTAGATAAGAAGATATGCACCACGTTGAAAATACTCAGTGTAGATCTCTATGTGTATAGGTATCTGTATATCTTTCCTTTTGTTTACAACTGTTAAAAAACCTCAAAATAGTTCTCTTCAAAAGAAGAGAGATTCCAAGCAACCCATCTTTCTTCAGTATGTATGTTCTGTACATACTTATCGGAGCGCGCCAGTAAGTATCAGGCATATATATCTGTCTGTTAGCAATGATTATTACATCATCAGATCAGCATGTGCTATACTCCCTGCAAGAAATATACTGACATGAACAGGCAGTTCTTGGAGAAGAAAGAGCATTTCTTTAAGTACCTGGGGAATACAGCTCTCAGTGATCAGCAGGGAGTTTATTTGAGGACATCAGTCACCTTTGGGGTTGCCATGTACAATGAGATTTATAATCATGATACTCTTCGGTGGTAGTTTCAAAAGACACTACTAATACGCAGGAAGCGTTCCAGCTATTTAATGCTGGCAACTACTGTTTAATGGTCAGTTAAATCTGTGATAATGGTTGGAAGTGGGTGGGGTTATGAAATTGTAGATGTTTTTAGAAAAACTTGTGAATGAAAATGAATCCAAGTGTTTCATGTGAAGATGTTGAGCCATTGCTATCATGCATTCCTGTCTCATGGCAGAAAATTTTGAAGATTAAAAAATAAAATAATCAAAATGTTTCCTCTTTCTAAAAAAAAAAAAAAAAAA";
            const string aaSequence =
                "MDGFAGSLDDSISAASTSDVQDRLSALESRVQQQEDEITVLKAALADVLRRLAISEDHVASVKKSVSSKGQPSPRAVIPMSCITNGSGANRKPSHTSAVSIAGKETLSSAAKSIKRPSPAEKSHNSWENSDDSRNKLSKIPSTPKLIPKVTKTADKHKDVIINQEGEYIKMFMRGRPITMFIPSDVDNYDDIRTELPPEKLKLEWAYGYRGKDCRANVYLLPTGEIVYFIASVVVLFNYEERTQRHYLGHTDCVKCLAIHPDKIRIATGQIAGVDKDGRPLQPHVRVWDSVTLSTLQIIGLGTFERGVGCLDFSKADSGVHLCVIDDSNEHMLTVWDWQKKAKGAEIKTTNEVVLAVEFHPTDANTIITCGKSHIFFWTWSGNSLTRKQGIFGKYEKPKFVQCLAFLGNGDVLTGDSGGVMLIWSKTTVEPTPGKGPKGVYQISKQIKAHDGSVFTLCQMRNGMLLTGGGKDRKIILWDHDLNPEREIEVPDQYGTIRAVAEGKADQFLVGTSRNFILRGTFNDGFQIEVQGHTDELWGLATHPFKDLLLTCAQDRQVCLWNSMEHRLEWTRLVDEPGHCADFHPSGTVVAIGTHSGRWFVLDAETRDLVSIHTDGNEQLSVMRYSIDGTFLAVGSHDNFIYLYVVSENGRKYSRYGRCTGHSSYITHLDWSPDNKYIMSNSGDYEILYWDIPNGCKLIRNRSDCKDIDWTTYTCVLGFQVFGVWPEGSDGTDINALVRSHNRKVIAVADDFCKVHLFQYPCSKAKAPSHKYSAHSSHVTNVSFTHNDSHLISTGGKDMSIIQWKLVEKLSLPQNETVADTTLTKAPVSSTESVIQSNTPTPPPSQPLNETAEEESRISSSPTLLENSLEQTVEPSEDHSEEESEEGSGDLGEPLYEEPCNEISKEQAKATLLEDQQDPSPSS**";
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_001138548.1",
                "NM_001145076.1:c.970_971del", cdsSequence, aaSequence, 970, 971, 324, "V", "X", "", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_001138548.1:p.(Val324TyrfsTer2)", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_Frameshift_SilentBug()
        {
            // VID: chr1-8073299-TAC-T (NC_000001.10:g.8073300_8073301del), key: NM_018948.3, expected: NP_061821.1:p.(Arg453GlnfsTer33), actual: NM_018948.3:c.1358_1359del(p.(Arg453=))
            const string cdsSequence =
                "ATGTCAATAGCAGGAGTTGCTGCTCAGGAGATCAGAGTCCCATTAAAAACTGGATTTCTACATAATGGCCGAGCCATGGGGAATATGAGGAAGACCTACTGGAGCAGTCGCAGTGAGTTTAAAAACAACTTTTTAAATATTGACCCGATAACCATGGCCTACAGTCTGAACTCTTCTGCTCAGGAGCGCCTAATACCACTTGGGCATGCTTCCAAATCTGCTCCGATGAATGGCCACTGCTTTGCAGAAAATGGTCCATCTCAAAAGTCCAGCTTGCCCCCTCTTCTTATTCCCCCAAGTGAAAACTTGGGACCACATGAAGAGGATCAAGTTGTATGTGGTTTTAAGAAACTCACAGTGAATGGGGTTTGTGCTTCCACCCCTCCACTGACACCCATAAAAAACTCCCCTTCCCTTTTCCCCTGTGCCCCTCTTTGTGAACGGGGTTCTAGGCCTCTTCCACCGTTGCCAATCTCTGAAGCCCTCTCTCTGGATGACACAGACTGTGAGGTGGAATTCCTAACTAGCTCAGATACAGACTTCCTTTTAGAAGACTCTACACTTTCTGATTTCAAATATGATGTTCCTGGCAGGCGAAGCTTCCGTGGGTGTGGACAAATCAACTATGCATATTTTGATACCCCAGCTGTTTCTGCAGCAGATCTCAGCTATGTGTCTGACCAAAATGGAGGTGTCCCAGATCCAAATCCTCCTCCACCTCAGACCCACCGAAGATTAAGAAGGTCTCATTCGGGACCAGCTGGCTCCTTTAACAAGCCAGCCATAAGGATATCCAACTGTTGTATACACAGAGCTTCTCCTAACTCCGATGAAGACAAACCTGAGGTTCCCCCCAGAGTTCCCATACCTCCTAGACCAGTAAAGCCAGATTATAGAAGATGGTCAGCAGAAGTTACTTCGAGCACCTATAGTGATGAAGACAGGCCTCCCAAAGTACCGCCAAGAGAACCTTTGTCACCGAGTAACTCGCGCACACCGAGTCCCAAAAGCCTTCCGTCTTACCTCAATGGGGTCATGCCCCCGACACAGAGCTTTGCCCCTGATCCCAAGTATGTCAGCAGCAAAGCACTGCAAAGACAGAACAGCGAAGGATCTGCCAGTAAGGTTCCTTGCATTCTGCCCATTATTGAAAATGGGAAGAAGGTTAGTTCAACACATTATTACCTACTACCTGAACGACCACCATACCTGGACAAATATGAAAAATTTTTTAGGGAAGCAGAAGAAACAAATGGAGGCGCCCAAATCCAGCCATTACCTGCTGACTGCGGTATATCTTCAGCCACAGAAAAGCCAGACTCAAAAACAAAAATGGATCTGGGTGGCCACGTGAAGCGTAAACATTTATCCTATGTGGTTTCTCCTTAGACCTTGGGGTCATGGTTCAGCAGAGGTTACATAGGAGCAAATGGTTCTCAATTTTCCAGTTTGATTGAAGTGCAGAGAAAAATCCCTTAGATTGCAAAATAAAATAGTTGAACTCTCTGTCTTCATGTGGAAGGTTTAGAGCAGTTGTGAGATGCTGTTATGCTGAGAAACCCTGACTTTGTTAGTGTTGGAAAAAAGTCTTACAAGTCTATAATTTAAAGATGTGATGGTGGGGAGGGGAGGATGGGGAAGCTTTTTATATATGCATACATTACATACCTATATATAAACTTGTGGTATAACCATAGACCATAGCTGCAGGTTAACCAATTAGTTACTATCGTAGAGTAATATATATTCAGAATAATAAACTCAAGCTGGAGAAATGAGTCCTGATAGACTGAAAATTGAGCAAATGGAAGAAGATACAGTATTGTTTAGATCAGAATCATTAAAAAATATTTTTGTTTAGTAAGTTTGAAGATTTCTGGCTTTTAGGCCTTTTCTATTTTGTTCCATTTATTTTTGCAGGCAATCTTTTCCATGGAGGGCAGGGTATCCATTCTTTACCATGGGTGTACCTGCTTAGGTTAAAAATCATACCAAGGCCTCATACTTCCAGGTTTCATGTTGCGTCTTGTTGAGGGAGGGAGAGCAGGTTACTTGGCAACCATATTGTCACCTGTACCTGTCACACATCTTGAAAAATAAAACGATAATAGAACTAGTGACTAATTTTCCCTTACAGTTCCTGCTTGGTCCCACCCACTGAAGTAGCTCATCGTAGTGCGGGCCGTATTAGAGGCAGTGGGGTACGTTAGACTCAGATGGAAAAGTATTCTAGGTGCCAGTGTTAGGATGTCAGTTTTACAAAATAATGAAGCAATTAGCTATGTGATTGAGAGTTATTGTTTGGGGATGTGTGTTGTGGTTTTGCTTTTTTTTTTTAGACTGTATTAATAAACATACAACACAAGCTGGCCTTGTGTTGCTGGTTCCTATTCAGTATTTCCTGGGGATTGTTTGCTTTTTAAGTAAAACACTTCTGACCCATAGCTCAGTATGTCTGAATTCCAGAGGTCACATCAGCATCTTTCTGCTTTGAAAACTCTCACAGCTGTGGCTGCTTCACTTAGATGCAGTGAGACACATAGTTGGTGTTCCGATTTTCACATCCTTCCATGTATTTATCTTGAAGAGATAAGCACAGAAGAGAAGGTGCTCACTAACAGAGGTACATTACTGCAATGTTCTCTTAACAGTTAAACAAGCTGTTTACAGTTTAAACTGCTGAATATTATTTGAGCTATTTAAAGCTTATTATATTTTAGTATGAACTAAATGAAGGTTAAAACATGCTTAAGAAAAATGCACTGATTTCTGCATTATGTGTACAGTATTGGACAAAGGATTTTATTCATTTTGTTGCATTATTTTGAATATTGTCTTTTCATTTTAATAAAGTTATAATACTTATTTATGATACCATTAAAAAAAAAAAAAAAA";
            const string aaSequence =
                "MSIAGVAAQEIRVPLKTGFLHNGRAMGNMRKTYWSSRSEFKNNFLNIDPITMAYSLNSSAQERLIPLGHASKSAPMNGHCFAENGPSQKSSLPPLLIPPSENLGPHEEDQVVCGFKKLTVNGVCASTPPLTPIKNSPSLFPCAPLCERGSRPLPPLPISEALSLDDTDCEVEFLTSSDTDFLLEDSTLSDFKYDVPGRRSFRGCGQINYAYFDTPAVSAADLSYVSDQNGGVPDPNPPPPQTHRRLRRSHSGPAGSFNKPAIRISNCCIHRASPNSDEDKPEVPPRVPIPPRPVKPDYRRWSAEVTSSTYSDEDRPPKVPPREPLSPSNSRTPSPKSLPSYLNGVMPPTQSFAPDPKYVSSKALQRQNSEGSASKVPCILPIIENGKKVSSTHYYLLPERPPYLDKYEKFFREAEETNGGAQIQPLPADCGISSATEKPDSKTKMDLGGHVKRKHLSYVVSP*";
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_061821.1",
                "NM_018948.3:c.1358_1359del", cdsSequence, aaSequence, 1358, 1359, 453, "R", "Q", "", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_061821.1:p.(Arg453GlnfsTer33)", actualResult);
        }

        [Fact]
        public void GetHgvsProteinAnnotation_Frameshift_ViaInsertion()
        {
            const string cdsSequence =
                "ATGGTGACTGAATTCATTTTTCTGGGTCTCTCTGATTCTCAGGAACTCCAGACCTTCCTATTTATGTTGTTTTTTGTATTCTATGGAGGAATCGTGTTTGGAAACCTTCTTATTGTCATAACAGTGGTATCTGACTCCCACCTTCACTCTCCCATGTACTTCCTGCTAGCCAACCTCTCACTCATTGATCTGTCTCTGTCTTCAGTCACAGCCCCCAAGATGATTACTGACTTTTTCAGCCAGCGCAAAGTCATCTCTTTCAAGGGCTGCCTTGTTCAGATATTTCTCCTTCACTTCTTTGGTGGGAGTGAGATGGTGATCCTCATAGCCATGGGCTTTGACAGATATATAGCAATATGCAAGCCCCTACACTACACTACAATTATGTGTGGCAACGCATGTGTCGGCATTATGGCTGTCACATGGGGAATTGGCTTTCTCCATTCGGTGAGCCAGTTGGCGTTTGCCGTGCACTTACTCTTCTGTGGTCCCAATGAGGTCGATAGTTTTTATTGTGACCTTCCTAGGGTAATCAAACTTGCCTGTACAGATACCTACAGGCTAGATATTATGGTCATTGCTAACAGTGGTGTGCTCACTGTGTGTTCTTTTGTTCTTCTAATCATCTCATACACTATCATCCTAATGACCATCCAGCATCGCCCTTTAGATAAGTCGTCCAAAGCTCTGTCCACTTTGACTGCTCACATTACAGTAGTTCTTTTGTTCTTTGGACCATGTGTCTTTATTTATGCCTGGCCATTCCCCATCAAGTCATTAGATAAATTCCTTGCTGTATTTTATTCTGTGATCACCCCTCTCTTGAACCCAATTATATACACACTGAGGAACAAAGACATGAAGACGGCAATAAGACAGCTGAGAAAATGGGATGCACATTCTAGTGTAAAGTTTTAG";
            const string aaSequence =
                "MVTEFIFLGLSDSQELQTFLFMLFFVFYGGIVFGNLLIVITVVSDSHLHSPMYFLLANLSLIDLSLSSVTAPKMITDFFSQRKVISFKGCLVQIFLLHFFGGSEMVILIAMGFDRYIAICKPLHYTTIMCGNACVGIMAVTWGIGFLHSVSQLAFAVHLLFCGPNEVDSFYCDLPRVIKLACTDTYRLDIMVIANSGVLTVCSFVLLIISYTIILMTIQHRPLDKSSKALSTLTAHITVVLLFFGPCVFIYAWPFPIKSLDKFLAVFYSVITPLLNPIIYTLRNKDMKTAIRQLRKWDAHSSVKF";
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_001005484.1",
                "NM_001005484.1:c.477_478insT", cdsSequence, aaSequence, 478, 477, 160, "", "X", "T", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_001005484.1:p.(Leu160SerfsTer7)", actualResult);
        }
        
        [Fact]
        public void GetHgvsProteinAnnotation_Frameshift_ViaInsertion_UnknownNumber()
        {
            const string cdsSequence =
                "ATGGCAAGGCTGGGAAACTGCAGCCTGACTTGGGCTGCCCTGATCATCCTGCTGCTCCCCGGAAGTCTGGAGGAGTGCGGGCACATCAGTGTCTCAGCCCCCATCGTCCACCTGGGGGATCCCATCACAGCCTCCTGCATCATCAAGCAGAACTGCAGCCATCTGGACCCGGAGCCACAGATTCTGTGGAGACTGGGAGCAGAGCTTCAGCCCGGGGGCAGGCAGCAGCGTCTGTCTGATGGGACCCAGGAATCTATCATCACCCTGCCCCACCTCAACCACACTCAGGCCTTTCTCTCCTGCTGCCTGAACTGGGGCAACAGCCTGCAGATCCTGGACCAGGTTGAGCTGCGCGCAGGCTACCCTCCAGCCATACCCCACAACCTCTCCTGCCTCATGAACCTCACAACCAGCAGCCTCATCTGCCAGTGGGAGCCAGGACCTGAGACCCACCTACCCACCAGCTTCACTCTGAAGAGTTTCAAGAGCCGGGGCAACTGTCAGACCCAAGGGGACTCCATCCTGGACTGCGTGCCCAAGGACGGGCAGAGCCACTGCTGCATCCCACGCAAACACCTGCTGTTGTACCAGAATATGGGCATCTGGGTGCAGGCAGAGAATGCGCTGGGGACCAGCATGTCCCCACAACTGTGTCTTGATCCCATGGATGTTGTGAAACTGGAGCCCCCCATGCTGCGGACCATGGACCCCAGCCCTGAAGCGGCCCCTCCCCAGGCAGGCTGCCTACAGCTGTGCTGGGAGCCATGGCAGCCAGGCCTGCACATAAATCAGAAGTGTGAGCTGCGCCACAAGCCGCAGCGTGGAGAAGCCAGCTGGGCACTGGTGGGCCCCCTCCCCTTGGAGGCCCTTCAGTATGAGCTCTGCGGGCTCCTCCCAGCCACGGCCTACACCCTGCAGATACGCTGCATCCGCTGGCCCCTGCCTGGCCACTGGAGCGACTGGAGCCCCAGCCTGGAGCTGAGAACTACCGAACGGGCCCCCACTGTCAGACTGGACACATGGTGGCGGCAGAGGCAGCTGGACCCCAGGACAGTGCAGCTGTTCTGGAAGCCAGTGCCCCTGGAGGAAGACAGCGGACGGATCCAAGGTTATGTGGTTTCTTGGAGACCCTCAGGCCAGGCTGGGGCCATCCTGCCCCTCTGCAACACCACAGAGCTCAGCTGCACCTTCCACCTGCCTTCAGAAGCCCAGGAGGTGGCCCTTGTGGCCTATAACTCAGCCGGGACCTCTCGTCCCACTCCGGTGGTCTTCTCAGAAAGCAGAGGCCCAGCTCTGACCAGACTCCATGCCATGGCCCGAGACCCTCACAGCCTCTGGGTAGGCTGGGAGCCCCCCAATCCATGGCCTCAGGGCTATGTGATTGAGTGGGGCCTGGGCCCCCCCAGCGCGAGCAATAGCAACAAGACCTGGAGGATGGAACAGAATGGGAGAGCCACGGGGTTTCTGCTGAAGGAGAACATCAGGCCCTTTCAGCTCTATGAGATCATCGTGACTCCCTTGTACCAGGACACCATGGGACCCTCCCAGCATGTCTATGCCTACTCTCAAGAAATGGCTCCCTCCCATGCCCCAGAGCTGCATCTAAAGCACATTGGCAAGACCTGGGCACAGCTGGAGTGGGTGCCTGAGCCCCCTGAGCTGGGGAAGAGCCCCCTTACCCACTACACCATCTTCTGGACCAACGCTCAGAACCAGTCCTTCTCCGCCATCCTGAATGCCTCCTCCCGTGGCTTTGTCCTCCATGGCCTGGAGCCCGCCAGTCTGTATCACATCCACCTCATGGCTGCCAGCCAGGCTGGGGCCACCAACAGTACAGTCCTCACCCTGATGACCTTGACCCCAGAGGGGTCGGAGCTACACATCATCCTGGGCCTGTTCGGCCTCCTGCTGTTGCTCACCTGCCTCTGTGGAACTGCCTGGCTCTGTTGCAGCCCCAACAGGAAGAATCCCCTCTGGCCAAGTGTCCCAGACCCAGCTCACAGCAGCCTGGGCTCCTGGGTGCCCACAATCATGGAGGAGGATGCCTTCCAGCTGCCCGGCCTTGGCACGCCACCCATCACCAAGCTCACAGTGCTGGAGGAGGATGAAAAGAAGCCGGTGCCCTGGGAGTCCCATAACAGCTCAGAGACCTGTGGCCTCCCCACTCTGGTCCAGACCTATGTGCTCCAGGGGGACCCAAGAGCAGTTTCCACCCAGCCCCAATCCCAGTCTGGCACCAGCGATCAGGCTGGGCCTCCCAGGCGATCTGCATACTTTAAGGACCAGATCATGCTCCATCCAGCCCCACCCAATGGCCTTTTGTGCTTGTTTCCTATAACTTCAGTATTGTAAACTAGTTTTTGGTTTGCAGTTTTTGTTGTTGTTTATAGACACTCTTGGGTGTAAAAAAAAAAA";
            const string aaSequence =
                "MARLGNCSLTWAALIILLLPGSLEECGHISVSAPIVHLGDPITASCIIKQNCSHLDPEPQILWRLGAELQPGGRQQRLSDGTQESIITLPHLNHTQAFLSCCLNWGNSLQILDQVELRAGYPPAIPHNLSCLMNLTTSSLICQWEPGPETHLPTSFTLKSFKSRGNCQTQGDSILDCVPKDGQSHCCIPRKHLLLYQNMGIWVQAENALGTSMSPQLCLDPMDVVKLEPPMLRTMDPSPEAAPPQAGCLQLCWEPWQPGLHINQKCELRHKPQRGEASWALVGPLPLEALQYELCGLLPATAYTLQIRCIRWPLPGHWSDWSPSLELRTTERAPTVRLDTWWRQRQLDPRTVQLFWKPVPLEEDSGRIQGYVVSWRPSGQAGAILPLCNTTELSCTFHLPSEAQEVALVAYNSAGTSRPTPVVFSESRGPALTRLHAMARDPHSLWVGWEPPNPWPQGYVIEWGLGPPSASNSNKTWRMEQNGRATGFLLKENIRPFQLYEIIVTPLYQDTMGPSQHVYAYSQEMAPSHAPELHLKHIGKTWAQLEWVPEPPELGKSPLTHYTIFWTNAQNQSFSAILNASSRGFVLHGLEPASLYHIHLMAASQAGATNSTVLTLMTLTPEGSELHIILGLFGLLLLLTCLCGTAWLCCSPNRKNPLWPSVPDPAHSSLGSWVPTIMEEDAFQLPGLGTPPITKLTVLEEDEKKPVPWESHNSSETCGLPTLVQTYVLQGDPRAVSTQPQSQSGTSDQAGPPRRSAYFKDQIMLHPAPPNGLLCLFPITSVL*";
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_758519.1",
                "NM_172313.2:c.2344_2345insCT", cdsSequence, aaSequence, 2345, 2344, 782, "V", "AX", "CT", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_758519.1:p.(Val782AlafsTer?)", actualResult);
        }
        
        
        [Fact]
        public void GetHgvsProteinAnnotation_Frameshift_ViaInsertion_SubstitutionBug()
        {
            // VID: chr1-8073289-G-GAG (NC_000001.10:g.8073289_8073290dup), key: NM_018948.3, expected: NP_061821.1:p.(Tyr458ProfsTer18), actual: NP_061821.1:p.(Ser457Phe)
            const string cdsSequence =
                "ATGTCAATAGCAGGAGTTGCTGCTCAGGAGATCAGAGTCCCATTAAAAACTGGATTTCTACATAATGGCCGAGCCATGGGGAATATGAGGAAGACCTACTGGAGCAGTCGCAGTGAGTTTAAAAACAACTTTTTAAATATTGACCCGATAACCATGGCCTACAGTCTGAACTCTTCTGCTCAGGAGCGCCTAATACCACTTGGGCATGCTTCCAAATCTGCTCCGATGAATGGCCACTGCTTTGCAGAAAATGGTCCATCTCAAAAGTCCAGCTTGCCCCCTCTTCTTATTCCCCCAAGTGAAAACTTGGGACCACATGAAGAGGATCAAGTTGTATGTGGTTTTAAGAAACTCACAGTGAATGGGGTTTGTGCTTCCACCCCTCCACTGACACCCATAAAAAACTCCCCTTCCCTTTTCCCCTGTGCCCCTCTTTGTGAACGGGGTTCTAGGCCTCTTCCACCGTTGCCAATCTCTGAAGCCCTCTCTCTGGATGACACAGACTGTGAGGTGGAATTCCTAACTAGCTCAGATACAGACTTCCTTTTAGAAGACTCTACACTTTCTGATTTCAAATATGATGTTCCTGGCAGGCGAAGCTTCCGTGGGTGTGGACAAATCAACTATGCATATTTTGATACCCCAGCTGTTTCTGCAGCAGATCTCAGCTATGTGTCTGACCAAAATGGAGGTGTCCCAGATCCAAATCCTCCTCCACCTCAGACCCACCGAAGATTAAGAAGGTCTCATTCGGGACCAGCTGGCTCCTTTAACAAGCCAGCCATAAGGATATCCAACTGTTGTATACACAGAGCTTCTCCTAACTCCGATGAAGACAAACCTGAGGTTCCCCCCAGAGTTCCCATACCTCCTAGACCAGTAAAGCCAGATTATAGAAGATGGTCAGCAGAAGTTACTTCGAGCACCTATAGTGATGAAGACAGGCCTCCCAAAGTACCGCCAAGAGAACCTTTGTCACCGAGTAACTCGCGCACACCGAGTCCCAAAAGCCTTCCGTCTTACCTCAATGGGGTCATGCCCCCGACACAGAGCTTTGCCCCTGATCCCAAGTATGTCAGCAGCAAAGCACTGCAAAGACAGAACAGCGAAGGATCTGCCAGTAAGGTTCCTTGCATTCTGCCCATTATTGAAAATGGGAAGAAGGTTAGTTCAACACATTATTACCTACTACCTGAACGACCACCATACCTGGACAAATATGAAAAATTTTTTAGGGAAGCAGAAGAAACAAATGGAGGCGCCCAAATCCAGCCATTACCTGCTGACTGCGGTATATCTTCAGCCACAGAAAAGCCAGACTCAAAAACAAAAATGGATCTGGGTGGCCACGTGAAGCGTAAACATTTATCCTATGTGGTTTCTCCTTAGACCTTGGGGTCATGGTTCAGCAGAGGTTACATAGGAGCAAATGGTTCTCAATTTTCCAGTTTGATTGAAGTGCAGAGAAAAATCCCTTAGATTGCAAAATAAAATAGTTGAACTCTCTGTCTTCATGTGGAAGGTTTAGAGCAGTTGTGAGATGCTGTTATGCTGAGAAACCCTGACTTTGTTAGTGTTGGAAAAAAGTCTTACAAGTCTATAATTTAAAGATGTGATGGTGGGGAGGGGAGGATGGGGAAGCTTTTTATATATGCATACATTACATACCTATATATAAACTTGTGGTATAACCATAGACCATAGCTGCAGGTTAACCAATTAGTTACTATCGTAGAGTAATATATATTCAGAATAATAAACTCAAGCTGGAGAAATGAGTCCTGATAGACTGAAAATTGAGCAAATGGAAGAAGATACAGTATTGTTTAGATCAGAATCATTAAAAAATATTTTTGTTTAGTAAGTTTGAAGATTTCTGGCTTTTAGGCCTTTTCTATTTTGTTCCATTTATTTTTGCAGGCAATCTTTTCCATGGAGGGCAGGGTATCCATTCTTTACCATGGGTGTACCTGCTTAGGTTAAAAATCATACCAAGGCCTCATACTTCCAGGTTTCATGTTGCGTCTTGTTGAGGGAGGGAGAGCAGGTTACTTGGCAACCATATTGTCACCTGTACCTGTCACACATCTTGAAAAATAAAACGATAATAGAACTAGTGACTAATTTTCCCTTACAGTTCCTGCTTGGTCCCACCCACTGAAGTAGCTCATCGTAGTGCGGGCCGTATTAGAGGCAGTGGGGTACGTTAGACTCAGATGGAAAAGTATTCTAGGTGCCAGTGTTAGGATGTCAGTTTTACAAAATAATGAAGCAATTAGCTATGTGATTGAGAGTTATTGTTTGGGGATGTGTGTTGTGGTTTTGCTTTTTTTTTTTAGACTGTATTAATAAACATACAACACAAGCTGGCCTTGTGTTGCTGGTTCCTATTCAGTATTTCCTGGGGATTGTTTGCTTTTTAAGTAAAACACTTCTGACCCATAGCTCAGTATGTCTGAATTCCAGAGGTCACATCAGCATCTTTCTGCTTTGAAAACTCTCACAGCTGTGGCTGCTTCACTTAGATGCAGTGAGACACATAGTTGGTGTTCCGATTTTCACATCCTTCCATGTATTTATCTTGAAGAGATAAGCACAGAAGAGAAGGTGCTCACTAACAGAGGTACATTACTGCAATGTTCTCTTAACAGTTAAACAAGCTGTTTACAGTTTAAACTGCTGAATATTATTTGAGCTATTTAAAGCTTATTATATTTTAGTATGAACTAAATGAAGGTTAAAACATGCTTAAGAAAAATGCACTGATTTCTGCATTATGTGTACAGTATTGGACAAAGGATTTTATTCATTTTGTTGCATTATTTTGAATATTGTCTTTTCATTTTAATAAAGTTATAATACTTATTTATGATACCATTAAAAAAAAAAAAAAAA";
            const string aaSequence =
                "MSIAGVAAQEIRVPLKTGFLHNGRAMGNMRKTYWSSRSEFKNNFLNIDPITMAYSLNSSAQERLIPLGHASKSAPMNGHCFAENGPSQKSSLPPLLIPPSENLGPHEEDQVVCGFKKLTVNGVCASTPPLTPIKNSPSLFPCAPLCERGSRPLPPLPISEALSLDDTDCEVEFLTSSDTDFLLEDSTLSDFKYDVPGRRSFRGCGQINYAYFDTPAVSAADLSYVSDQNGGVPDPNPPPPQTHRRLRRSHSGPAGSFNKPAIRISNCCIHRASPNSDEDKPEVPPRVPIPPRPVKPDYRRWSAEVTSSTYSDEDRPPKVPPREPLSPSNSRTPSPKSLPSYLNGVMPPTQSFAPDPKYVSSKALQRQNSEGSASKVPCILPIIENGKKVSSTHYYLLPERPPYLDKYEKFFREAEETNGGAQIQPLPADCGISSATEKPDSKTKMDLGGHVKRKHLSYVVSP*";
            string actualResult = HgvsProtein.GetHgvsProteinAnnotation("NP_061821.1",
                "NM_018948.3:c.1369_1370dup", cdsSequence, aaSequence, 1371, 1370, 457, "S", "SX", "TC", false,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NP_061821.1:p.(Tyr458ProfsTer18)", actualResult);
        }
        
        [Fact]
        public void GetAltPeptideSequence_SyntheticExample_ExpectedResults()
        {
            const string cdsSequence = "AATAGGGGGGGGCGTTGCTAACGCC";
            const string altAllele   = "TTCG";
            string actualResult = HgvsProtein.GetAltPeptideSequence(cdsSequence, 5, 12, altAllele,
                AminoAcidCommon.StandardAminoAcids);
            Assert.Equal("NIRVANA", actualResult);
        }

        [Fact]
        public void GetAltPeptideSequence_RealExample_ExpectedResults()
        {
            const string cdnaSequence =
                "GAGGGCGGGGCGAGGGCGGGGCGGTGGGCGGGGACGGGGCCCGCACGGCGGCTACGGCCTAGGTGAGCGGCTCGGACTCGGCGGCCGCACCTGCCCAACCCAACCCGCACGGTCCGGAAGTCGCCGAGGGGCCGGGAGCGGGAGGGGACGTCGTCCTAGAGGGCCGGAGCGGGCGGGCGGCCGAGGACCCGGCTCCCGCGCAGGACGGAGCCGTGGCTCAGGTCGGCCCCTCCCCAACACCACCCCGGGCCTCCGCCCCTTCCTGGGCCTCTCGGTGGAGCAGGGACCCGAACCGGTGCCCATCCAGTCCGGTGCCATCTGAAGCCCCCTTCCCAGAAAATGAGCCACAGAGCAAGCTGACCCCAGCGACACAGCCCCCCAGCCCTACTGTATTTCCGTTCCTATCAAAAAATGGATGACTCGGAGACAGGTTTCAATCTGAAAGTCGTCCTGGTCAGTTTCAAGCAGTGTCTCGATGAGAAGGAAGAGGTCTTGCTGGACCCCTACATTGCCAGCTGGAAGGGCCTGGTCAGGTTTCTGAACAGCCTGGGCACCATCTTCTCATTCATCTCCAAGGACGTGGTCTCCAAGCTGCGGATCATGGAGCGCCTCAGGGGCGGCCCGCAGAGCGAGCACTACCGCAGCCTGCAGGCCATGGTGGCCCACGAGCTGAGCAACCGGCTGGTGGACCTGGAGCGCCGCTCCCACCACCCGGAGTCTGGCTGCCGGACGGTGCTGCGCCTGCACCGCGCCCTGCACTGGCTGCAGCTGTTCCTGGAGGGCCTGCGTACCAGCCCCGAGGACGCACGCACCTCCGCGCTCTGCGCCGACTCCTACAACGCCTCGCTGGCCGCCTACCACCCCTGGGTCGTGCGCCGCGCCGTCACCGTGGCCTTCTGCACGCTGCCCACACGCGAGGTCTTCCTGGAGGCCATGAACGTGGGGCCCCCGGAGCAGGCCGTGCAGATGCTAGGCGAGGCCCTCCCCTTCATCCAGCGTGTCTACAACGTCTCCCAGAAGCTCTACGCCGAGCACTCCCTGCTGGACCTGCCCTAGGGGCGGGAAGCCAGGGCCGCACCGGCTTTCCTGCTGCAGATCTGGGCTGCGGTGGCCAGGGCCGTGAGTCCCGTGGCAGAGCCTTCTGGGCGCTGCGGGAACAGGAGATCCTCTGTCGCCCCTGTGAGCTGAGCTGGTTAGGAACCACAGACTGTGACAGAGAAGGTGGCGACCAGCCCAGAAGAGGCCCACCCTCTCGGTCCGGAACAAGACGCCTCGGCCACGGCTCCCCCTCGGCCTATTACACGCGTGCGCAGCCAGGCCTCGCCAGGGTGCGGTGCAGAGCAGAGCAGGCAGGGGTGGGGGCCGGGCCTGCAAGAGCCCGAAAGGTCGCCACCCCCTAGCCTGTGGGGTGCATCTGCGAACCAGGGTGAAGTCACAGGTCCCGGGGTGTGGAGGCTCCATCCTTTCTCCTTTCTGCCAGCCGATGTGTCCTCATCTCAGGCCCGTGCCTGGGACCCCGTGTCTGCCCAGGTGGGCAGCCTTGAGCCCAGGGGACTCAGTGCCCTCCATGCCCTGGCTGGCAGAAACCCTCAACAGCAGTCTGGGCACTGTGGGGCTCTCCCCGCCTCTCCTGCCTTGTTTGCCCCTCAGCGTGCCAGGCAGACTGGGGGCAGGACAGCCGGAAGCTGAGACCAAGGCTCCTCACAGAAGGGCCCAGGAAGTCCCCGCCCTTGGGACAGCCTCCTCCGTAGCCCCTGCACGGCACCAGTTCCCCGAGGGACGCAGCAGGCCGCCTCCCGCAGCGGCCGTGGGTCTGCACAGCCCAGCCCAGCCCAAGGCCCCCAGGAGCTGGGACTCTGCTACACCCAGTGAAATGCTGTGTCCCTTCTCCCCCGTGCCCCTTGATGCCCCCTCCCCACAGTGCTCAGGAGACCCGTGGGGCACGGAACAGGAGGGTCTGGACCCTGTGGCCCAGCCAAAGGCTACCAGACAGCCACAACCAGCCCAGCCACCATCCAGTGCCTGGGGCCTGGCCACTGGCTCTTCACAGTGGACCCCAGCACCTCGGGGTGGCAGAGGGACGGCCCCCACGGCCCAGCAGACATGCGAGCTTCCAGAGTGCAATCTATGTGATGTCTTCCAACGTTAATAAATCACACAGCCTCCCAGGAGGGAGACGCTGGGGTGCAC";
            ReadOnlySpan<char> cdsSpan = cdnaSequence.AsSpan().Slice(412 - 1);
            
            const string altAllele = "";
            string actualResult =
                HgvsProtein.GetAltPeptideSequence(cdsSpan, 643, 645, altAllele, AminoAcidCommon.StandardAminoAcids);
            Assert.Equal(
                "MDDSETGFNLKVVLVSFKQCLDEKEEVLLDPYIASWKGLVRFLNSLGTIFSFISKDVVSKLRIMERLRGGPQSEHYRSLQAMVAHELSNRLVDLERRSHHPESGCRTVLRLHRALHWLQLFLEGLRTSPEDARTSALCADSYNASLAAYHPWVVRRAVTVAFCTLPTREVFLEAMNVGPPEQAVQMLGEALPFIQRVYNVSQKLYAEHSLLDLPGREARAAPAFLLQIWAAVARAVSPVAEPSGRCGNRRSSVAPVS*AG*EPQTVTEKVATSPEEAHPLGPEQDASATAPPRPITRVRSQASPGCGAEQSRQGWGPGLQEPERSPPPSLWGASANQGEVTGPGVWRLHPFSFLPADVSSSQARAWDPVSAQVGSLEPRGLSALHALAGRNPQQQSGHCGALPASPALFAPQRARQTGGRTAGS*DQGSSQKGPGSPRPWDSLLRSPCTAPVPRGTQQAASRSGRGSAQPSPAQGPQELGLCYTQ*NAVSLLPRAP*CPLPTVLRRPVGHGTGGSGPCGPAKGYQTATTSPATIQCLGPGHWLFTVDPSTSGWQRDGPHGPADMRASRVQSM*CLPTLINHTASQEGDAGVH",
                actualResult);
        }

        [Fact]
        public void CountAminoAcidsUntilNextStopCodon_NoOtherStopCodons_ReturnNull()
        {
            int? actualResult = HgvsProtein.CountAminoAcidsUntilNextStopCodon(
                "RHRNRNTQTETNTETQRHRNTQKHRNKHRDTETHRNTETNTETQKHTETQKQTQRHRNTQKHTDRNKHRNTETQKYRNTQKHRNKHRDTETQKHSDAETQQHKHRNTETHRNRNTETNTETQTHRHRETQKHTETLKHSGRCPGCRGSIA",
                37);
            Assert.Null(actualResult);
        }

        [Fact]
        public void CountAminoAcidsUntilNextStopCodon_FoundStopCodon()
        {
            int? actualResult =
                HgvsProtein.CountAminoAcidsUntilNextStopCodon(
                    "MLAEPFNWHVEYAHSGDVLGPSGLPASPGAPGTCLHNPAGSNWGPG*EVLMAGTVPAVPG*", 9);
            Assert.Equal(38, actualResult);
        }

        [Theory]
        [InlineData("KRZ", "K",   false)]
        [InlineData("KRZ", "",    false)]
        [InlineData("KRZ", "*",   true)]
        [InlineData("KRZ", "KR*", true)]
        public void IsTruncatedByStop_ExpectedResults(string refAminoAcids, string altAminoAcids, bool expectedResult)
        {
            bool actualResult = HgvsProtein.IsTruncatedByStop(refAminoAcids, altAminoAcids);
            Assert.Equal(expectedResult, actualResult);
        }

        [Fact]
        public void FindFirstChangeAfterFrameshift_Insertion_NoShift()
        {
            const string aaSequence =
                "MEPPGDWGPPPWRSTPKTDVLRLVLYLTFLGAPCYAPALPSCKEDEYPVGSECCPKCSPGYRVKEACGELTGTVCEPCPPGTYIAHLNGLSKCLQCQMCDPDIGSPCDLRGRGHLEAGAHLSPGRQKGEPDPEVAFESLSAEPVHAANGSVPLEPHARLSMASAPCGQAGLHLRDRADGTPGGRA";
            const string altAaSequence =
                "MEPPGETGGLLPGDPPPKPTS*GWCCISPSWEPPATPQLCRPARRTSTQWAPSAAPSAVQVIV*RRPAGS*RAQCVNPALQAPTLPTSMA*ASVCSAKCVTQILVPPVTSGEEVTWRLVPT*VQADRKGNQTQRWPLSH*AQSLSMRPTALSPWSLMPGSAWPVLPAARQDCTCGTGLTAHLGAGPEPTGRHRAGGLAMNRRGSWSALGVHACRLGFGAHTSTCMPSSMPLPSCESTCLLGLRMWGHRWQVRLPSGGAQAQLVPHLHQYLKKWGSHPTCLCHWNGLVCTDGKPVCGVGVWVGTWGEDLPAGPCPGTDSASSASCPSGQKAGFSHQRSPPRTFLQALVPHAALPSLGVPPGLRSSMLGTSGHLVWLSQGFSLAGRPGSSPWPVDAV";

            (int actualBegin, char actualRefAminoAcid, char actualAltAminoAcid) =
                HgvsProtein.FindFirstChangeAfterFrameshift(6, aaSequence, altAaSequence);

            Assert.Equal(6,   actualBegin);
            Assert.Equal('D', actualRefAminoAcid);
            Assert.Equal('E', actualAltAminoAcid);
        }

        [Fact]
        public void FindFirstChangeAfterFrameshift_Insertion_Shifted()
        {
            const string aaSequence =
                "MEPPGDWGPPPWRSTPKTDVLRLVLYLTFLGAPCYAPALPSCKEDEYPVGSECCPKCSPGYRVKEACGELTGTVCEPCPPGTYIAHLNGLSKCLQCQMCDPDIGSPCDLRGRGHLEAGAHLSPGRQKGEPDPEVAFESLSAEPVHAANGSVPLEPHARLSMASAPCGQAGLHLRDRADGTPGGRA";
            const string altAaSequence =
                "MEPPGDWGPPPWRSTAPKPTS*GWCCISPSWEPPATPQLCRPARRTSTQWAPSAAPSAVQVIV*RRPAGS*RAQCVNPALQAPTLPTSMA*ASVCSAKCVTQILVPPVTSGEEVTWRLVPT*VQADRKGNQTQRWPLSH*AQSLSMRPTALSPWSLMPGSAWPVLPAARQDCTCGTGLTAHLGAGPEPTGRHRAGGLAMNRRGSWSALGVHACRLGFGAHTSTCMPSSMPLPSCESTCLLGLRMWGHRWQVRLPSGGAQAQLVPHLHQYLKKWGSHPTCLCHWNGLVCTDGKPVCGVGVWVGTWGEDLPAGPCPGTDSASSASCPSGQKAGFSHQRSPPRTFLQALVPHAALPSLGVPPGLRSSMLGTSGHLVWLSQGFSLAGRPGSSPWPVDAV";

            (int actualBegin, char actualRefAminoAcid, char actualAltAminoAcid) =
                HgvsProtein.FindFirstChangeAfterFrameshift(16, aaSequence, altAaSequence);

            Assert.Equal(16,  actualBegin);
            Assert.Equal('P', actualRefAminoAcid);
            Assert.Equal('A', actualAltAminoAcid);
        }

        [Fact]
        public void FindFirstChangeAfterFrameshift_Insertion_Shifted_BothHaveStopCodon()
        {
            const string aaSequence =
                "MKNVDSDDLVTGTLPKLKSSKEWLEPKPLCFMEVLAKEDTEAAIQSILYKENSVIKELDKYLQHHAFLNARRKEMLYKRWVDCVADPLQKKIIEKVCSHKKIKKRRQGELDGFLKHVNKKGNAFIEHYDPKEYDPFYMSKKDPNFLKVTIPPFHDPLKKAQYDKDNEKRTLLQCETGKIYSIKEFKEVEKVQLHSRFPQISNSRHFITPNEWLKLPTRYIESEFCRRRRLKVKVNFNDCSFDLKPLARAPYLLESQEEEKTVIYKNKGSSFLEREPLCYQEGNNPSAKEAISEGYFSSLSLSQEREEDQDGSPSPRLGLLKLEL*";
            const string altAaSequence =
                "MKNVDSDDLVTGTLPKLKSSKEWLEPKPLCFMEVLAKEDTEAAIQSILYKENSVIKELDKYLQHHAFLNARRKEMLYKRWVDCVADPLQKKIIEKVCSHKKIKKRRQGELDGFLKHVNKKGNAFIEHYDPKEYDPFYMSKKDPNFLKVTIPPFHDPLKKAQYDKDNEKRTLLQCETGKIYSIKEFKEVEKVQLHSRFPQISNSRHFITPNEWLKLPTRYIESEFCRRRRLKVKVNFNDCSFDLKPLARAPYLLESQEEEKTVIYKNKGSSFLEREPLCYQEGNNPSAKEAISEGYFSSLSLSQEREEDQDGSPSPRLGLLKLEL*ERRGRFQQPRSTHPDP*LVKGYTKSGCFRGSHLLTGIRVKAKDGTQELSCL*KKSICNELPLIFEFSVCDN*EMAIPCIFPRS*EILLNEPIKIITAPS";

            (int actualBegin, char actualRefAminoAcid, char actualAltAminoAcid) =
                HgvsProtein.FindFirstChangeAfterFrameshift(302, aaSequence, altAaSequence);

            Assert.Equal(325,  actualBegin);
            Assert.Equal('*', actualRefAminoAcid);
            Assert.Equal('*', actualAltAminoAcid);
        }

        [Fact]
        public void FindFirstChangeAfterFrameshift_Insertion_SameLength_Shifted()
        {
            const string aaSequence =
                "MVTEFIFLGLSDSQELQTFLFMLFFVFYGGIVFGNLLIVITVVSDSHLHSPMYFLLANLSLIDLSLSSVTAPKMITDFFSQRKVISFKGCLVQIFLLHFFGGSEMVILIAMGFDRYIAICKPLHYTTIMCGNACVGIMAVTWGIGFLHSVSQLAFAVHLLFCGPNEVDSFYCDLPRVIKLACTDTYRLDIMVIANSGVLTVCSFVLLIISYTIILMTIQHRPLDKSSKALSTLTAHITVVLLFFGPCVFIYAWPFPIKSLDKFLAVFYSVITPLLNPIIYTLRNKDMKTAIRQLRKWDAHSSVKF*";
            const string altAaSequence =
                "MVTEFIFLGLSDSQELQTFLFMLFFVFYGGIVFGNLLIVITVVSDSHLHSPMYFLLANLSLIDLSLSSVTAPKMITDFFSQRKVISFKGCLVQIFLLHFFGGSEMVILIAMGFDRYIAICKPLHYTTIMCGNACVGIMAVTWGIGFLHSVSQLAFAVHLSLLWSQ*GR*FLL*PS*GNQTCLYRYLQARYYGHC*QWCAHCVFFCSSNHLIHYHPNDHPASPFR*VVQSSVHFDCSHYSSSFVLWTMCLYLCLAIPHQVIR*IPCCILFCDHPSLEPNYIHTEEQRHEDGNKTAEKMGCTF*CKVL";

            (int actualBegin, char actualRefAminoAcid, char actualAltAminoAcid) =
                HgvsProtein.FindFirstChangeAfterFrameshift(159, aaSequence, altAaSequence);

            Assert.Equal(160, actualBegin);
            Assert.Equal('L', actualRefAminoAcid);
            Assert.Equal('S', actualAltAminoAcid);
        }

        [Fact]
        public void FindFirstChangeAfterFrameshift_Deletion_SameLength_NoShift()
        {
            const string aaSequence =
                "MAALPGTVPRMMRPAPGQNYPRTGFPLEVSTPLGQGRVNQLGGVFINGRPLPNHIRHKIVEMAHHGIRPCVISRQLRVSHGCVSKILCRYQETGSIRPGAIGGSKPRQVATPDVEKKIEEYKRENPGMFSWEIRDRLLKDGHCDRSTVPSVSSISRVLRIKFGKKEEEDEADKKEDDGEKKAKHSIDGILGDKGNRLDEGSDVESEPDLPLKRKQRRSRTTFTAEQLEELEKAFERTHYPDIYTREELAQRTKLTEARVQVWFSNRRARWRKQAGANQLAAFNHLLPGGFPPTGMPTLPPYQLPDSTYPTTTISQDGGSTVHRPQPLPPSTMHQGGLAAAAAAADTSSAYGARHSFSSYSDSFMNPAAPSNHMNPVSNGLSPQVMSILGNPSAVPPQPQADFSISPLHGGLDSATSISASCSQRADSIKPGDSLPTSQAYCPPTYSTTGYSVDPVAGYQYGQYGQTAVDYLAKNVSLSTQRRMKLGEHSAVLGLLPVETGQAY";
            const string altAaSequence =
                "MGPSRHGTENDAAGSGAELPPHGIPFGSVHPAWPRPGQSAGRGLHQWATPA*PHPPQDSGDGPPWHPALCHLPTAACLPRLRLQDSLPLPGDRVHPAWGHRRQQAQTGGDSGCREKD*GVQEGKPRHVQLGDPGQAAEGWAL*PKHCALSEFD*PRAQNQVREERGGG*SGQEGGRRRKEGQTQHRRHPGRQREPAGRGLGCGVGT*PPTEAQAATQSDHIHGRAAGGAGEGL*EDPLPRHIHPRGAGAEDQADRGACAGLVQ*PPRPLA*AGRSQPAGGVQPPSARRLPTHRHAHAAPLPAAGLHLPHHHHLPRWGQHCAPASAPATVHHAPGRAGCSGCSRRHQLCLRSPPQLLQLL*QLHESGGALQPHEPGQQRPVSSGDEHLGQPQCGAPAATG*LLHLPAAWRPGLGHLHLSQLQPAGRLHQARRQPAHLPGLLPTHLQHHRLQRGPRGRLSVRPVRPDCC*LSGQKCEPLHPASHEARGALCCAGTPACGNWPGLL";

            (int actualBegin, char actualRefAminoAcid, char actualAltAminoAcid) =
                HgvsProtein.FindFirstChangeAfterFrameshift(2, aaSequence, altAaSequence);

            Assert.Equal(2,  actualBegin);
            Assert.Equal('A', actualRefAminoAcid);
            Assert.Equal('G', actualAltAminoAcid);
        }
        
        [Fact]
        public void FindFirstChangeAfterFrameshift_Deletion_SameLength_Shifted()
        {
            const string aaSequence =
                "MAALPGTVPRMMRPAPGQNYPRTGFPLEVSTPLGQGRVNQLGGVFINGRPLPNHIRHKIVEMAHHGIRPCVISRQLRVSHGCVSKILCRYQETGSIRPGAIGGSKPRQVATPDVEKKIEEYKRENPGMFSWEIRDRLLKDGHCDRSTVPSVSSISRVLRIKFGKKEEEDEADKKEDDGEKKAKHSIDGILGDKGNRLDEGSDVESEPDLPLKRKQRRSRTTFTAEQLEELEKAFERTHYPDIYTREELAQRTKLTEARVQVWFSNRRARWRKQAGANQLAAFNHLLPGGFPPTGMPTLPPYQLPDSTYPTTTISQDGGSTVHRPQPLPPSTMHQGGLAAAAAAADTSSAYGARHSFSSYSDSFMNPAAPSNHMNPVSNGLSPQVMSILGNPSAVPPQPQADFSISPLHGGLDSATSISASCSQRADSIKPGDSLPTSQAYCPPTYSTTGYSVDPVAGYQYGQYGQTAVDYLAKNVSLSTQRRMKLGEHSAVLGLLPVETGQAY";
            const string altAaSequence =
                "MAALPGTVPRMMRPAPGQNYPRTGFPLEVSTPLGQGRVNQLGGVFINGRPLPNHIRHKIVEMAHHGIRPCVISRQLRVSHGCVSKILCRYQETGSIRPGAIGGSKPRQVATPDVEKKIEEYKRENPGMFSWEIRDRLLKDGHCDRSTVPSVSSISRVLRIKFGKKEEEDEADKKEDDGEKKAKHSIDGILGDKGNRLDEGSDVESEPDLPLKRKQRRSRTTFTAEQLEELEKAFERTHYPDIYTREELAQRTKLTEARVQVWFSNRRARWRKQAGANQLAAFNHLLPGGFPPTGMPTLPPYQLPDSTYPTTTISQDGGSTVHRPQPLPPSTMHQGGLAAAAAAADTSSAYGARHSFSSYSDSFMNPAAPSNHMNPVSNGLSPQVMSILGNPSAVPPQPQADFSISPLHGGLDSATSISQLQPAGRLHQARRQPAHLPGLLPTHLQHHRLQRGPRGRLSVRPVRPDCC*LSGQKCEPLHPASHEARGALCCAGTPACGNWPGLL";

            (int actualBegin, char actualRefAminoAcid, char actualAltAminoAcid) =
                HgvsProtein.FindFirstChangeAfterFrameshift(418, aaSequence, altAaSequence);

            Assert.Equal(419,   actualBegin);
            Assert.Equal('A', actualRefAminoAcid);
            Assert.Equal('Q', actualAltAminoAcid);
        }

        [Fact]
        public void FindFirstChangeAfterFrameshift_Deletion_NotShifted()
        {
            const string aaSequence =
                "MLGPAVLGLSLWALLHPGTGAPLCLSQQLRMKGDYVLGGLFPLGEAEEAGLRSRTRPSSPVCTRFSSNGLLWALAMKMAVEEINNKSDLLPGLRLGYDLFDTCSEPVVAMKPSLMFLAKAGSRDIAAYCNYTQYQPRVLAVIGPHSSELAMVTGKFFSFFLMPQVSYGASMELLSARETFPSFFRTVPSDRVQLTAAAELLQEFGWNWVAALGSDDEYGRQGLSIFSALAAARGICIAHEGLVPLPRADDSRLGKVQDVLHQVNQSSVQVVLLFASVHAAHALFNYSISSRLSPKVWVASEAWLTSDLVMGLPGMAQMGTVLGFLQRGAQLHEFPQYVKTHLALATDPAFCSALGEREQGLEEDVVGQRCPQCDCITLQNVSAGLNHHQTFSVYAAVYSVAQALHNTLQCNASGCPAQDPVKPWQLLENMYNLTFHVGGLPLRFDSSGNVDMEYDLKLWVWQGSVPRLHDVGRFNGSLRTERLKIRWHTSDNQKPVSRCSRQCQEGQVRRVKGFHSCCYDCVDCEAGSYRQNPDDIACTFCGQDEWSPERSTRCFRRRSRFLAWGEPAVLLLLLLLSLALGLVLAALGLFVHHRDSPLVQASGGPLACFGLVCLGLVCLSVLLFPGQPSPARCLAQQPLSHLPLTGCLSTLFLQAAEIFVESELPLSWADRLSGCLRGPWAWLVVLLAMLVEVALCTWYLVAFPPEVVTDWHMLPTEALVHCRTRSWVSFGLAHATNATLAFLCFLGTFLVRSQPGCYNRARGLTFAMLAYFITWVSFVPLLANVQVVLRPAVQMGALLLCVLGILAAFHLPRCYLLMRQPGLNTPEFFLGGGPGDAQGQNDGNTGNQGKHE";
            const string altAaSequence =
                "MLGPAVLGLSLWALLHPGTGAPLCLSQQLRMKGDYVLGGLFPLGEAEEAGLRSRTRPSSPVCTRFSSNGLLWALAMKMAVEEINNKSDLLPGLRLGYDLFDTCSEPVVAMKPSLMFLAKAGSRDIAAYCNYTQYQPRVLAVIGPHSSELAMVTGKFFSFFLMPQVSYGASMELLSARETFPSFFRTVPSDRVQLTAAAELLQEFGWNWVAALGSDDEYGRQGLSIFSALAAARGICIAHEGLVPLPRADDSRLGKVQDVLHQVNQSSVQVVLLFASVHAAHALFNYSISSRLSPKVWVASEAWLTSDLVMGLPGMAQMGTVLGFLQRGAQLHEFPQYVKTHLALATDPAFCSALGEREQGLEEDVVGQRCPQCDCITLQNVSAGLNHHQTFSVYAAVYSVAQALHNTLQCNASGCPAQDPVKPWQLLENMYNLTFHVGGLPLRFDSSGNVDMEYDLKLWVWQGSVPRLHDVGRFNGSLRTERLKIRWHTSDNQKPVSRCSRQCQEGQVRRVKGFHSCCYDCVDCEAGSYRQNPDDIACTFCGQDEWSPERSTRCFRRRSRFLAWGEPAVLLLLLLLSLALGLVLAALGLFTIGTAHWFRPRGGPWPALAWCAWAWSASASSCSLASPALPDAWPSSPCPTSRSRAA*AHSSCRRPRSSWSQNCL*AGQTG*VAACGGPGPGWWCCWPCWWRSHCAPGTWWPSRRRW*RTGTCCPRRRWCTAAHAPGSASA*RTPPMPRWPFSASWALSWCGASRAATTVPVASPLPCWPTSSPGSPLCPSWPMCRWSSGPPCRWAPSCSVSWASWLPSTCPGVTCSCGSQGSTPPSSSWEGALGMPKARMTGTQEIRGNMS";

            (int actualBegin, char actualRefAminoAcid, char actualAltAminoAcid) =
                HgvsProtein.FindFirstChangeAfterFrameshift(591, aaSequence, altAaSequence);

            Assert.Equal(591, actualBegin);
            Assert.Equal('V', actualRefAminoAcid);
            Assert.Equal('T', actualAltAminoAcid);
        }

        [Theory]
        [InlineData("MABCEFGH*",        5,  'D', 'E')]
        [InlineData("MABCDEFGHIIIKLL*", 15, '*', 'L')]
        [InlineData("MABCDEFGHIIIKL*",  15, '*', '*')]
        public void FindFirstChangeAfterFrameshift(string altAaSequence, int expectedBegin, char expectedRefAminoAcid,
            char expectedAltAminoAcid)
        {
            const int    aaBegin    = 4;
            const string aaSequence = "MABCDEFGHIIIKL*";

            (int actualBegin, char actualRefAminoAcid, char actualAltAminoAcid) =
                HgvsProtein.FindFirstChangeAfterFrameshift(aaBegin, aaSequence, altAaSequence);

            Assert.Equal(expectedBegin,        actualBegin);
            Assert.Equal(expectedRefAminoAcid, actualRefAminoAcid);
            Assert.Equal(expectedAltAminoAcid, actualAltAminoAcid);
        }
    }
}