using System.Collections.Generic;
using System.IO;
using System.Linq;
using SAUtils.DataStructures;
using SAUtils.gnomAD;
using UnitTests.TestUtilities;
using Xunit;

namespace UnitTests.SAUtils.gnomAD;

public sealed class GnomadSvBedParserTests
{
    private static Stream GetStreamData(string dataString)
    {
        var stream = new MemoryStream();
        var writer = new StreamWriter(stream);
        writer.Write(dataString);
        writer.Flush();
        stream.Position = 0;
        return stream;
    }

    [Fact]
    public void TestGnomadSvBedParser()
    {
        const string bedData =
            "#chrom\tstart\tend\tname\tsvtype\tALGORITHMS\tBOTHSIDES_SUPPORT\tCHR2\tCPX_INTERVALS\tCPX_TYPE\tEND2\tEND\tEVIDENCE\tHIGH_SR_BACKGROUND\tPCRPLUS_DEPLETED\tPESR_GT_OVERDISPERSION\tPOS2\tPROTEIN_CODING__COPY_GAIN\tPROTEIN_CODING__DUP_LOF\tPROTEIN_CODING__DUP_PARTIAL\tPROTEIN_CODING__INTERGENIC\tPROTEIN_CODING__INTRONIC\tPROTEIN_CODING__INV_SPAN\tPROTEIN_CODING__LOF\tPROTEIN_CODING__MSV_EXON_OVR\tPROTEIN_CODING__NEAREST_TSS\tPROTEIN_CODING__PROMOTER\tPROTEIN_CODING__UTR\tSOURCE\tSTRANDS\tSVLEN\tSVTYPE\tUNRESOLVED_TYPE\tUNSTABLE_AF_PCRPLUS\tVARIABLE_ACROSS_BATCHES\tAN\tAC\tAF\tN_BI_GENOS\tN_HOMREF\tN_HET\tN_HOMALT\tFREQ_HOMREF\tFREQ_HET\tFREQ_HOMALT\tMALE_AN\tMALE_AC\tMALE_AF\tMALE_N_BI_GENOS\tMALE_N_HOMREF\tMALE_N_HET\tMALE_N_HOMALT\tMALE_FREQ_HOMREF\tMALE_FREQ_HET\tMALE_FREQ_HOMALT\tMALE_N_HEMIREF\tMALE_N_HEMIALT\tMALE_FREQ_HEMIREF\tMALE_FREQ_HEMIALT\tPAR\tFEMALE_AN\tFEMALE_AC\tFEMALE_AF\tFEMALE_N_BI_GENOS\tFEMALE_N_HOMREF\tFEMALE_N_HET\tFEMALE_N_HOMALT\tFEMALE_FREQ_HOMREF\tFEMALE_FREQ_HET\tFEMALE_FREQ_HOMALT\tPOPMAX_AF\tAFR_AN\tAFR_AC\tAFR_AF\tAFR_N_BI_GENOS\tAFR_N_HOMREF\tAFR_N_HET\tAFR_N_HOMALT\tAFR_FREQ_HOMREF\tAFR_FREQ_HET\tAFR_FREQ_HOMALT\tAFR_MALE_AN\tAFR_MALE_AC\tAFR_MALE_AF\tAFR_MALE_N_BI_GENOS\tAFR_MALE_N_HOMREF\tAFR_MALE_N_HET\tAFR_MALE_N_HOMALT\tAFR_MALE_FREQ_HOMREF\tAFR_MALE_FREQ_HET\tAFR_MALE_FREQ_HOMALT\tAFR_MALE_N_HEMIREF\tAFR_MALE_N_HEMIALT\tAFR_MALE_FREQ_HEMIREF\tAFR_MALE_FREQ_HEMIALT\tAFR_FEMALE_AN\tAFR_FEMALE_AC\tAFR_FEMALE_AF\tAFR_FEMALE_N_BI_GENOS\tAFR_FEMALE_N_HOMREF\tAFR_FEMALE_N_HET\tAFR_FEMALE_N_HOMALT\tAFR_FEMALE_FREQ_HOMREF\tAFR_FEMALE_FREQ_HET\tAFR_FEMALE_FREQ_HOMALT\tAMR_AN\tAMR_AC\tAMR_AF\tAMR_N_BI_GENOS\tAMR_N_HOMREF\tAMR_N_HET\tAMR_N_HOMALT\tAMR_FREQ_HOMREF\tAMR_FREQ_HET\tAMR_FREQ_HOMALT\tAMR_MALE_AN\tAMR_MALE_AC\tAMR_MALE_AF\tAMR_MALE_N_BI_GENOS\tAMR_MALE_N_HOMREF\tAMR_MALE_N_HET\tAMR_MALE_N_HOMALT\tAMR_MALE_FREQ_HOMREF\tAMR_MALE_FREQ_HET\tAMR_MALE_FREQ_HOMALT\tAMR_MALE_N_HEMIREF\tAMR_MALE_N_HEMIALT\tAMR_MALE_FREQ_HEMIREF\tAMR_MALE_FREQ_HEMIALT\tAMR_FEMALE_AN\tAMR_FEMALE_AC\tAMR_FEMALE_AF\tAMR_FEMALE_N_BI_GENOS\tAMR_FEMALE_N_HOMREF\tAMR_FEMALE_N_HET\tAMR_FEMALE_N_HOMALT\tAMR_FEMALE_FREQ_HOMREF\tAMR_FEMALE_FREQ_HET\tAMR_FEMALE_FREQ_HOMALT\tEAS_AN\tEAS_AC\tEAS_AF\tEAS_N_BI_GENOS\tEAS_N_HOMREF\tEAS_N_HET\tEAS_N_HOMALT\tEAS_FREQ_HOMREF\tEAS_FREQ_HET\tEAS_FREQ_HOMALT\tEAS_MALE_AN\tEAS_MALE_AC\tEAS_MALE_AF\tEAS_MALE_N_BI_GENOS\tEAS_MALE_N_HOMREF\tEAS_MALE_N_HET\tEAS_MALE_N_HOMALT\tEAS_MALE_FREQ_HOMREF\tEAS_MALE_FREQ_HET\tEAS_MALE_FREQ_HOMALT\tEAS_MALE_N_HEMIREF\tEAS_MALE_N_HEMIALT\tEAS_MALE_FREQ_HEMIREF\tEAS_MALE_FREQ_HEMIALT\tEAS_FEMALE_AN\tEAS_FEMALE_AC\tEAS_FEMALE_AF\tEAS_FEMALE_N_BI_GENOS\tEAS_FEMALE_N_HOMREF\tEAS_FEMALE_N_HET\tEAS_FEMALE_N_HOMALT\tEAS_FEMALE_FREQ_HOMREF\tEAS_FEMALE_FREQ_HET\tEAS_FEMALE_FREQ_HOMALT\tEUR_AN\tEUR_AC\tEUR_AF\tEUR_N_BI_GENOS\tEUR_N_HOMREF\tEUR_N_HET\tEUR_N_HOMALT\tEUR_FREQ_HOMREF\tEUR_FREQ_HET\tEUR_FREQ_HOMALT\tEUR_MALE_AN\tEUR_MALE_AC\tEUR_MALE_AF\tEUR_MALE_N_BI_GENOS\tEUR_MALE_N_HOMREF\tEUR_MALE_N_HET\tEUR_MALE_N_HOMALT\tEUR_MALE_FREQ_HOMREF\tEUR_MALE_FREQ_HET\tEUR_MALE_FREQ_HOMALT\tEUR_MALE_N_HEMIREF\tEUR_MALE_N_HEMIALT\tEUR_MALE_FREQ_HEMIREF\tEUR_MALE_FREQ_HEMIALT\tEUR_FEMALE_AN\tEUR_FEMALE_AC\tEUR_FEMALE_AF\tEUR_FEMALE_N_BI_GENOS\tEUR_FEMALE_N_HOMREF\tEUR_FEMALE_N_HET\tEUR_FEMALE_N_HOMALT\tEUR_FEMALE_FREQ_HOMREF\tEUR_FEMALE_FREQ_HET\tEUR_FEMALE_FREQ_HOMALT\tOTH_AN\tOTH_AC\tOTH_AF\tOTH_N_BI_GENOS\tOTH_N_HOMREF\tOTH_N_HET\tOTH_N_HOMALT\tOTH_FREQ_HOMREF\tOTH_FREQ_HET\tOTH_FREQ_HOMALT\tOTH_MALE_AN\tOTH_MALE_AC\tOTH_MALE_AF\tOTH_MALE_N_BI_GENOS\tOTH_MALE_N_HOMREF\tOTH_MALE_N_HET\tOTH_MALE_N_HOMALT\tOTH_MALE_FREQ_HOMREF\tOTH_MALE_FREQ_HET\tOTH_MALE_FREQ_HOMALT\tOTH_MALE_N_HEMIREF\tOTH_MALE_N_HEMIALT\tOTH_MALE_FREQ_HEMIREF\tOTH_MALE_FREQ_HEMIALT\tOTH_FEMALE_AN\tOTH_FEMALE_AC\tOTH_FEMALE_AF\tOTH_FEMALE_N_BI_GENOS\tOTH_FEMALE_N_HOMREF\tOTH_FEMALE_N_HET\tOTH_FEMALE_N_HOMALT\tOTH_FEMALE_FREQ_HOMREF\tOTH_FEMALE_FREQ_HET\tOTH_FEMALE_FREQ_HOMALT\tFILTER\n" +
            "1\t10641\t10642\tgnomAD-SV_v2.1_BND_1_1\tBND\tmanta\tFalse\t15\tNA\tNA\t10643\t10643\tPE,SR\tFalse\tFalse\tTrue\t10642\tNA\tNA\tNA\tFalse\tNA\tNA\tNA\tNA\tNA\tNA\tNA\tNA\tNA\t-1\tBND\tSINGLE_ENDER_--\tFalse\tFalse\t21366\t145\t0.006785999983549118\t10683\t10543\t135\t5\t0.9868950247764587\t0.012636899948120117\t0.00046803298755548894\t10866\t69\t0.00634999992325902\t5433\t5366\t65\t2\t0.987667977809906\t0.011963900178670883\t0.000368120992789045\tNA\tNA\tNA\tNA\tFalse\t10454\t76\t0.007269999943673611\t5227\t5154\t70\t3\t0.9860339760780334\t0.013392000459134579\t0.0005739430198445916\t0.015956999734044075\t9398\t72\t0.007660999894142151\t4699\t4629\t68\t2\t0.9851030111312866\t0.014471200294792652\t0.0004256220126990229\t5154\t33\t0.006403000093996525\t2577\t2544\t33\t0\t0.9871940016746521\t0.012805599719285965\t0.0\tNA\tNA\tNA\tNA\t4232\t39\t0.009216000325977802\t2116\t2079\t35\t2\t0.9825140237808228\t0.01654059998691082\t0.0009451800142414868\t1910\t7\t0.003664999967440963\t955\t949\t5\t1\t0.9937170147895813\t0.00523559981957078\t0.001047119963914156\t950\t4\t0.004211000166833401\t475\t472\t2\t1\t0.9936839938163757\t0.00421052984893322\t0.0021052600350230932\tNA\tNA\tNA\tNA\t952\t3\t0.0031510000117123127\t476\t473\t3\t0\t0.9936969876289368\t0.006302520167082548\t0.0\t2296\t31\t0.013501999899744987\t1148\t1117\t31\t0\t0.9729970097541809\t0.02700350061058998\t0.0\t1312\t13\t0.009909000247716904\t656\t643\t13\t0\t0.9801830053329468\t0.01981710083782673\t0.0\tNA\tNA\tNA\tNA\t976\t18\t0.018442999571561813\t488\t470\t18\t0\t0.9631149768829346\t0.03688519820570946\t0.0\t7574\t32\t0.004224999807775021\t3787\t3757\t28\t2\t0.9920780062675476\t0.007393720094114542\t0.0005281229969114065\t3374\t17\t0.005038999952375889\t1687\t1671\t15\t1\t0.9905160069465637\t0.008891520090401173\t0.000592768017668277\tNA\tNA\tNA\tNA\t4182\t15\t0.003587000072002411\t2091\t2077\t13\t1\t0.9933050274848938\t0.006217120215296745\t0.00047823999193497\t188\t3\t0.015956999734044075\t94\t91\t3\t0\t0.968084990978241\t0.03191490098834038\t0.0\t76\t2\t0.026316000148653984\t38\t36\t2\t0\t0.9473680257797241\t0.05263160169124603\t0.0\tNA\tNA\tNA\tNA\t112\t1\t0.008929000236093998\t56\t55\t1\t0\t0.982142984867096\t0.017857100814580917\t0.0\tUNRESOLVED\n" +
            "1\t20999\t26000\tgnomAD-SV_v2.1_DEL_1_1\tDEL\tdepth\tFalse\tNA\tNA\tNA\tNA\t26000\tRD\tFalse\tFalse\tFalse\tNA\tNA\tNA\tNA\tTrue\tNA\tNA\tNA\tNA\tOR4F5\tNA\tNA\tNA\tNA\t5000\tDEL\tNA\tFalse\tFalse\t8586\t138\t0.01607299968600273\t4293\t4155\t138\t0\t0.9678549766540527\t0.03214539960026741\t0.0\t4302\t69\t0.01603900082409382\t2151\t2082\t69\t0\t0.9679219722747803\t0.0320780985057354\t0.0\tNA\tNA\tNA\tNA\tFalse\t4272\t68\t0.015917999669909477\t2136\t2068\t68\t0\t0.9681649804115295\t0.031835198402404785\t0.0\t0.07199999690055847\t3718\t27\t0.007261999882757664\t1859\t1832\t27\t0\t0.985476016998291\t0.014523900113999844\t0.0\t2016\t16\t0.007937000133097172\t1008\t992\t16\t0\t0.9841269850730896\t0.015873000025749207\t0.0\tNA\tNA\tNA\tNA\t1702\t11\t0.00646300008520484\t851\t840\t11\t0\t0.9870740175247192\t0.01292600017040968\t0.0\t684\t8\t0.011695999652147293\t342\t334\t8\t0\t0.9766079783439636\t0.02339180000126362\t0.0\t326\t2\t0.006134999915957451\t163\t161\t2\t0\t0.9877300262451172\t0.012269900180399418\t0.0\tNA\tNA\tNA\tNA\t358\t6\t0.016759999096393585\t179\t173\t6\t0\t0.966480016708374\t0.033519599586725235\t0.0\t750\t54\t0.07199999690055847\t375\t321\t54\t0\t0.8560000061988831\t0.14399999380111694\t0.0\t418\t28\t0.06698600202798843\t209\t181\t28\t0\t0.8660290241241455\t0.13397100567817688\t0.0\tNA\tNA\tNA\tNA\t328\t25\t0.07621999830007553\t164\t139\t25\t0\t0.8475610017776489\t0.15243899822235107\t0.0\t3346\t48\t0.014344999566674232\t1673\t1625\t48\t0\t0.9713090062141418\t0.028690999373793602\t0.0\t1498\t22\t0.014685999602079391\t749\t727\t22\t0\t0.9706270098686218\t0.029372500255703926\t0.0\tNA\tNA\tNA\tNA\t1840\t26\t0.01413000002503395\t920\t894\t26\t0\t0.9717389941215515\t0.02826089970767498\t0.0\t88\t1\t0.011363999918103218\t44\t43\t1\t0\t0.9772729873657227\t0.022727299481630325\t0.0\t44\t1\t0.0227269995957613\t22\t21\t1\t0\t0.9545450210571289\t0.04545449838042259\t0.0\tNA\tNA\tNA\tNA\t44\t0\t0.0\t22\t22\t0\t0\t1.0\t0.0\t0.0\tUNSTABLE_AF_PCRMINUS,LOW_CALL_RATE\n" +
            "1\t39999\t47200\tgnomAD-SV_v2.1_DUP_1_1\tDUP\tdepth\tFalse\tNA\tNA\tNA\tNA\t47200\tRD\tFalse\tFalse\tFalse\tNA\tNA\tNA\tNA\tTrue\tNA\tNA\tNA\tNA\tOR4F5\tNA\tNA\tNA\tNA\t7200\tDUP\tNA\tFalse\tFalse\t13674\t943\t0.06896299868822098\t6837\t5985\t761\t91\t0.8753839731216431\t0.11130599677562714\t0.013309899717569351\t6878\t499\t0.07254999876022339\t3439\t2987\t405\t47\t0.8685659766197205\t0.11776699870824814\t0.01366680022329092\tNA\tNA\tNA\tNA\tFalse\t6770\t442\t0.0652879998087883\t3385\t2987\t354\t44\t0.8824219703674316\t0.10457900166511536\t0.012998499907553196\t0.1356939971446991\t6382\t866\t0.1356939971446991\t3191\t2415\t686\t90\t0.756816029548645\t0.21498000621795654\t0.0282042995095253\t3470\t460\t0.13256500661373138\t1735\t1322\t366\t47\t0.7619600296020508\t0.21095100045204163\t0.027089299634099007\tNA\tNA\tNA\tNA\t2904\t404\t0.1391180008649826\t1452\t1091\t318\t43\t0.7513769865036011\t0.21900799870491028\t0.029614299535751343\t918\t21\t0.02287600003182888\t459\t439\t19\t1\t0.9564269781112671\t0.041394300758838654\t0.0021786498837172985\t426\t12\t0.028169000521302223\t213\t201\t12\t0\t0.9436619877815247\t0.056338001042604446\t0.0\tNA\tNA\tNA\tNA\t490\t9\t0.018366999924182892\t245\t237\t7\t1\t0.9673470258712769\t0.02857140079140663\t0.004081630147993565\t1544\t17\t0.011009999550879002\t772\t755\t17\t0\t0.9779790043830872\t0.022020699456334114\t0.0\t902\t11\t0.012195000424981117\t451\t440\t11\t0\t0.9756100177764893\t0.024390200152993202\t0.0\tNA\tNA\tNA\tNA\t638\t6\t0.009403999894857407\t319\t313\t6\t0\t0.9811909794807434\t0.018808800727128983\t0.0\t4716\t37\t0.007845999673008919\t2358\t2321\t37\t0\t0.9843090176582336\t0.015691300854086876\t0.0\t2034\t15\t0.007375000044703484\t1017\t1002\t15\t0\t0.9852510094642639\t0.014749299734830856\t0.0\tNA\tNA\tNA\tNA\t2670\t22\t0.00824000034481287\t1335\t1313\t22\t0\t0.9835209846496582\t0.016479400917887688\t0.0\t114\t2\t0.01754399947822094\t57\t55\t2\t0\t0.9649119973182678\t0.035087700933218\t0.0\t46\t1\t0.02173900045454502\t23\t22\t1\t0\t0.9565219879150391\t0.04347829893231392\t0.0\tNA\tNA\tNA\tNA\t68\t1\t0.014705999754369259\t34\t33\t1\t0\t0.9705880284309387\t0.02941180020570755\t0.0\tUNSTABLE_AF_PCRMINUS,LOW_CALL_RATE\n" +
            "1\t54664\t54666\tgnomAD-SV_v2.1_INS_1_1\tINS\tmanta\tFalse\t1\tNA\tNA\t54717\t54666\tSR\tTrue\tFalse\tFalse\t54716\tNA\tNA\tNA\tTrue\tNA\tNA\tNA\tNA\tOR4F5\tNA\tNA\tNA\tNA\t52\tINS\tNA\tFalse\tFalse\t21306\t2\t9.40000027185306e-05\t10653\t10651\t2\t0\t0.9998120069503784\t0.0001877409958979115\t0.0\t10870\t1\t9.200000204145908e-05\t5435\t5434\t1\t0\t0.9998160004615784\t0.00018399300461169332\t0.0\tNA\tNA\tNA\tNA\tFalse\t10390\t1\t9.600000339560211e-05\t5195\t5194\t1\t0\t0.9998080134391785\t0.00019249299657531083\t0.0\t0.0001340000017080456\t9380\t1\t0.00010699999984353781\t4690\t4689\t1\t0\t0.9997869729995728\t0.00021322000247891992\t0.0\t5148\t1\t0.0001939999929163605\t2574\t2573\t1\t0\t0.9996110200881958\t0.0003884999896399677\t0.0\tNA\tNA\tNA\tNA\t4220\t0\t0.0\t2110\t2110\t0\t0\t1.0\t0.0\t0.0\t1908\t0\t0.0\t954\t954\t0\t0\t1.0\t0.0\t0.0\t952\t0\t0.0\t476\t476\t0\t0\t1.0\t0.0\t0.0\tNA\tNA\tNA\tNA\t948\t0\t0.0\t474\t474\t0\t0\t1.0\t0.0\t0.0\t2366\t0\t0.0\t1183\t1183\t0\t0\t1.0\t0.0\t0.0\t1366\t0\t0.0\t683\t683\t0\t0\t1.0\t0.0\t0.0\tNA\tNA\tNA\tNA\t992\t0\t0.0\t496\t496\t0\t0\t1.0\t0.0\t0.0\t7462\t1\t0.0001340000017080456\t3731\t3730\t1\t0\t0.9997320175170898\t0.00026802500360645354\t0.0\t3328\t0\t0.0\t1664\t1664\t0\t0\t1.0\t0.0\t0.0\tNA\tNA\tNA\tNA\t4116\t1\t0.00024300000222865492\t2058\t2057\t1\t0\t0.9995139837265015\t0.00048590899677947164\t0.0\t190\t0\t0.0\t95\t95\t0\t0\t1.0\t0.0\t0.0\t76\t0\t0.0\t38\t38\t0\t0\t1.0\t0.0\t0.0\tNA\tNA\tNA\tNA\t114\t0\t0.0\t57\t57\t0\t0\t1.0\t0.0\t0.0\tPASS\n";

        using var reader         = new StreamReader(GetStreamData(bedData));
        using var gnomadSvParser = new GnomadSvBedParser(reader, ChromosomeUtilities.RefNameToChromosome);

        List<GnomadSvItem> svItemList = gnomadSvParser.GetItems().ToList();

        // Count is 3 becuase breakends are skipped
        Assert.Equal(3, svItemList.Count);

        Assert.Equal(
            "\"chromosome\":\"1\",\"begin\":21001,\"end\":26000,\"variantId\":\"gnomAD-SV_v2.1_DEL_1_1\",\"variantType\":\"deletion\",\"failedFilter\":true,\"allAf\":0.016073,\"afrAf\":0.007262,\"amrAf\":0.011696,\"easAf\":0.072,\"eurAf\":0.014345,\"othAf\":0.011364,\"femaleAf\":0.015918,\"maleAf\":0.016039,\"allAc\":138,\"afrAc\":27,\"amrAc\":8,\"easAc\":54,\"eurAc\":48,\"othAc\":1,\"femaleAc\":68,\"maleAc\":69,\"allAn\":8586,\"afrAn\":3718,\"amrAn\":684,\"easAn\":750,\"eurAn\":3346,\"othAn\":88,\"femaleAn\":4272,\"maleAn\":4302,\"allHc\":0,\"afrHc\":0,\"amrHc\":0,\"easHc\":0,\"eurHc\":0,\"othHc\":43,\"femaleHc\":0,\"maleHc\":0",
            svItemList[0].GetJsonString()
        );
        Assert.Equal(
            "\"chromosome\":\"1\",\"begin\":40001,\"end\":47200,\"variantId\":\"gnomAD-SV_v2.1_DUP_1_1\",\"variantType\":\"duplication\",\"failedFilter\":true,\"allAf\":0.068963,\"afrAf\":0.135694,\"amrAf\":0.022876,\"easAf\":0.01101,\"eurAf\":0.007846,\"othAf\":0.017544,\"femaleAf\":0.065288,\"maleAf\":0.07255,\"allAc\":943,\"afrAc\":866,\"amrAc\":21,\"easAc\":17,\"eurAc\":37,\"othAc\":2,\"femaleAc\":442,\"maleAc\":499,\"allAn\":13674,\"afrAn\":6382,\"amrAn\":918,\"easAn\":1544,\"eurAn\":4716,\"othAn\":114,\"femaleAn\":6770,\"maleAn\":6878,\"allHc\":91,\"afrHc\":90,\"amrHc\":1,\"easHc\":0,\"eurHc\":0,\"othHc\":55,\"femaleHc\":44,\"maleHc\":47",
            svItemList[1].GetJsonString()
        );
        Assert.Equal(
            "\"chromosome\":\"1\",\"begin\":54666,\"end\":54665,\"variantId\":\"gnomAD-SV_v2.1_INS_1_1\",\"variantType\":\"insertion\",\"allAf\":0.000094,\"afrAf\":0.000107,\"amrAf\":0,\"easAf\":0,\"eurAf\":0.000134,\"othAf\":0,\"femaleAf\":0.000096,\"maleAf\":0.000092,\"allAc\":2,\"afrAc\":1,\"amrAc\":0,\"easAc\":0,\"eurAc\":1,\"othAc\":0,\"femaleAc\":1,\"maleAc\":1,\"allAn\":21306,\"afrAn\":9380,\"amrAn\":1908,\"easAn\":2366,\"eurAn\":7462,\"othAn\":190,\"femaleAn\":10390,\"maleAn\":10870,\"allHc\":0,\"afrHc\":0,\"amrHc\":0,\"easHc\":0,\"eurHc\":0,\"othHc\":95,\"femaleHc\":0,\"maleHc\":0",
            svItemList[2].GetJsonString()
        );
    }

    [Fact]
    public void TestUnknownChromosome()
    {
        const string bedData =
            "#chrom\tstart\tend\tname\tsvtype\tALGORITHMS\tBOTHSIDES_SUPPORT\tCHR2\tCPX_INTERVALS\tCPX_TYPE\tEND2\tEND\tEVIDENCE\tHIGH_SR_BACKGROUND\tPCRPLUS_DEPLETED\tPESR_GT_OVERDISPERSION\tPOS2\tPROTEIN_CODING__COPY_GAIN\tPROTEIN_CODING__DUP_LOF\tPROTEIN_CODING__DUP_PARTIAL\tPROTEIN_CODING__INTERGENIC\tPROTEIN_CODING__INTRONIC\tPROTEIN_CODING__INV_SPAN\tPROTEIN_CODING__LOF\tPROTEIN_CODING__MSV_EXON_OVR\tPROTEIN_CODING__NEAREST_TSS\tPROTEIN_CODING__PROMOTER\tPROTEIN_CODING__UTR\tSOURCE\tSTRANDS\tSVLEN\tSVTYPE\tUNRESOLVED_TYPE\tUNSTABLE_AF_PCRPLUS\tVARIABLE_ACROSS_BATCHES\tAN\tAC\tAF\tN_BI_GENOS\tN_HOMREF\tN_HET\tN_HOMALT\tFREQ_HOMREF\tFREQ_HET\tFREQ_HOMALT\tMALE_AN\tMALE_AC\tMALE_AF\tMALE_N_BI_GENOS\tMALE_N_HOMREF\tMALE_N_HET\tMALE_N_HOMALT\tMALE_FREQ_HOMREF\tMALE_FREQ_HET\tMALE_FREQ_HOMALT\tMALE_N_HEMIREF\tMALE_N_HEMIALT\tMALE_FREQ_HEMIREF\tMALE_FREQ_HEMIALT\tPAR\tFEMALE_AN\tFEMALE_AC\tFEMALE_AF\tFEMALE_N_BI_GENOS\tFEMALE_N_HOMREF\tFEMALE_N_HET\tFEMALE_N_HOMALT\tFEMALE_FREQ_HOMREF\tFEMALE_FREQ_HET\tFEMALE_FREQ_HOMALT\tPOPMAX_AF\tAFR_AN\tAFR_AC\tAFR_AF\tAFR_N_BI_GENOS\tAFR_N_HOMREF\tAFR_N_HET\tAFR_N_HOMALT\tAFR_FREQ_HOMREF\tAFR_FREQ_HET\tAFR_FREQ_HOMALT\tAFR_MALE_AN\tAFR_MALE_AC\tAFR_MALE_AF\tAFR_MALE_N_BI_GENOS\tAFR_MALE_N_HOMREF\tAFR_MALE_N_HET\tAFR_MALE_N_HOMALT\tAFR_MALE_FREQ_HOMREF\tAFR_MALE_FREQ_HET\tAFR_MALE_FREQ_HOMALT\tAFR_MALE_N_HEMIREF\tAFR_MALE_N_HEMIALT\tAFR_MALE_FREQ_HEMIREF\tAFR_MALE_FREQ_HEMIALT\tAFR_FEMALE_AN\tAFR_FEMALE_AC\tAFR_FEMALE_AF\tAFR_FEMALE_N_BI_GENOS\tAFR_FEMALE_N_HOMREF\tAFR_FEMALE_N_HET\tAFR_FEMALE_N_HOMALT\tAFR_FEMALE_FREQ_HOMREF\tAFR_FEMALE_FREQ_HET\tAFR_FEMALE_FREQ_HOMALT\tAMR_AN\tAMR_AC\tAMR_AF\tAMR_N_BI_GENOS\tAMR_N_HOMREF\tAMR_N_HET\tAMR_N_HOMALT\tAMR_FREQ_HOMREF\tAMR_FREQ_HET\tAMR_FREQ_HOMALT\tAMR_MALE_AN\tAMR_MALE_AC\tAMR_MALE_AF\tAMR_MALE_N_BI_GENOS\tAMR_MALE_N_HOMREF\tAMR_MALE_N_HET\tAMR_MALE_N_HOMALT\tAMR_MALE_FREQ_HOMREF\tAMR_MALE_FREQ_HET\tAMR_MALE_FREQ_HOMALT\tAMR_MALE_N_HEMIREF\tAMR_MALE_N_HEMIALT\tAMR_MALE_FREQ_HEMIREF\tAMR_MALE_FREQ_HEMIALT\tAMR_FEMALE_AN\tAMR_FEMALE_AC\tAMR_FEMALE_AF\tAMR_FEMALE_N_BI_GENOS\tAMR_FEMALE_N_HOMREF\tAMR_FEMALE_N_HET\tAMR_FEMALE_N_HOMALT\tAMR_FEMALE_FREQ_HOMREF\tAMR_FEMALE_FREQ_HET\tAMR_FEMALE_FREQ_HOMALT\tEAS_AN\tEAS_AC\tEAS_AF\tEAS_N_BI_GENOS\tEAS_N_HOMREF\tEAS_N_HET\tEAS_N_HOMALT\tEAS_FREQ_HOMREF\tEAS_FREQ_HET\tEAS_FREQ_HOMALT\tEAS_MALE_AN\tEAS_MALE_AC\tEAS_MALE_AF\tEAS_MALE_N_BI_GENOS\tEAS_MALE_N_HOMREF\tEAS_MALE_N_HET\tEAS_MALE_N_HOMALT\tEAS_MALE_FREQ_HOMREF\tEAS_MALE_FREQ_HET\tEAS_MALE_FREQ_HOMALT\tEAS_MALE_N_HEMIREF\tEAS_MALE_N_HEMIALT\tEAS_MALE_FREQ_HEMIREF\tEAS_MALE_FREQ_HEMIALT\tEAS_FEMALE_AN\tEAS_FEMALE_AC\tEAS_FEMALE_AF\tEAS_FEMALE_N_BI_GENOS\tEAS_FEMALE_N_HOMREF\tEAS_FEMALE_N_HET\tEAS_FEMALE_N_HOMALT\tEAS_FEMALE_FREQ_HOMREF\tEAS_FEMALE_FREQ_HET\tEAS_FEMALE_FREQ_HOMALT\tEUR_AN\tEUR_AC\tEUR_AF\tEUR_N_BI_GENOS\tEUR_N_HOMREF\tEUR_N_HET\tEUR_N_HOMALT\tEUR_FREQ_HOMREF\tEUR_FREQ_HET\tEUR_FREQ_HOMALT\tEUR_MALE_AN\tEUR_MALE_AC\tEUR_MALE_AF\tEUR_MALE_N_BI_GENOS\tEUR_MALE_N_HOMREF\tEUR_MALE_N_HET\tEUR_MALE_N_HOMALT\tEUR_MALE_FREQ_HOMREF\tEUR_MALE_FREQ_HET\tEUR_MALE_FREQ_HOMALT\tEUR_MALE_N_HEMIREF\tEUR_MALE_N_HEMIALT\tEUR_MALE_FREQ_HEMIREF\tEUR_MALE_FREQ_HEMIALT\tEUR_FEMALE_AN\tEUR_FEMALE_AC\tEUR_FEMALE_AF\tEUR_FEMALE_N_BI_GENOS\tEUR_FEMALE_N_HOMREF\tEUR_FEMALE_N_HET\tEUR_FEMALE_N_HOMALT\tEUR_FEMALE_FREQ_HOMREF\tEUR_FEMALE_FREQ_HET\tEUR_FEMALE_FREQ_HOMALT\tOTH_AN\tOTH_AC\tOTH_AF\tOTH_N_BI_GENOS\tOTH_N_HOMREF\tOTH_N_HET\tOTH_N_HOMALT\tOTH_FREQ_HOMREF\tOTH_FREQ_HET\tOTH_FREQ_HOMALT\tOTH_MALE_AN\tOTH_MALE_AC\tOTH_MALE_AF\tOTH_MALE_N_BI_GENOS\tOTH_MALE_N_HOMREF\tOTH_MALE_N_HET\tOTH_MALE_N_HOMALT\tOTH_MALE_FREQ_HOMREF\tOTH_MALE_FREQ_HET\tOTH_MALE_FREQ_HOMALT\tOTH_MALE_N_HEMIREF\tOTH_MALE_N_HEMIALT\tOTH_MALE_FREQ_HEMIREF\tOTH_MALE_FREQ_HEMIALT\tOTH_FEMALE_AN\tOTH_FEMALE_AC\tOTH_FEMALE_AF\tOTH_FEMALE_N_BI_GENOS\tOTH_FEMALE_N_HOMREF\tOTH_FEMALE_N_HET\tOTH_FEMALE_N_HOMALT\tOTH_FEMALE_FREQ_HOMREF\tOTH_FEMALE_FREQ_HET\tOTH_FEMALE_FREQ_HOMALT\tFILTER\n" +
            "InvalidNumber\t10641\t10642\tgnomAD-SV_v2.1_BND_1_1\tBND\tmanta\tFalse\t15\tNA\tNA\t10643\t10643\tPE,SR\tFalse\tFalse\tTrue\t10642\tNA\tNA\tNA\tFalse\tNA\tNA\tNA\tNA\tNA\tNA\tNA\tNA\tNA\t-1\tBND\tSINGLE_ENDER_--\tFalse\tFalse\t21366\t145\t0.006785999983549118\t10683\t10543\t135\t5\t0.9868950247764587\t0.012636899948120117\t0.00046803298755548894\t10866\t69\t0.00634999992325902\t5433\t5366\t65\t2\t0.987667977809906\t0.011963900178670883\t0.000368120992789045\tNA\tNA\tNA\tNA\tFalse\t10454\t76\t0.007269999943673611\t5227\t5154\t70\t3\t0.9860339760780334\t0.013392000459134579\t0.0005739430198445916\t0.015956999734044075\t9398\t72\t0.007660999894142151\t4699\t4629\t68\t2\t0.9851030111312866\t0.014471200294792652\t0.0004256220126990229\t5154\t33\t0.006403000093996525\t2577\t2544\t33\t0\t0.9871940016746521\t0.012805599719285965\t0.0\tNA\tNA\tNA\tNA\t4232\t39\t0.009216000325977802\t2116\t2079\t35\t2\t0.9825140237808228\t0.01654059998691082\t0.0009451800142414868\t1910\t7\t0.003664999967440963\t955\t949\t5\t1\t0.9937170147895813\t0.00523559981957078\t0.001047119963914156\t950\t4\t0.004211000166833401\t475\t472\t2\t1\t0.9936839938163757\t0.00421052984893322\t0.0021052600350230932\tNA\tNA\tNA\tNA\t952\t3\t0.0031510000117123127\t476\t473\t3\t0\t0.9936969876289368\t0.006302520167082548\t0.0\t2296\t31\t0.013501999899744987\t1148\t1117\t31\t0\t0.9729970097541809\t0.02700350061058998\t0.0\t1312\t13\t0.009909000247716904\t656\t643\t13\t0\t0.9801830053329468\t0.01981710083782673\t0.0\tNA\tNA\tNA\tNA\t976\t18\t0.018442999571561813\t488\t470\t18\t0\t0.9631149768829346\t0.03688519820570946\t0.0\t7574\t32\t0.004224999807775021\t3787\t3757\t28\t2\t0.9920780062675476\t0.007393720094114542\t0.0005281229969114065\t3374\t17\t0.005038999952375889\t1687\t1671\t15\t1\t0.9905160069465637\t0.008891520090401173\t0.000592768017668277\tNA\tNA\tNA\tNA\t4182\t15\t0.003587000072002411\t2091\t2077\t13\t1\t0.9933050274848938\t0.006217120215296745\t0.00047823999193497\t188\t3\t0.015956999734044075\t94\t91\t3\t0\t0.968084990978241\t0.03191490098834038\t0.0\t76\t2\t0.026316000148653984\t38\t36\t2\t0\t0.9473680257797241\t0.05263160169124603\t0.0\tNA\tNA\tNA\tNA\t112\t1\t0.008929000236093998\t56\t55\t1\t0\t0.982142984867096\t0.017857100814580917\t0.0\tUNRESOLVED\n" +
            "1\t20999\t26000\tgnomAD-SV_v2.1_DEL_1_1\tDEL\tdepth\tFalse\tNA\tNA\tNA\tNA\t26000\tRD\tFalse\tFalse\tFalse\tNA\tNA\tNA\tNA\tTrue\tNA\tNA\tNA\tNA\tOR4F5\tNA\tNA\tNA\tNA\t5000\tDEL\tNA\tFalse\tFalse\t8586\t138\t0.01607299968600273\t4293\t4155\t138\t0\t0.9678549766540527\t0.03214539960026741\t0.0\t4302\t69\t0.01603900082409382\t2151\t2082\t69\t0\t0.9679219722747803\t0.0320780985057354\t0.0\tNA\tNA\tNA\tNA\tFalse\t4272\t68\t0.015917999669909477\t2136\t2068\t68\t0\t0.9681649804115295\t0.031835198402404785\t0.0\t0.07199999690055847\t3718\t27\t0.007261999882757664\t1859\t1832\t27\t0\t0.985476016998291\t0.014523900113999844\t0.0\t2016\t16\t0.007937000133097172\t1008\t992\t16\t0\t0.9841269850730896\t0.015873000025749207\t0.0\tNA\tNA\tNA\tNA\t1702\t11\t0.00646300008520484\t851\t840\t11\t0\t0.9870740175247192\t0.01292600017040968\t0.0\t684\t8\t0.011695999652147293\t342\t334\t8\t0\t0.9766079783439636\t0.02339180000126362\t0.0\t326\t2\t0.006134999915957451\t163\t161\t2\t0\t0.9877300262451172\t0.012269900180399418\t0.0\tNA\tNA\tNA\tNA\t358\t6\t0.016759999096393585\t179\t173\t6\t0\t0.966480016708374\t0.033519599586725235\t0.0\t750\t54\t0.07199999690055847\t375\t321\t54\t0\t0.8560000061988831\t0.14399999380111694\t0.0\t418\t28\t0.06698600202798843\t209\t181\t28\t0\t0.8660290241241455\t0.13397100567817688\t0.0\tNA\tNA\tNA\tNA\t328\t25\t0.07621999830007553\t164\t139\t25\t0\t0.8475610017776489\t0.15243899822235107\t0.0\t3346\t48\t0.014344999566674232\t1673\t1625\t48\t0\t0.9713090062141418\t0.028690999373793602\t0.0\t1498\t22\t0.014685999602079391\t749\t727\t22\t0\t0.9706270098686218\t0.029372500255703926\t0.0\tNA\tNA\tNA\tNA\t1840\t26\t0.01413000002503395\t920\t894\t26\t0\t0.9717389941215515\t0.02826089970767498\t0.0\t88\t1\t0.011363999918103218\t44\t43\t1\t0\t0.9772729873657227\t0.022727299481630325\t0.0\t44\t1\t0.0227269995957613\t22\t21\t1\t0\t0.9545450210571289\t0.04545449838042259\t0.0\tNA\tNA\tNA\tNA\t44\t0\t0.0\t22\t22\t0\t0\t1.0\t0.0\t0.0\tUNSTABLE_AF_PCRMINUS,LOW_CALL_RATE\n";

        using var reader         = new StreamReader(GetStreamData(bedData));
        using var gnomadSvParser = new GnomadSvBedParser(reader, ChromosomeUtilities.RefNameToChromosome);

        List<GnomadSvItem> svItemList = gnomadSvParser.GetItems().ToList();

        Assert.Single(svItemList);


        Assert.Equal(
            "\"chromosome\":\"1\",\"begin\":21001,\"end\":26000,\"variantId\":\"gnomAD-SV_v2.1_DEL_1_1\",\"variantType\":\"deletion\",\"failedFilter\":true,\"allAf\":0.016073,\"afrAf\":0.007262,\"amrAf\":0.011696,\"easAf\":0.072,\"eurAf\":0.014345,\"othAf\":0.011364,\"femaleAf\":0.015918,\"maleAf\":0.016039,\"allAc\":138,\"afrAc\":27,\"amrAc\":8,\"easAc\":54,\"eurAc\":48,\"othAc\":1,\"femaleAc\":68,\"maleAc\":69,\"allAn\":8586,\"afrAn\":3718,\"amrAn\":684,\"easAn\":750,\"eurAn\":3346,\"othAn\":88,\"femaleAn\":4272,\"maleAn\":4302,\"allHc\":0,\"afrHc\":0,\"amrHc\":0,\"easHc\":0,\"eurHc\":0,\"othHc\":43,\"femaleHc\":0,\"maleHc\":0",
            svItemList[0].GetJsonString()
        );
    }

    [Fact]
    public void TestInvalidStart()
    {
        const string bedData =
            "#chrom\tstart\tend\tname\tsvtype\tALGORITHMS\tBOTHSIDES_SUPPORT\tCHR2\tCPX_INTERVALS\tCPX_TYPE\tEND2\tEND\tEVIDENCE\tHIGH_SR_BACKGROUND\tPCRPLUS_DEPLETED\tPESR_GT_OVERDISPERSION\tPOS2\tPROTEIN_CODING__COPY_GAIN\tPROTEIN_CODING__DUP_LOF\tPROTEIN_CODING__DUP_PARTIAL\tPROTEIN_CODING__INTERGENIC\tPROTEIN_CODING__INTRONIC\tPROTEIN_CODING__INV_SPAN\tPROTEIN_CODING__LOF\tPROTEIN_CODING__MSV_EXON_OVR\tPROTEIN_CODING__NEAREST_TSS\tPROTEIN_CODING__PROMOTER\tPROTEIN_CODING__UTR\tSOURCE\tSTRANDS\tSVLEN\tSVTYPE\tUNRESOLVED_TYPE\tUNSTABLE_AF_PCRPLUS\tVARIABLE_ACROSS_BATCHES\tAN\tAC\tAF\tN_BI_GENOS\tN_HOMREF\tN_HET\tN_HOMALT\tFREQ_HOMREF\tFREQ_HET\tFREQ_HOMALT\tMALE_AN\tMALE_AC\tMALE_AF\tMALE_N_BI_GENOS\tMALE_N_HOMREF\tMALE_N_HET\tMALE_N_HOMALT\tMALE_FREQ_HOMREF\tMALE_FREQ_HET\tMALE_FREQ_HOMALT\tMALE_N_HEMIREF\tMALE_N_HEMIALT\tMALE_FREQ_HEMIREF\tMALE_FREQ_HEMIALT\tPAR\tFEMALE_AN\tFEMALE_AC\tFEMALE_AF\tFEMALE_N_BI_GENOS\tFEMALE_N_HOMREF\tFEMALE_N_HET\tFEMALE_N_HOMALT\tFEMALE_FREQ_HOMREF\tFEMALE_FREQ_HET\tFEMALE_FREQ_HOMALT\tPOPMAX_AF\tAFR_AN\tAFR_AC\tAFR_AF\tAFR_N_BI_GENOS\tAFR_N_HOMREF\tAFR_N_HET\tAFR_N_HOMALT\tAFR_FREQ_HOMREF\tAFR_FREQ_HET\tAFR_FREQ_HOMALT\tAFR_MALE_AN\tAFR_MALE_AC\tAFR_MALE_AF\tAFR_MALE_N_BI_GENOS\tAFR_MALE_N_HOMREF\tAFR_MALE_N_HET\tAFR_MALE_N_HOMALT\tAFR_MALE_FREQ_HOMREF\tAFR_MALE_FREQ_HET\tAFR_MALE_FREQ_HOMALT\tAFR_MALE_N_HEMIREF\tAFR_MALE_N_HEMIALT\tAFR_MALE_FREQ_HEMIREF\tAFR_MALE_FREQ_HEMIALT\tAFR_FEMALE_AN\tAFR_FEMALE_AC\tAFR_FEMALE_AF\tAFR_FEMALE_N_BI_GENOS\tAFR_FEMALE_N_HOMREF\tAFR_FEMALE_N_HET\tAFR_FEMALE_N_HOMALT\tAFR_FEMALE_FREQ_HOMREF\tAFR_FEMALE_FREQ_HET\tAFR_FEMALE_FREQ_HOMALT\tAMR_AN\tAMR_AC\tAMR_AF\tAMR_N_BI_GENOS\tAMR_N_HOMREF\tAMR_N_HET\tAMR_N_HOMALT\tAMR_FREQ_HOMREF\tAMR_FREQ_HET\tAMR_FREQ_HOMALT\tAMR_MALE_AN\tAMR_MALE_AC\tAMR_MALE_AF\tAMR_MALE_N_BI_GENOS\tAMR_MALE_N_HOMREF\tAMR_MALE_N_HET\tAMR_MALE_N_HOMALT\tAMR_MALE_FREQ_HOMREF\tAMR_MALE_FREQ_HET\tAMR_MALE_FREQ_HOMALT\tAMR_MALE_N_HEMIREF\tAMR_MALE_N_HEMIALT\tAMR_MALE_FREQ_HEMIREF\tAMR_MALE_FREQ_HEMIALT\tAMR_FEMALE_AN\tAMR_FEMALE_AC\tAMR_FEMALE_AF\tAMR_FEMALE_N_BI_GENOS\tAMR_FEMALE_N_HOMREF\tAMR_FEMALE_N_HET\tAMR_FEMALE_N_HOMALT\tAMR_FEMALE_FREQ_HOMREF\tAMR_FEMALE_FREQ_HET\tAMR_FEMALE_FREQ_HOMALT\tEAS_AN\tEAS_AC\tEAS_AF\tEAS_N_BI_GENOS\tEAS_N_HOMREF\tEAS_N_HET\tEAS_N_HOMALT\tEAS_FREQ_HOMREF\tEAS_FREQ_HET\tEAS_FREQ_HOMALT\tEAS_MALE_AN\tEAS_MALE_AC\tEAS_MALE_AF\tEAS_MALE_N_BI_GENOS\tEAS_MALE_N_HOMREF\tEAS_MALE_N_HET\tEAS_MALE_N_HOMALT\tEAS_MALE_FREQ_HOMREF\tEAS_MALE_FREQ_HET\tEAS_MALE_FREQ_HOMALT\tEAS_MALE_N_HEMIREF\tEAS_MALE_N_HEMIALT\tEAS_MALE_FREQ_HEMIREF\tEAS_MALE_FREQ_HEMIALT\tEAS_FEMALE_AN\tEAS_FEMALE_AC\tEAS_FEMALE_AF\tEAS_FEMALE_N_BI_GENOS\tEAS_FEMALE_N_HOMREF\tEAS_FEMALE_N_HET\tEAS_FEMALE_N_HOMALT\tEAS_FEMALE_FREQ_HOMREF\tEAS_FEMALE_FREQ_HET\tEAS_FEMALE_FREQ_HOMALT\tEUR_AN\tEUR_AC\tEUR_AF\tEUR_N_BI_GENOS\tEUR_N_HOMREF\tEUR_N_HET\tEUR_N_HOMALT\tEUR_FREQ_HOMREF\tEUR_FREQ_HET\tEUR_FREQ_HOMALT\tEUR_MALE_AN\tEUR_MALE_AC\tEUR_MALE_AF\tEUR_MALE_N_BI_GENOS\tEUR_MALE_N_HOMREF\tEUR_MALE_N_HET\tEUR_MALE_N_HOMALT\tEUR_MALE_FREQ_HOMREF\tEUR_MALE_FREQ_HET\tEUR_MALE_FREQ_HOMALT\tEUR_MALE_N_HEMIREF\tEUR_MALE_N_HEMIALT\tEUR_MALE_FREQ_HEMIREF\tEUR_MALE_FREQ_HEMIALT\tEUR_FEMALE_AN\tEUR_FEMALE_AC\tEUR_FEMALE_AF\tEUR_FEMALE_N_BI_GENOS\tEUR_FEMALE_N_HOMREF\tEUR_FEMALE_N_HET\tEUR_FEMALE_N_HOMALT\tEUR_FEMALE_FREQ_HOMREF\tEUR_FEMALE_FREQ_HET\tEUR_FEMALE_FREQ_HOMALT\tOTH_AN\tOTH_AC\tOTH_AF\tOTH_N_BI_GENOS\tOTH_N_HOMREF\tOTH_N_HET\tOTH_N_HOMALT\tOTH_FREQ_HOMREF\tOTH_FREQ_HET\tOTH_FREQ_HOMALT\tOTH_MALE_AN\tOTH_MALE_AC\tOTH_MALE_AF\tOTH_MALE_N_BI_GENOS\tOTH_MALE_N_HOMREF\tOTH_MALE_N_HET\tOTH_MALE_N_HOMALT\tOTH_MALE_FREQ_HOMREF\tOTH_MALE_FREQ_HET\tOTH_MALE_FREQ_HOMALT\tOTH_MALE_N_HEMIREF\tOTH_MALE_N_HEMIALT\tOTH_MALE_FREQ_HEMIREF\tOTH_MALE_FREQ_HEMIALT\tOTH_FEMALE_AN\tOTH_FEMALE_AC\tOTH_FEMALE_AF\tOTH_FEMALE_N_BI_GENOS\tOTH_FEMALE_N_HOMREF\tOTH_FEMALE_N_HET\tOTH_FEMALE_N_HOMALT\tOTH_FEMALE_FREQ_HOMREF\tOTH_FEMALE_FREQ_HET\tOTH_FEMALE_FREQ_HOMALT\tFILTER\n" +
            "1\tInvalid-10641\t10642\tgnomAD-SV_v2.1_BND_1_1\tBND\tmanta\tFalse\t15\tNA\tNA\t10643\t10643\tPE,SR\tFalse\tFalse\tTrue\t10642\tNA\tNA\tNA\tFalse\tNA\tNA\tNA\tNA\tNA\tNA\tNA\tNA\tNA\t-1\tBND\tSINGLE_ENDER_--\tFalse\tFalse\t21366\t145\t0.006785999983549118\t10683\t10543\t135\t5\t0.9868950247764587\t0.012636899948120117\t0.00046803298755548894\t10866\t69\t0.00634999992325902\t5433\t5366\t65\t2\t0.987667977809906\t0.011963900178670883\t0.000368120992789045\tNA\tNA\tNA\tNA\tFalse\t10454\t76\t0.007269999943673611\t5227\t5154\t70\t3\t0.9860339760780334\t0.013392000459134579\t0.0005739430198445916\t0.015956999734044075\t9398\t72\t0.007660999894142151\t4699\t4629\t68\t2\t0.9851030111312866\t0.014471200294792652\t0.0004256220126990229\t5154\t33\t0.006403000093996525\t2577\t2544\t33\t0\t0.9871940016746521\t0.012805599719285965\t0.0\tNA\tNA\tNA\tNA\t4232\t39\t0.009216000325977802\t2116\t2079\t35\t2\t0.9825140237808228\t0.01654059998691082\t0.0009451800142414868\t1910\t7\t0.003664999967440963\t955\t949\t5\t1\t0.9937170147895813\t0.00523559981957078\t0.001047119963914156\t950\t4\t0.004211000166833401\t475\t472\t2\t1\t0.9936839938163757\t0.00421052984893322\t0.0021052600350230932\tNA\tNA\tNA\tNA\t952\t3\t0.0031510000117123127\t476\t473\t3\t0\t0.9936969876289368\t0.006302520167082548\t0.0\t2296\t31\t0.013501999899744987\t1148\t1117\t31\t0\t0.9729970097541809\t0.02700350061058998\t0.0\t1312\t13\t0.009909000247716904\t656\t643\t13\t0\t0.9801830053329468\t0.01981710083782673\t0.0\tNA\tNA\tNA\tNA\t976\t18\t0.018442999571561813\t488\t470\t18\t0\t0.9631149768829346\t0.03688519820570946\t0.0\t7574\t32\t0.004224999807775021\t3787\t3757\t28\t2\t0.9920780062675476\t0.007393720094114542\t0.0005281229969114065\t3374\t17\t0.005038999952375889\t1687\t1671\t15\t1\t0.9905160069465637\t0.008891520090401173\t0.000592768017668277\tNA\tNA\tNA\tNA\t4182\t15\t0.003587000072002411\t2091\t2077\t13\t1\t0.9933050274848938\t0.006217120215296745\t0.00047823999193497\t188\t3\t0.015956999734044075\t94\t91\t3\t0\t0.968084990978241\t0.03191490098834038\t0.0\t76\t2\t0.026316000148653984\t38\t36\t2\t0\t0.9473680257797241\t0.05263160169124603\t0.0\tNA\tNA\tNA\tNA\t112\t1\t0.008929000236093998\t56\t55\t1\t0\t0.982142984867096\t0.017857100814580917\t0.0\tUNRESOLVED\n";

        using var reader         = new StreamReader(GetStreamData(bedData));
        using var gnomadSvParser = new GnomadSvBedParser(reader, ChromosomeUtilities.RefNameToChromosome);

        Assert.Throws<InvalidDataException>(() => gnomadSvParser.GetItems().ToList());
    }

    [Fact]
    public void TestInvalidEnd()
    {
        const string bedData =
            "#chrom\tstart\tend\tname\tsvtype\tALGORITHMS\tBOTHSIDES_SUPPORT\tCHR2\tCPX_INTERVALS\tCPX_TYPE\tEND2\tEND\tEVIDENCE\tHIGH_SR_BACKGROUND\tPCRPLUS_DEPLETED\tPESR_GT_OVERDISPERSION\tPOS2\tPROTEIN_CODING__COPY_GAIN\tPROTEIN_CODING__DUP_LOF\tPROTEIN_CODING__DUP_PARTIAL\tPROTEIN_CODING__INTERGENIC\tPROTEIN_CODING__INTRONIC\tPROTEIN_CODING__INV_SPAN\tPROTEIN_CODING__LOF\tPROTEIN_CODING__MSV_EXON_OVR\tPROTEIN_CODING__NEAREST_TSS\tPROTEIN_CODING__PROMOTER\tPROTEIN_CODING__UTR\tSOURCE\tSTRANDS\tSVLEN\tSVTYPE\tUNRESOLVED_TYPE\tUNSTABLE_AF_PCRPLUS\tVARIABLE_ACROSS_BATCHES\tAN\tAC\tAF\tN_BI_GENOS\tN_HOMREF\tN_HET\tN_HOMALT\tFREQ_HOMREF\tFREQ_HET\tFREQ_HOMALT\tMALE_AN\tMALE_AC\tMALE_AF\tMALE_N_BI_GENOS\tMALE_N_HOMREF\tMALE_N_HET\tMALE_N_HOMALT\tMALE_FREQ_HOMREF\tMALE_FREQ_HET\tMALE_FREQ_HOMALT\tMALE_N_HEMIREF\tMALE_N_HEMIALT\tMALE_FREQ_HEMIREF\tMALE_FREQ_HEMIALT\tPAR\tFEMALE_AN\tFEMALE_AC\tFEMALE_AF\tFEMALE_N_BI_GENOS\tFEMALE_N_HOMREF\tFEMALE_N_HET\tFEMALE_N_HOMALT\tFEMALE_FREQ_HOMREF\tFEMALE_FREQ_HET\tFEMALE_FREQ_HOMALT\tPOPMAX_AF\tAFR_AN\tAFR_AC\tAFR_AF\tAFR_N_BI_GENOS\tAFR_N_HOMREF\tAFR_N_HET\tAFR_N_HOMALT\tAFR_FREQ_HOMREF\tAFR_FREQ_HET\tAFR_FREQ_HOMALT\tAFR_MALE_AN\tAFR_MALE_AC\tAFR_MALE_AF\tAFR_MALE_N_BI_GENOS\tAFR_MALE_N_HOMREF\tAFR_MALE_N_HET\tAFR_MALE_N_HOMALT\tAFR_MALE_FREQ_HOMREF\tAFR_MALE_FREQ_HET\tAFR_MALE_FREQ_HOMALT\tAFR_MALE_N_HEMIREF\tAFR_MALE_N_HEMIALT\tAFR_MALE_FREQ_HEMIREF\tAFR_MALE_FREQ_HEMIALT\tAFR_FEMALE_AN\tAFR_FEMALE_AC\tAFR_FEMALE_AF\tAFR_FEMALE_N_BI_GENOS\tAFR_FEMALE_N_HOMREF\tAFR_FEMALE_N_HET\tAFR_FEMALE_N_HOMALT\tAFR_FEMALE_FREQ_HOMREF\tAFR_FEMALE_FREQ_HET\tAFR_FEMALE_FREQ_HOMALT\tAMR_AN\tAMR_AC\tAMR_AF\tAMR_N_BI_GENOS\tAMR_N_HOMREF\tAMR_N_HET\tAMR_N_HOMALT\tAMR_FREQ_HOMREF\tAMR_FREQ_HET\tAMR_FREQ_HOMALT\tAMR_MALE_AN\tAMR_MALE_AC\tAMR_MALE_AF\tAMR_MALE_N_BI_GENOS\tAMR_MALE_N_HOMREF\tAMR_MALE_N_HET\tAMR_MALE_N_HOMALT\tAMR_MALE_FREQ_HOMREF\tAMR_MALE_FREQ_HET\tAMR_MALE_FREQ_HOMALT\tAMR_MALE_N_HEMIREF\tAMR_MALE_N_HEMIALT\tAMR_MALE_FREQ_HEMIREF\tAMR_MALE_FREQ_HEMIALT\tAMR_FEMALE_AN\tAMR_FEMALE_AC\tAMR_FEMALE_AF\tAMR_FEMALE_N_BI_GENOS\tAMR_FEMALE_N_HOMREF\tAMR_FEMALE_N_HET\tAMR_FEMALE_N_HOMALT\tAMR_FEMALE_FREQ_HOMREF\tAMR_FEMALE_FREQ_HET\tAMR_FEMALE_FREQ_HOMALT\tEAS_AN\tEAS_AC\tEAS_AF\tEAS_N_BI_GENOS\tEAS_N_HOMREF\tEAS_N_HET\tEAS_N_HOMALT\tEAS_FREQ_HOMREF\tEAS_FREQ_HET\tEAS_FREQ_HOMALT\tEAS_MALE_AN\tEAS_MALE_AC\tEAS_MALE_AF\tEAS_MALE_N_BI_GENOS\tEAS_MALE_N_HOMREF\tEAS_MALE_N_HET\tEAS_MALE_N_HOMALT\tEAS_MALE_FREQ_HOMREF\tEAS_MALE_FREQ_HET\tEAS_MALE_FREQ_HOMALT\tEAS_MALE_N_HEMIREF\tEAS_MALE_N_HEMIALT\tEAS_MALE_FREQ_HEMIREF\tEAS_MALE_FREQ_HEMIALT\tEAS_FEMALE_AN\tEAS_FEMALE_AC\tEAS_FEMALE_AF\tEAS_FEMALE_N_BI_GENOS\tEAS_FEMALE_N_HOMREF\tEAS_FEMALE_N_HET\tEAS_FEMALE_N_HOMALT\tEAS_FEMALE_FREQ_HOMREF\tEAS_FEMALE_FREQ_HET\tEAS_FEMALE_FREQ_HOMALT\tEUR_AN\tEUR_AC\tEUR_AF\tEUR_N_BI_GENOS\tEUR_N_HOMREF\tEUR_N_HET\tEUR_N_HOMALT\tEUR_FREQ_HOMREF\tEUR_FREQ_HET\tEUR_FREQ_HOMALT\tEUR_MALE_AN\tEUR_MALE_AC\tEUR_MALE_AF\tEUR_MALE_N_BI_GENOS\tEUR_MALE_N_HOMREF\tEUR_MALE_N_HET\tEUR_MALE_N_HOMALT\tEUR_MALE_FREQ_HOMREF\tEUR_MALE_FREQ_HET\tEUR_MALE_FREQ_HOMALT\tEUR_MALE_N_HEMIREF\tEUR_MALE_N_HEMIALT\tEUR_MALE_FREQ_HEMIREF\tEUR_MALE_FREQ_HEMIALT\tEUR_FEMALE_AN\tEUR_FEMALE_AC\tEUR_FEMALE_AF\tEUR_FEMALE_N_BI_GENOS\tEUR_FEMALE_N_HOMREF\tEUR_FEMALE_N_HET\tEUR_FEMALE_N_HOMALT\tEUR_FEMALE_FREQ_HOMREF\tEUR_FEMALE_FREQ_HET\tEUR_FEMALE_FREQ_HOMALT\tOTH_AN\tOTH_AC\tOTH_AF\tOTH_N_BI_GENOS\tOTH_N_HOMREF\tOTH_N_HET\tOTH_N_HOMALT\tOTH_FREQ_HOMREF\tOTH_FREQ_HET\tOTH_FREQ_HOMALT\tOTH_MALE_AN\tOTH_MALE_AC\tOTH_MALE_AF\tOTH_MALE_N_BI_GENOS\tOTH_MALE_N_HOMREF\tOTH_MALE_N_HET\tOTH_MALE_N_HOMALT\tOTH_MALE_FREQ_HOMREF\tOTH_MALE_FREQ_HET\tOTH_MALE_FREQ_HOMALT\tOTH_MALE_N_HEMIREF\tOTH_MALE_N_HEMIALT\tOTH_MALE_FREQ_HEMIREF\tOTH_MALE_FREQ_HEMIALT\tOTH_FEMALE_AN\tOTH_FEMALE_AC\tOTH_FEMALE_AF\tOTH_FEMALE_N_BI_GENOS\tOTH_FEMALE_N_HOMREF\tOTH_FEMALE_N_HET\tOTH_FEMALE_N_HOMALT\tOTH_FEMALE_FREQ_HOMREF\tOTH_FEMALE_FREQ_HET\tOTH_FEMALE_FREQ_HOMALT\tFILTER\n" +
            "1\t20999\tInvalid-26000\tgnomAD-SV_v2.1_DEL_1_1\tDEL\tdepth\tFalse\tNA\tNA\tNA\tNA\t26000\tRD\tFalse\tFalse\tFalse\tNA\tNA\tNA\tNA\tTrue\tNA\tNA\tNA\tNA\tOR4F5\tNA\tNA\tNA\tNA\t5000\tDEL\tNA\tFalse\tFalse\t8586\t138\t0.01607299968600273\t4293\t4155\t138\t0\t0.9678549766540527\t0.03214539960026741\t0.0\t4302\t69\t0.01603900082409382\t2151\t2082\t69\t0\t0.9679219722747803\t0.0320780985057354\t0.0\tNA\tNA\tNA\tNA\tFalse\t4272\t68\t0.015917999669909477\t2136\t2068\t68\t0\t0.9681649804115295\t0.031835198402404785\t0.0\t0.07199999690055847\t3718\t27\t0.007261999882757664\t1859\t1832\t27\t0\t0.985476016998291\t0.014523900113999844\t0.0\t2016\t16\t0.007937000133097172\t1008\t992\t16\t0\t0.9841269850730896\t0.015873000025749207\t0.0\tNA\tNA\tNA\tNA\t1702\t11\t0.00646300008520484\t851\t840\t11\t0\t0.9870740175247192\t0.01292600017040968\t0.0\t684\t8\t0.011695999652147293\t342\t334\t8\t0\t0.9766079783439636\t0.02339180000126362\t0.0\t326\t2\t0.006134999915957451\t163\t161\t2\t0\t0.9877300262451172\t0.012269900180399418\t0.0\tNA\tNA\tNA\tNA\t358\t6\t0.016759999096393585\t179\t173\t6\t0\t0.966480016708374\t0.033519599586725235\t0.0\t750\t54\t0.07199999690055847\t375\t321\t54\t0\t0.8560000061988831\t0.14399999380111694\t0.0\t418\t28\t0.06698600202798843\t209\t181\t28\t0\t0.8660290241241455\t0.13397100567817688\t0.0\tNA\tNA\tNA\tNA\t328\t25\t0.07621999830007553\t164\t139\t25\t0\t0.8475610017776489\t0.15243899822235107\t0.0\t3346\t48\t0.014344999566674232\t1673\t1625\t48\t0\t0.9713090062141418\t0.028690999373793602\t0.0\t1498\t22\t0.014685999602079391\t749\t727\t22\t0\t0.9706270098686218\t0.029372500255703926\t0.0\tNA\tNA\tNA\tNA\t1840\t26\t0.01413000002503395\t920\t894\t26\t0\t0.9717389941215515\t0.02826089970767498\t0.0\t88\t1\t0.011363999918103218\t44\t43\t1\t0\t0.9772729873657227\t0.022727299481630325\t0.0\t44\t1\t0.0227269995957613\t22\t21\t1\t0\t0.9545450210571289\t0.04545449838042259\t0.0\tNA\tNA\tNA\tNA\t44\t0\t0.0\t22\t22\t0\t0\t1.0\t0.0\t0.0\tUNSTABLE_AF_PCRMINUS,LOW_CALL_RATE\n";

        using var reader         = new StreamReader(GetStreamData(bedData));
        using var gnomadSvParser = new GnomadSvBedParser(reader, ChromosomeUtilities.RefNameToChromosome);

        Assert.Throws<InvalidDataException>(() => gnomadSvParser.GetItems().ToList());
    }

    [Fact]
    public void TestInvalidSvType()
    {
        const string bedData =
            "#chrom\tstart\tend\tname\tsvtype\tALGORITHMS\tBOTHSIDES_SUPPORT\tCHR2\tCPX_INTERVALS\tCPX_TYPE\tEND2\tEND\tEVIDENCE\tHIGH_SR_BACKGROUND\tPCRPLUS_DEPLETED\tPESR_GT_OVERDISPERSION\tPOS2\tPROTEIN_CODING__COPY_GAIN\tPROTEIN_CODING__DUP_LOF\tPROTEIN_CODING__DUP_PARTIAL\tPROTEIN_CODING__INTERGENIC\tPROTEIN_CODING__INTRONIC\tPROTEIN_CODING__INV_SPAN\tPROTEIN_CODING__LOF\tPROTEIN_CODING__MSV_EXON_OVR\tPROTEIN_CODING__NEAREST_TSS\tPROTEIN_CODING__PROMOTER\tPROTEIN_CODING__UTR\tSOURCE\tSTRANDS\tSVLEN\tSVTYPE\tUNRESOLVED_TYPE\tUNSTABLE_AF_PCRPLUS\tVARIABLE_ACROSS_BATCHES\tAN\tAC\tAF\tN_BI_GENOS\tN_HOMREF\tN_HET\tN_HOMALT\tFREQ_HOMREF\tFREQ_HET\tFREQ_HOMALT\tMALE_AN\tMALE_AC\tMALE_AF\tMALE_N_BI_GENOS\tMALE_N_HOMREF\tMALE_N_HET\tMALE_N_HOMALT\tMALE_FREQ_HOMREF\tMALE_FREQ_HET\tMALE_FREQ_HOMALT\tMALE_N_HEMIREF\tMALE_N_HEMIALT\tMALE_FREQ_HEMIREF\tMALE_FREQ_HEMIALT\tPAR\tFEMALE_AN\tFEMALE_AC\tFEMALE_AF\tFEMALE_N_BI_GENOS\tFEMALE_N_HOMREF\tFEMALE_N_HET\tFEMALE_N_HOMALT\tFEMALE_FREQ_HOMREF\tFEMALE_FREQ_HET\tFEMALE_FREQ_HOMALT\tPOPMAX_AF\tAFR_AN\tAFR_AC\tAFR_AF\tAFR_N_BI_GENOS\tAFR_N_HOMREF\tAFR_N_HET\tAFR_N_HOMALT\tAFR_FREQ_HOMREF\tAFR_FREQ_HET\tAFR_FREQ_HOMALT\tAFR_MALE_AN\tAFR_MALE_AC\tAFR_MALE_AF\tAFR_MALE_N_BI_GENOS\tAFR_MALE_N_HOMREF\tAFR_MALE_N_HET\tAFR_MALE_N_HOMALT\tAFR_MALE_FREQ_HOMREF\tAFR_MALE_FREQ_HET\tAFR_MALE_FREQ_HOMALT\tAFR_MALE_N_HEMIREF\tAFR_MALE_N_HEMIALT\tAFR_MALE_FREQ_HEMIREF\tAFR_MALE_FREQ_HEMIALT\tAFR_FEMALE_AN\tAFR_FEMALE_AC\tAFR_FEMALE_AF\tAFR_FEMALE_N_BI_GENOS\tAFR_FEMALE_N_HOMREF\tAFR_FEMALE_N_HET\tAFR_FEMALE_N_HOMALT\tAFR_FEMALE_FREQ_HOMREF\tAFR_FEMALE_FREQ_HET\tAFR_FEMALE_FREQ_HOMALT\tAMR_AN\tAMR_AC\tAMR_AF\tAMR_N_BI_GENOS\tAMR_N_HOMREF\tAMR_N_HET\tAMR_N_HOMALT\tAMR_FREQ_HOMREF\tAMR_FREQ_HET\tAMR_FREQ_HOMALT\tAMR_MALE_AN\tAMR_MALE_AC\tAMR_MALE_AF\tAMR_MALE_N_BI_GENOS\tAMR_MALE_N_HOMREF\tAMR_MALE_N_HET\tAMR_MALE_N_HOMALT\tAMR_MALE_FREQ_HOMREF\tAMR_MALE_FREQ_HET\tAMR_MALE_FREQ_HOMALT\tAMR_MALE_N_HEMIREF\tAMR_MALE_N_HEMIALT\tAMR_MALE_FREQ_HEMIREF\tAMR_MALE_FREQ_HEMIALT\tAMR_FEMALE_AN\tAMR_FEMALE_AC\tAMR_FEMALE_AF\tAMR_FEMALE_N_BI_GENOS\tAMR_FEMALE_N_HOMREF\tAMR_FEMALE_N_HET\tAMR_FEMALE_N_HOMALT\tAMR_FEMALE_FREQ_HOMREF\tAMR_FEMALE_FREQ_HET\tAMR_FEMALE_FREQ_HOMALT\tEAS_AN\tEAS_AC\tEAS_AF\tEAS_N_BI_GENOS\tEAS_N_HOMREF\tEAS_N_HET\tEAS_N_HOMALT\tEAS_FREQ_HOMREF\tEAS_FREQ_HET\tEAS_FREQ_HOMALT\tEAS_MALE_AN\tEAS_MALE_AC\tEAS_MALE_AF\tEAS_MALE_N_BI_GENOS\tEAS_MALE_N_HOMREF\tEAS_MALE_N_HET\tEAS_MALE_N_HOMALT\tEAS_MALE_FREQ_HOMREF\tEAS_MALE_FREQ_HET\tEAS_MALE_FREQ_HOMALT\tEAS_MALE_N_HEMIREF\tEAS_MALE_N_HEMIALT\tEAS_MALE_FREQ_HEMIREF\tEAS_MALE_FREQ_HEMIALT\tEAS_FEMALE_AN\tEAS_FEMALE_AC\tEAS_FEMALE_AF\tEAS_FEMALE_N_BI_GENOS\tEAS_FEMALE_N_HOMREF\tEAS_FEMALE_N_HET\tEAS_FEMALE_N_HOMALT\tEAS_FEMALE_FREQ_HOMREF\tEAS_FEMALE_FREQ_HET\tEAS_FEMALE_FREQ_HOMALT\tEUR_AN\tEUR_AC\tEUR_AF\tEUR_N_BI_GENOS\tEUR_N_HOMREF\tEUR_N_HET\tEUR_N_HOMALT\tEUR_FREQ_HOMREF\tEUR_FREQ_HET\tEUR_FREQ_HOMALT\tEUR_MALE_AN\tEUR_MALE_AC\tEUR_MALE_AF\tEUR_MALE_N_BI_GENOS\tEUR_MALE_N_HOMREF\tEUR_MALE_N_HET\tEUR_MALE_N_HOMALT\tEUR_MALE_FREQ_HOMREF\tEUR_MALE_FREQ_HET\tEUR_MALE_FREQ_HOMALT\tEUR_MALE_N_HEMIREF\tEUR_MALE_N_HEMIALT\tEUR_MALE_FREQ_HEMIREF\tEUR_MALE_FREQ_HEMIALT\tEUR_FEMALE_AN\tEUR_FEMALE_AC\tEUR_FEMALE_AF\tEUR_FEMALE_N_BI_GENOS\tEUR_FEMALE_N_HOMREF\tEUR_FEMALE_N_HET\tEUR_FEMALE_N_HOMALT\tEUR_FEMALE_FREQ_HOMREF\tEUR_FEMALE_FREQ_HET\tEUR_FEMALE_FREQ_HOMALT\tOTH_AN\tOTH_AC\tOTH_AF\tOTH_N_BI_GENOS\tOTH_N_HOMREF\tOTH_N_HET\tOTH_N_HOMALT\tOTH_FREQ_HOMREF\tOTH_FREQ_HET\tOTH_FREQ_HOMALT\tOTH_MALE_AN\tOTH_MALE_AC\tOTH_MALE_AF\tOTH_MALE_N_BI_GENOS\tOTH_MALE_N_HOMREF\tOTH_MALE_N_HET\tOTH_MALE_N_HOMALT\tOTH_MALE_FREQ_HOMREF\tOTH_MALE_FREQ_HET\tOTH_MALE_FREQ_HOMALT\tOTH_MALE_N_HEMIREF\tOTH_MALE_N_HEMIALT\tOTH_MALE_FREQ_HEMIREF\tOTH_MALE_FREQ_HEMIALT\tOTH_FEMALE_AN\tOTH_FEMALE_AC\tOTH_FEMALE_AF\tOTH_FEMALE_N_BI_GENOS\tOTH_FEMALE_N_HOMREF\tOTH_FEMALE_N_HET\tOTH_FEMALE_N_HOMALT\tOTH_FEMALE_FREQ_HOMREF\tOTH_FEMALE_FREQ_HET\tOTH_FEMALE_FREQ_HOMALT\tFILTER\n" +
            "1\t20999\t26000\tgnomAD-SV_v2.1_DEL_1_1\tINVALID-DEL\tdepth\tFalse\tNA\tNA\tNA\tNA\t26000\tRD\tFalse\tFalse\tFalse\tNA\tNA\tNA\tNA\tTrue\tNA\tNA\tNA\tNA\tOR4F5\tNA\tNA\tNA\tNA\t5000\tDEL\tNA\tFalse\tFalse\t8586\t138\t0.01607299968600273\t4293\t4155\t138\t0\t0.9678549766540527\t0.03214539960026741\t0.0\t4302\t69\t0.01603900082409382\t2151\t2082\t69\t0\t0.9679219722747803\t0.0320780985057354\t0.0\tNA\tNA\tNA\tNA\tFalse\t4272\t68\t0.015917999669909477\t2136\t2068\t68\t0\t0.9681649804115295\t0.031835198402404785\t0.0\t0.07199999690055847\t3718\t27\t0.007261999882757664\t1859\t1832\t27\t0\t0.985476016998291\t0.014523900113999844\t0.0\t2016\t16\t0.007937000133097172\t1008\t992\t16\t0\t0.9841269850730896\t0.015873000025749207\t0.0\tNA\tNA\tNA\tNA\t1702\t11\t0.00646300008520484\t851\t840\t11\t0\t0.9870740175247192\t0.01292600017040968\t0.0\t684\t8\t0.011695999652147293\t342\t334\t8\t0\t0.9766079783439636\t0.02339180000126362\t0.0\t326\t2\t0.006134999915957451\t163\t161\t2\t0\t0.9877300262451172\t0.012269900180399418\t0.0\tNA\tNA\tNA\tNA\t358\t6\t0.016759999096393585\t179\t173\t6\t0\t0.966480016708374\t0.033519599586725235\t0.0\t750\t54\t0.07199999690055847\t375\t321\t54\t0\t0.8560000061988831\t0.14399999380111694\t0.0\t418\t28\t0.06698600202798843\t209\t181\t28\t0\t0.8660290241241455\t0.13397100567817688\t0.0\tNA\tNA\tNA\tNA\t328\t25\t0.07621999830007553\t164\t139\t25\t0\t0.8475610017776489\t0.15243899822235107\t0.0\t3346\t48\t0.014344999566674232\t1673\t1625\t48\t0\t0.9713090062141418\t0.028690999373793602\t0.0\t1498\t22\t0.014685999602079391\t749\t727\t22\t0\t0.9706270098686218\t0.029372500255703926\t0.0\tNA\tNA\tNA\tNA\t1840\t26\t0.01413000002503395\t920\t894\t26\t0\t0.9717389941215515\t0.02826089970767498\t0.0\t88\t1\t0.011363999918103218\t44\t43\t1\t0\t0.9772729873657227\t0.022727299481630325\t0.0\t44\t1\t0.0227269995957613\t22\t21\t1\t0\t0.9545450210571289\t0.04545449838042259\t0.0\tNA\tNA\tNA\tNA\t44\t0\t0.0\t22\t22\t0\t0\t1.0\t0.0\t0.0\tUNSTABLE_AF_PCRMINUS,LOW_CALL_RATE\n";

        using var reader         = new StreamReader(GetStreamData(bedData));
        using var gnomadSvParser = new GnomadSvBedParser(reader, ChromosomeUtilities.RefNameToChromosome);

        Assert.Throws<InvalidDataException>(() => gnomadSvParser.GetItems().ToList());
    }
}