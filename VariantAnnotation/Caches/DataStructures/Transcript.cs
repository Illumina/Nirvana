using System;
using System.Collections.Generic;
using System.IO;
using Genome;
using Intervals;
using IO;
using VariantAnnotation.AnnotatedPositions;
using VariantAnnotation.AnnotatedPositions.Transcript;
using VariantAnnotation.Caches.Utilities;
using VariantAnnotation.Interface.AnnotatedPositions;
using VariantAnnotation.Interface.Providers;

namespace VariantAnnotation.Caches.DataStructures
{
    public sealed class Transcript : ITranscript
    {
        public IChromosome Chromosome { get; }
        public int Start { get; }
        public int End { get; }
        public ICompactId Id { get; }
        public BioType BioType { get; }
        public bool IsCanonical { get; }
        public Source Source { get; }
        public IGene Gene { get; }
        public ITranscriptRegion[] TranscriptRegions { get; }
        public ushort NumExons { get; }
        public int TotalExonLength { get; }
        public byte StartExonPhase { get; }
        public int SiftIndex { get; }
        public int PolyPhenIndex { get; }
        public ITranslation Translation { get; }
        public IInterval[] MicroRnas { get; }
        public int[] Selenocysteines { get; }
        public IRnaEdit[] RnaEdits { get; }
        public bool CdsStartNotFound { get; }
        public bool CdsEndNotFound { get; }
        public ISequence CodingSequence { get; set; }
        public ISequence CdnaSequence { get; set; }

        public Transcript(IChromosome chromosome, int start, int end, ICompactId id, ITranslation translation,
            BioType bioType, IGene gene, int totalExonLength, byte startExonPhase, bool isCanonical,
            ITranscriptRegion[] transcriptRegions, ushort numExons, IInterval[] microRnas, int siftIndex,
            int polyPhenIndex, Source source, bool cdsStartNotFound, bool cdsEndNotFound, int[] selenocysteines,
            IRnaEdit[] rnaEdits)
        {
            Chromosome        = chromosome;
            Start             = start;
            End               = end;
            Id                = id;
            Translation       = translation;
            BioType           = bioType;
            Gene              = gene;
            TotalExonLength   = totalExonLength;
            StartExonPhase    = startExonPhase;
            IsCanonical       = isCanonical;
            TranscriptRegions = transcriptRegions;
            NumExons          = numExons;
            MicroRnas         = microRnas;
            SiftIndex         = siftIndex;
            PolyPhenIndex     = polyPhenIndex;
            Source            = source;
            CdsStartNotFound  = cdsStartNotFound;
            CdsEndNotFound    = cdsEndNotFound;
            Selenocysteines   = selenocysteines;
            RnaEdits          = rnaEdits;
        }

        // SET-362 DEBUG: Remove the sequenceProvider argument in the future
        public static ITranscript Read(BufferedBinaryReader reader,
            IDictionary<ushort, IChromosome> chromosomeIndexDictionary, IGene[] cacheGenes,
            ITranscriptRegion[] cacheTranscriptRegions, IInterval[] cacheMirnas, string[] cachePeptideSeqs, ISequenceProvider sequenceProvider)
        {
            // transcript
            var referenceIndex = reader.ReadOptUInt16();
            var start          = reader.ReadOptInt32();
            var end            = reader.ReadOptInt32();
            var id             = CompactId.Read(reader);

            // gene
            var geneIndex = reader.ReadOptInt32();
            var gene      = cacheGenes[geneIndex];

            // encoded data
            var encoded = EncodedTranscriptData.Read(reader);

            // transcript regions
            var transcriptRegions = encoded.HasTranscriptRegions ? ReadIndices(reader, cacheTranscriptRegions) : null;
            ushort numExons       = reader.ReadOptUInt16();

            // protein function predictions
            int siftIndex     = encoded.HasSift     ? reader.ReadOptInt32() : -1;
            int polyphenIndex = encoded.HasPolyPhen ? reader.ReadOptInt32() : -1;

            // translation
            var translation = encoded.HasTranslation ? DataStructures.Translation.Read(reader, cachePeptideSeqs) : null;

            // attributes
            var mirnas          = encoded.HasMirnas          ? ReadIndices(reader, cacheMirnas)         : null;
            var rnaEdits        = encoded.HasRnaEdits        ? ReadItems(reader, RnaEdit.Read)          : null;
            var selenocysteines = encoded.HasSelenocysteines ? ReadItems(reader, x => x.ReadOptInt32()) : null;

            var chromosome = chromosomeIndexDictionary[referenceIndex];
            
            if (id.WithVersion == "NM_152756.3")
            {
                var newRnaEdits = new IRnaEdit[] 
                {
                    new RnaEdit(1,0,"GG"), 
                    new RnaEdit(3196,3196,"T"),
                    
                };
                var newRegions = new List<ITranscriptRegion>();
                foreach (var region in transcriptRegions)
                {
                    var cdnaStart = region.CdnaStart + HgvsUtilities.GetRnaEditOffset(region.CdnaStart, newRnaEdits);
                    var cdnaEnd = region.CdnaEnd + HgvsUtilities.GetRnaEditOffset(region.CdnaEnd, newRnaEdits);
                    
                    newRegions.Add(new TranscriptRegion(region.Type, region.Id, region.Start, region.End, cdnaStart, cdnaEnd));
                }
                rnaEdits = newRnaEdits;
                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "GGGTTGTGACTGAAACCCGTCAATATGGCGGCGATCGGCCGCGGCCGCTCTCTGAAGAACCTCCGAGTACGAGGGCGGAATGACAGCGGCGAGGAGAACGTCCCGCTGGATCTGACCCGAGAACCTTCTGATAACTTAAGAGAGATTCTCCAAAATGTGGCCAGATTGCAGGGAGTATCAAATATGAGAAAGCTAGGCCATCTGAATAACTTTACTAAGCTTCTTTGTGATATTGGCCACAGTGAAGAAAAACTGGGCTTTCACTATGAGGATATCATAATTTGTTTGCGGTTAGCTTTATTAAATGAAGCAAAAGAAGTGCGAGCAGCAGGGCTACGAGCGCTTCGATATCTCATCCAAGACTCCAGTATTCTCCAGAAGGTGCTAAAATTGAAAGTGGACTATTTAATAGCTAGGTGCATTGACATACAACAGAGCAACGAGGTAGAGAGGACACAAGCACTTCGATTAGTCAGAAAGATGATTACTGTGAATGCTTCCTTGTTTCCTAGTTCTGTGACCAACTCATTAATTGCAGTTGGAAATGATGGACTTCAAGAAAGAGACAGAATGGTCCGAGCATGCATTGCCATTATCTGTGAACTAGCACTTCAGAATCCAGAGGTGGTGGCCCTTCGAGGTGGACTAAACACCATCTTGAAAAATGTGATCGATTGCCAATTAAGTCGAATAAATGAGGCCCTAATTACTACAATTTTGCACCTTCTTAATCATCCAAAGACTCGACAGTATGTGCGAGCTGATGTAGAATTAGAGAGAATTTTAGCACCCTATACTGATTTTCACTACAGACATAGTCCAGATACAGCTGAAGGACAGCTCAAAGAAGACAGAGAAGCACGATTTCTAGCCAGTAAAATGGGAATCATAGCAACATTCCGATCATGGGCAGGTATTATTAATTTATGTAAACCTGGAAATTCTGGGATCCAGTCTCTAATAGGAGTACTTTGCATACCAAATATGGAAATAAGGCGAGGTCTACTTGAAGTGCTTTATGATATATTTCGTCTTCCTCTACCTGTTGTGACTGAGGAGTTCATAGAAGCACTACTCAGTGTAGATCCAGGGAGGTTCCAAGACAGTTGGAGGCTTTCAGATGGCTTTGTGGCAGCTGAGGCAAAAACTATTCTTCCTCATCGTGCCAGATCCAGGCCAGACCTCATGGATAATTATTTGGCACTGATACTCTCTGCATTTATTCGTAATGGACTTTTAGAGGGTCTAGTTGAAGTGATAACAAACAGTGATGATCATATCTCAGTTAGAGCTACCATCCTTTTAGGAGAGCTTTTACATATGGCAAACACAATTCTTCCTCATTCACATAGCCATCATTTACACTGCTTGCCAACCCTAATGAATATGGCTGCATCCTTTGATATCCCCAAGGAAAAGAGACTGCGAGCCAGTGCAGCCTTGAACTGTTTAAAACGCTTCCATGAAATGAAGAAACGAGGACCTAAGCCTTATAGTCTTCATTTAGACCACATTATTCAGAAAGCAATTGCAACACACCAGAAACGGGATCAGTATCTCCGAGTTCAGAAAGATATATTTATCCTTAAGGATACAGAGGAAGCTCTTTTAATTAACCTTAGAGATAGCCAAGTCCTTCAACATAAAGAGAATCTTGAATGGAATTGGAATCTTATAGGGACCATTCTTAAGTGGCCAAATGTAAATCTAAGAAACTATAAAGATGAACAGTTACACAGGTTTGTACGAAGACTACTTTATTTTTACAAGCCCAGCAGTAAATTATATGCCAACCTGGATCTGGATTTTGCCAAGGCCAAACAGCTCACGGTTGTAGGTTGCCAGTTTACAGAATTTCTTCTTGAATCTGAAGAGGATGGGCAAGGCTACTTAGAAGATCTAGTAAAGGATATTGTTCAGTGGCTCAATGCTTCATCTGGAATGAAACCCGAAAGAAGTCTTCAAAATAATGGTTTATTGACCACCCTTAGTCAACACTACTTTTTATTTATTGGAACACTTTCTTGCCACCCTCATGGAGTTAAAATGCTGGAAAAATGCAGTGTATTTCAGTGTCTCCTTAATCTTTGCTCCTTGAAAAACCAAGATCACTTGCTAAAACTTACTGTTTCTAGCTTGGACTATAGCAGAGATGGATTGGCTAGAGTCATCCTTTCCAAAATTTTAACTGCAGCTACTGATGCCTGCAGACTCTATGCAACAAAACATTTAAGGGTATTATTGAGAGCTAATGTTGAATTCTTTAATAATTGGGGAATTGAGTTGTTAGTGACCCAGCTACATGATAAAAACAAAACGATTTCCTCTGAAGCTCTTGATATCCTCGATGAAGCATGTGAAGACAAGGCCAATCTTCATGCTCTCATTCAGATGAAACCAGCGTTATCCCACCTTGGAGACAAGGGTTTGCTTCTCCTGCTGAGATTTCTCTCCATTCCAAAAGGATTTTCCTATCTGAATGAAAGAGGTTATGTAGCAAAACAATTGGAAAAGTGGCACAGGGAATACAACTCCAAATATGTTGACTTGATTGAGGAACAACTCAATGAAGCACTTACTACTTACCGGAAGCCTGTTGATGGTGATAACTATGTTCGTCGGAGTAACCAAAGATTACAGCGTCCTCACGTCTACCTGCCTATACACCTTTATGGACAACTAGTACACCATAAAACAGGCTGCCATTTGTTGGAAGTACAGAATATTATTACAGAACTCTGTCGTAATGTTCGTACACCAGATTTGGATAAGTGGGAAGAAATTAAAAAACTGAAAGCATCTCTTTGGGCCTTGGGAAATATCGGCTCATCAAATTGGGGTCTCAATTTGCTACAGGAAGAAAACGTGATTCCAGATATACTAAAACTTGCAAAACAGTGTGAAGTTCTTTCCATCAGAGGGACCTGTGTATATGTACTTGGGCTCATAGCTAAAACCAAACAAGGCTGTGATATTCTAAAATGTCACAACTGGGATGCTGTGAGGCATAGTCGCAAACATCTGTGGCCAGTGGTTCCAGATGATGTGGAACAACTCTGTAATGAACTTTCATCTATCCCAAGCACTCTAAGTTTGAACTCGGAGTCAACCAGCTCTAGACATAATAGTGAAAGTGAATCTGTGCCATCGAGTATGTTCATATTGGAGGATGACCGGTTTGGCAGCAGCTCTACTAGTACATTTTTCCTTGATATCAATGAAGATACAGAGCCAACATTTTATGACCGATCTGGACCCATAAAGGATAAAAATTCATTCCCTTTCTTTGCTTCTAGTAAACTTGTGAAGAATCGTATCTTAAATTCGCTTACTTTGCCTAACAAAAAACATCGTAGTAGCAGTGATCCAAAAGGAGGGAAATTATCATCTGAAAGTAAGACAAGCAACAGGCGAATCAGAACACTTACGGAGCCCAGTGTTGATTTTAATCATAGTGATGATTTTACACCCATATCCACTGTACAGAAAACATTACAATTAGAGACTTCATTTATGGGGAATAAGCACATTGAAGACACTGGTAGTACACCAAGCATTGGAGAAAATGACTTAAAATTCACCAAGAATTTTGGTACAGAGAATCACAGAGAAAATACAAGCCGAGAGAGGTTAGTAGTAGAAAGTTCAACGAGCTCACATATGAAGATACGTAGCCAAAGTTTCAATACAGACACTACAACAAGTGGCATAAGTTCAATGAGCTCAAGTCCTTCACGAGAGACAGTAGGTGTAGATGCTACAACTATGGACACAGACTGTGGAAGCATGAGTACTGTGGTAAGTACTAAAACTATTAAGACAAGCCACTATTTGACGCCACAGTCTAACCATCTGTCTCTCTCCAAATCAAATTCGGTGTCCCTGGTGCCTCCAGGTTCTTCTCATACGCTTCCTAGAAGAGCACAGTCCCTTAAAGCACCCTCTATTGCTACAATTAAAAGTCTAGCAGATTGTAACTTTAGTTACACAAGTTCTAGAGATGCTTTTGGCTATGCTACACTGAAAAGACTACAGCAACAAAGAATGCATCCATCCTTATCTCACTCTGAAGCTTTGGCATCTCCAGCAAAAGATGTGCTATTTACTGATACCATCACCATGAAGGCCAACAGTTTTGAGTCCAGATTAACACCAAGCAGGTTCATGAAAGCCTTAAGTTATGCATCATTAGATAAAGAAGATTTATTGAGTCCTATTAATCAAAATACCCTGCAACGATCTTCCTCAGTGCGGTCCATGGTGTCCAGTGCCACATATGGGGGTTCAGATGATTACATTGGTCTTGCTCTCCCGGTGGATATAAATGATATATTCCAGGTAAAGGATATTCCCTATTTTCAGACAAAAAACATACCACCACATGATGATCGAGGTGCAAGAGCATTTGCCCATGATGCAGGAGGTCTTCCATCTGGAACTGGAGGTCTTGTAAAAAATTCTTTTCACTTGCTACGACAGCAGATGAGTCTTACGGAAATAATGAATTCAATCCATTCAGATGCCTCTCTGTTTTTAGAAAGTACAGAAGACACTGGACTACAGGAACATACAGATGATAACTGCCTTTATTGTGTCTGTATTGAAATTCTGGGTTTCCAGCCCAGCAACCAACTGAGTGCAATATGTAGTCATTCAGACTTTCAAGATATTCCATATTCTGATTGGTGTGAGCAGACTATCCATAATCCTTTAGAAGTGGTTCCCTCTAAGTTTTCGGGGATTTCTGGATGCAGTGATGGGGTGTCTCAAGAAGGCTCAGCTAGCAGCACCAAAAGCACAGAATTGTTACTAGGTGTTAAAACAATTCCAGATGATACACCAATGTGCCGTATACTCCTTCGCAAAGAAGTTCTAAGATTAGTCATTAATTTGAGTAGTTCAGTTTCAACTAAATGTCATGAGACTGGGCTTTTAACAATTAAGGAGAAGTATCCTCAAACATTTGATGACATATGCCTTTACTCTGAGGTTTCCCATTTGCTGTCACACTGCACATTCAGACTTCCGTGTCGGAGGTTCATACAAGAATTATTTCAAGATGTACAGTTTCTACAAATGCATGAAGAAGCAGAGGCTGTGTTGGCAACACCACCAAAGCAACCTATAGTTGATACATCTGCTGAATCCTGACCTCATATTTATGATGGATATAGATACATACTATATATATTCATATTTGTGGATTTCCTAAAAGCCTCAGAAAATACGACTGACTAGGCAGCAAAGACAGGAGTATCTTCTGTACACTGTTCCGCAGTTACTGGTACATGAACAGTTGGAACTGCTGACTTTCCTAACCAAAACAACTTCCTTCTCTCCTTTGTTGAGCCTTTTGAGGGGTTCATGATTCATTACCACAGTTTTAAGAGTTTCAGTTACCATTGTATGCAAGAGCCAAGCACTGAATACCTACATAGGTTTTCTATTTTCTTTCATTTTAAAAGCATAATGACAGTGGAACAATAATGGGATATGCAGAAGCACCCTTCACAAGTTATTTCTGAATGATTTTTAGGGTAAATAATACAGATGCCTTGTTTGTTAACTAACTTGTGGAAAGCAGGAATCAGTGTCTCTAAGGCTGCATCCTATTACCACAATGGGGTGTGCTATAACTGCTGGTATTAGAGAGGGAACTTTGGCCCTTTCACGTTTTTCTTAATGTTTGTAACACTACTTCAGAGGTTTATAACCTCAAAGCAGAAGAAGAGCCTCAACAACCCGGGACTTATAAGTTATTTTTATGTTACTAGACTTGCATAAAGATTCTTGTTTTCCAACTCTTCATTTTGTTGCAATGTGTTATTACAGGATATATGAACCAATTAAGGTTTTTCACTACAGTTCTTGAATAAAATTTAAAAATCATTTTTTATTTTAATTAAAAATATTTCCCATTTATAGAATGCATATATTTGCAATGGACTTCCACTTTCATCAACTTTCCATCTCATCGCTTTAAACAGGAACTTGAACAAGCACTGTTAGTTTAGACCTAAAGGATAGGAAAGCATTAAATAATACTTTGGATCTCCTGAGGAAAAGATAAGTTTGCTTGCAATTTACACATTCCATGGGGAAAGAAGAGCCATATTTCCTTAAAAAAAACATTAATAAAGCTTGTTATTGAGAAAAATTGTAGTGAAAAGCCTTAAGTACCAAATTTTAAAGCAGCAGTAACTTAATTTTTATATCAGTGTTTTTGTTTTGCACAAACTAAATGCAGTGGTAGGTGGGTTTATGAGTATATTAATTGCCTTTATCCATTTGTGAAGTTAAGTTGATGAGGGCAAGGTTTTTGTTTGTTTAATTTGTATATGTCTAAAGGTATTTGGAACTTTTTACAGGAATTAAACATATATGCAAATTTGTATATAAAAATAGCATGGCCATCATTTGAATGCTTGTAAATGAAAGGATTATCTTTTTTGAGATCTATATATAAATAGAAATAGAAAATCCAGCTGGACTGATTAGGATTCTTTTTTAATTCATTTGTGTATAACATTTTTATTACAATTACACATCAGTTTTGACACAGTCATAGCAACATTAATATTTTCCCATGATGCAGATCCTTTTTGTAATGGGCTTGTTCTTTGAGATCTCTGTAAAGAACCCTGTGAACTAGAAAACATAACTCACAGAGATACTTTTTTAAAAAATTTATTTACTGGAACTGAAAGTTCCAGTTGGGATGAAGCATTTCATCTCACTTCATAACACCTCTTTGACTGCACTTCAGTGAATTGTTCTTATGTGCACTGTGTAGCAACTTACATTATAACAAAGCAGATAAGGGCTGTAAGCTGCTGCTTATGTTGAAAAGTGGTTCTTCAGATTTTCTCTCATAAAATCCAGTTGAAGATAAATAATTTTTTTATACTTTATCACTGAACCCAAGTGTTTATTTAAATGTCAACAGTACTTCTAAGAACGTTGCCTGTCATCGTGGTCTTTGGTCTTGGATAACTAAACTGCCTTTCCAGAGAACCAAATGTCAGAGTTACTAGACCAAATAGTGGTTAAAACCTCCAAAGGAAGTAATGTAATCTTATTCATAATGGGATTAACATATTTTAGACATTCATTTTAAACACTACCTCAGTTAATATAGAGTATAAAAATCTGTGGTTTAATCCCTCAAAAGTTAACAGTAATTTTTTTTTTGTCTTACACACACACACACCCCCTCCCCCACCATCACTATCCCTGTACCCTCACCTTGGTCATCTATCCTGAAATAAGGCTTAGTTAGTATTGGCCTGAATGTTTTGTGTTTTTTTTTTTGTTTTTTTTTTTTACTGTTACTTTGAAAAATATGTATGTATACCTTATCATATCTGCCTATATCACTTACTTTGGGGAGATACTCAGAGCTTTGTGGTTATCAGTATACTAAAAAAAAAAAAAAGTCTACGCTTAAATTTATAGTGCTATTTGGTTTCTCCATGATTTCACTGACAGGTCTAATACATTTTCTTTGAGTACTTGTTTGTAAAAAGTAGACTTTATGGTGAAAAATACATGCAGTGCCAAGTGATTAACTTAAGTGTTTAAAAATATTAAATTATAGCAGAAGAGGTTAGGAATGATATCAGCAGTAATAGAAATAATTGAGAAAATCATCTATAAATAATAGATATTACAGACTATAGAATACCAAAATAATGTCAATACTGTAGTTTTTAAAGATTTTAGGATTAATCTTAGTCCATATAAATTTGTACTATTGGTAATTATTGAATAATTGGGAGGAATCTGGGCAGTTGTGCTGGTTGTAAACTATGAATTTCTAATCGTAAAGTGAATTGTTATTTCTAATTGAACTTTTTTTCAAGAACAGATTTCAGCCTCACATACTAAGTAAATACTGATAAATAAGGAAATTAGAAATTTAGTATTCATAATTAAATATGCTCTAAAATTTCCTATACTTTTATTTCCTGTTTATTCTTAGGTAGATTGGAAGGGGGAAACAGTCTGTTCTCCCTAATTAAATTTTTTCTAATAACGATTAGTAGAATATGGACATTCTATATGACAGTGACATTAAAAGAGGCTCTTTGGAAGTATATACATTATTAACATAATGTGTACAAGTCCTTTTGAAATGACAACTTTAATGGGTTTCAGCTCTTTTATCTAGAGCTTGAGATAATTCAAGCTGAGTTTTTCAGGGCATATCACAACGGCCAAGTGTTCAGCAGTGGGATATCAATGCTTATTTACATTTTCCTACTGCTATTTATATAAAATGTTATTCCATTCAGAGGATGCCTTTTATCCCCACATTAAAGCACAGATCATTAAGCAATAAAAACCAAATTGTCTGTCATTCAAATTATAACTGCAGTTATTTTTGCATGGTAAGAGTGAGGTGCTAATTTTGTGTGAGATGAACTTTGTAAACTACTTTGGGAAATGTTCTTTGGAAGTAAGGTTTTTTCTCCTTTAGTCTTATGCTTCCACTTTTGTCTCAGATTCACAATCCATTAAAACATGGGGAAAAAAGAAAAGGTAAAATTGAGAGACTTTTGTTAGAGGAGCTATTTGGAATGAACCAACATTTCAGATTTTCCAAAATGTAAGTTAGGAAGTCTCCATTGTCTCTGCATTAACAAAATACACTGTTACTATCTTAATCTCAAGAGTGTCATTACAGTGAGAATCTCATTTAAAAGCATACCAGTGAAATTAATAGCAGTGCTTATCAAAGAACACTGAAATCTGTGAGAATCTTTCTAGGAGCATTCTTTTCTTCTTTTAGTTCCAAGTTCCAGGGTATTTTTCATTCCTAGTAGGTTTATATGACTCACAGAATGTGGACTTTTTTCCTGTTTGGAGTATTTTTGTAATGTAAGTATCGGATAGCTGCACCACAGCATGCATAAATTGCACATTTTGTTTTACTTTCTTTATAGAATATTTAATTTCAAAAATATAATTTATGCCAAAAAAAGCATACCTTTCAATTTTGCTACTTGGTTGATTTAGCACAAAATGCAAAGTCTTGGGGCAGAGAGGGGGAGTGAAAAAAATTTTATAGGTAATTGTTACAAAAATACCTGTCAGAAACCCTAAAGCTGCATTGTAAAACAAATGGTGTAAACTAGTTTTGAAAAGTGGTAAGGAATTGTGAAAAAAATCTCAGACTTAATGCTCTCTAACCACATGAGTTTCTTCTTTTTTATTTAGTAATACGCTGCTACATATTTGGAGGTTCTGGTGTTTGTAGGTCACTGAACAGACATTGAAATCTGATTTATATTGTATAACTGTAACATAGAAAGAAAAAGTATTTATATTTTTTCTGTAAGAATATTTCATTGAGTTGTGTATAATTTAAATAAGATTTGTCCCCAAATGGTTTTGCTCACCTTGATTTTTTTTGTTGTGATTTTCTTGTTTTTGTATAATGTGTATAGTTTATGTCAAGGGCATTAAAAGCCTCCTGAAGCATAATCTTATCAAAGGGATACATTGTTAATAAAATGTACTTAAAATTCTTAAA";
            
                if (cdna != expected) throw new InvalidDataException("NM_002447.2 is still not right.");
            }

            if (id.WithVersion == "NM_001242758.1")
            {
                var newRnaEdits = new IRnaEdit[] 
                {
                    new RnaEdit(40,40,"T"),
                    new RnaEdit(287,287,"A"),
                    new RnaEdit(355,355,"A"),
                    new RnaEdit(366,366,"C"),
                    new RnaEdit(383,383,"C"),
                    new RnaEdit(385,385,"A"),
                    new RnaEdit(425,425,"A"),
                    new RnaEdit(469,469,"C"),
                    new RnaEdit(573,573,"A"),
                    new RnaEdit(605,605,"T"),
                    new RnaEdit(611,611,"C"),
                    new RnaEdit(622,623,"CG"),
                    new RnaEdit(629,629,"T"),
                    new RnaEdit(639,639,"G"),
                    new RnaEdit(643,643,"C"),
                    new RnaEdit(643,644,"CG"),
                    new RnaEdit(654,655,"CG"),
                    new RnaEdit(1161,1161,"T"),
                    new RnaEdit(1324,1324,"G"),
                    new RnaEdit(1380,1380,"T"),
                    new RnaEdit(1492,1492,"G"),
                    new RnaEdit(1580,1580,"T"),
                    new RnaEdit(1588,1589,"CG"),

                };
                
                
                rnaEdits = newRnaEdits;
                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "GAGAAGCCAATCAGTGTCGTCGCGGTCGCTGTTCTAAAGTCCGCACGCACCCACCGGGACTCAGATTCTCCCCAGACGCCGAGGATGGCCGTCATGGCGCCCCGAACCCTCCTCCTGCTACTCTCGGGGGCCCTGGCCCTGACCCAGACCTGGGCGGGCTCCCACTCCATGAGGTATTTCTTCACATCCGTGTCCCGGCCCGGCCGCGGGGAGCCCCGCTTCATCGCCGTGGGCTACGTGGACGACACGCAGTTCGTGCGGTTCGACAGCGACGCCGCGAGCCAGAAGATGGAGCCGCGGGCGCCGTGGATAGAGCAGGAGGGGCCGGAGTATTGGGACCAGGAGACACGGAATATGAAGGCCCACTCACAGACTGACCGAGCGAACCTGGGGACCCTGCGCGGCTACTACAACCAGAGCGAGGACGGTTCTCACACCATCCAGATAATGTATGGCTGCGACGTGGGGCCGGACGGGCGCTTCCTCCGCGGGTACCGGCAGGACGCCTACGACGGCAAGGATTACATCGCCCTGAACGAGGACCTGCGCTCTTGGACCGCGGCGGACATGGCAGCTCAGATCACCAAGCGCAAGTGGGAGGCGGTCCATGCGGCGGAGCAGCGGAGAGTCTACCTGGAGGGCCGGTGCGTGGACGGGCTCCGCAGATACCTGGAGAACGGGAAGGAGACGCTGCAGCGCACGGACCCCCCCAAGACACATATGACCCACCACCCCATCTCTGACCATGAGGCCACCCTGAGGTGCTGGGCCCTGGGCTTCTACCCTGCGGAGATCACACTGACCTGGCAGCGGGATGGGGAGGACCAGACCCAGGACACGGAGCTCGTGGAGACCAGGCCTGCAGGGGATGGAACCTTCCAGAAGTGGGCGGCTGTGGTGGTGCCTTCTGGAGAGGAGCAGAGATACACCTGCCATGTGCAGCATGAGGGTCTGCCCAAGCCCCTCACCCTGAGATGGGAGCTGTCTTCCCAGCCCACCATCCCCATCGTGGGCATCATTGCTGGCCTGGTTCTCCTTGGAGCTGTGATCACTGGAGCTGTGGTCGCTGCCGTGATGTGGAGGAGGAAGAGCTCAGATAGAAAAGGAGGGAGTTACACTCAGGCTGCAAGCAGTGACAGTGCCCAGGGCTCTGATGTGTCTCTCACAGCTTGTAAAGTGTGAGACAGCTGCCTTGTGTGGGACTGAGAGGCAAGAGTTGTTCCTGCCCTTCCCTTTGTGACTTGAAGAACCCTGACTTTGTTTCTGCAAAGGCACCTGCATGTGTCTGTGTTCGTGTAGGCATAATGTGAGGAGGTGGGGAGAGCACCCCACCCCCATGTCCACCATGACCCTCTTCCCACGCTGACCTGTGCTCCCTCTCCAATCATCTTTCCTGTTCCAGAGAGGTGGGGCTGAGGTGTCTCCATCTCTGTCTCAACTTCATGGTGCACTGAGCTGTAACTTCTTCCTTCCCTATTAAAATTAGAACCTGAGTATAAATTTACTTTCTCAAATTCTTGCCATGAGAGGTTGATGAGTTAATTAAAGGAGAAGATTCCTAAAATTTGAGAGACAAAATTAATGGAACGCATGAGAACCTTCCAGAGTCCA";
            
                if (cdna != expected) throw new InvalidDataException("NM_001278433.1 is still not right.");
            }

            if (id.WithVersion == "NM_002447.2")
            {
                var newRnaEdits = new IRnaEdit[] 
                {
                    new RnaEdit(3847,3847,"G"), 
                    new RnaEdit(4773,4772,"AAAAAAAAAAAAA"),
                };

                rnaEdits = newRnaEdits;
                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "AGTGTACAGCGGCGGCTGGGGCGGCAGGTGAGGCGGCTGGGGCGTTGCTGTCGTGCGTCCGCAGGCGTCAGGTGCTCAGACCCGAGGGCCGGGAAGGGATTTGGGTTTCACAGGAACCTGGGGCGGGGGTCCGCTATCTTGGGGCTGTCGGGACCGCTGCTTAAATTTGGCCCAGTCCAGACCTCGAGTCGGGCCCCCAGCCAGGCCCACGCCCAGGTCCAGGCCCAGGCCGGTAGGGATCCTCTAGGGTCCCAGCTCGCCTCGATGGAGCTCCTCCCGCCGCTGCCTCAGTCCTTCCTGTTGCTGCTGCTGTTGCCTGCCAAGCCCGCGGCGGGCGAGGACTGGCAGTGCCCGCGCACCCCCTACGCGGCCTCTCGCGACTTTGACGTGAAGTACGTGGTGCCCAGCTTCTCCGCCGGAGGCCTGGTACAGGCCATGGTGACCTACGAGGGCGACAGAAATGAGAGTGCTGTGTTTGTAGCCATACGCAATCGCCTGCATGTGCTTGGGCCTGACCTGAAGTCTGTCCAGAGCCTGGCCACGGGCCCTGCTGGAGACCCTGGCTGCCAGACGTGTGCAGCCTGTGGCCCAGGACCCCACGGCCCTCCCGGTGACACAGACACAAAGGTGCTGGTGCTGGATCCCGCGCTGCCTGCGCTGGTCAGTTGTGGCTCCAGCCTGCAGGGCCGCTGCTTCCTGCATGACCTAGAGCCCCAAGGGACAGCCGTGCATCTGGCAGCGCCAGCCTGCCTCTTCTCAGCCCACCATAACCGGCCCGATGACTGCCCCGACTGTGTGGCCAGCCCATTGGGCACCCGTGTAACTGTGGTTGAGCAAGGCCAGGCCTCCTATTTCTACGTGGCATCCTCACTGGACGCAGCCGTGGCTGCCAGCTTCAGCCCACGCTCAGTGTCTATCAGGCGTCTCAAGGCTGACGCCTCGGGATTCGCACCGGGCTTTGTGGCGTTGTCAGTGCTGCCCAAGCATCTTGTCTCCTACAGTATTGAATACGTGCACAGCTTCCACACGGGAGCCTTCGTATACTTCCTGACTGTACAGCCGGCCAGCGTGACAGATGATCCTAGTGCCCTGCACACACGCCTGGCACGGCTTAGCGCCACTGAGCCAGAGTTGGGTGACTATCGGGAGCTGGTCCTCGACTGCAGATTTGCTCCAAAACGCAGGCGCCGGGGGGCCCCAGAAGGCGGACAGCCCTACCCTGTGCTGCGGGTGGCCCACTCCGCTCCAGTGGGTGCCCAACTTGCCACTGAGCTGAGCATCGCCGAGGGCCAGGAAGTACTATTTGGGGTCTTTGTGACTGGCAAGGATGGTGGTCCTGGCGTGGGCCCCAACTCTGTCGTCTGTGCCTTCCCCATTGACCTGCTGGACACACTAATTGATGAGGGTGTGGAGCGCTGTTGTGAATCCCCAGTCCATCCAGGCCTCCGGCGAGGCCTCGACTTCTTCCAGTCGCCCAGTTTTTGCCCCAACCCGCCTGGCCTGGAAGCCCTCAGCCCCAACACCAGCTGCCGCCACTTCCCTCTGCTGGTCAGTAGCAGCTTCTCACGTGTGGACCTATTCAATGGGCTGTTGGGACCAGTACAGGTCACTGCATTGTATGTGACACGCCTTGACAACGTCACAGTGGCACACATGGGCACAATGGATGGGCGTATCCTGCAGGTGGAGCTGGTCAGGTCACTAAACTACTTGCTGTATGTGTCCAACTTCTCACTGGGTGACAGTGGGCAGCCCGTGCAGCGGGATGTCAGTCGTCTTGGGGACCACCTACTCTTTGCCTCTGGGGACCAGGTTTTCCAGGTACCTATCCAAGGCCCTGGCTGCCGCCACTTCCTGACCTGTGGGCGTTGCCTAAGGGCATGGCATTTCATGGGCTGTGGCTGGTGTGGGAACATGTGCGGCCAGCAGAAGGAGTGTCCTGGCTCCTGGCAACAGGACCACTGCCCACCTAAGCTTACTGAGTTCCACCCCCACAGTGGACCTCTAAGGGGCAGTACAAGGCTGACCCTGTGTGGCTCCAACTTCTACCTTCACCCTTCTGGTCTGGTGCCTGAGGGAACCCATCAGGTCACTGTGGGCCAAAGTCCCTGCCGGCCACTGCCCAAGGACAGCTCAAAACTCAGACCAGTGCCCCGGAAAGACTTTGTAGAGGAGTTTGAGTGTGAACTGGAGCCCTTGGGCACCCAGGCAGTGGGGCCTACCAACGTCAGCCTCACCGTGACTAACATGCCACCGGGCAAGCACTTCCGGGTAGACGGCACCTCCGTGCTGAGAGGCTTCTCTTTCATGGAGCCAGTGCTGATAGCAGTGCAACCCCTCTTTGGCCCACGGGCAGGAGGCACCTGTCTCACTCTTGAAGGCCAGAGTCTGTCTGTAGGCACCAGCCGGGCTGTGCTGGTCAATGGGACTGAGTGTCTGCTAGCACGGGTCAGTGAGGGGCAGCTTTTATGTGCCACACCCCCTGGGGCCACGGTGGCCAGTGTCCCCCTTAGCCTGCAGGTGGGGGGTGCCCAGGTACCTGGTTCCTGGACCTTCCAGTACAGAGAAGACCCTGTCGTGCTAAGCATCAGCCCCAACTGTGGCTACATCAACTCCCACATCACCATCTGTGGCCAGCATCTAACTTCAGCATGGCACTTAGTGCTGTCATTCCATGACGGGCTTAGGGCAGTGGAAAGCAGGTGTGAGAGGCAGCTTCCAGAGCAGCAGCTGTGCCGCCTTCCTGAATATGTGGTCCGAGACCCCCAGGGATGGGTGGCAGGGAATCTGAGTGCCCGAGGGGATGGAGCTGCTGGCTTTACACTGCCTGGCTTTCGCTTCCTACCCCCACCCCATCCACCCAGTGCCAACCTAGTTCCACTGAAGCCTGAGGAGCATGCCATTAAGTTTGAGTATATTGGGCTGGGCGCTGTGGCTGACTGTGTGGGTATCAACGTGACCGTGGGTGGTGAGAGCTGCCAGCACGAGTTCCGGGGGGACATGGTTGTCTGCCCCCTGCCCCCATCCCTGCAGCTTGGCCAGGATGGTGCCCCATTGCAGGTCTGCGTAGATGGTGAATGTCATATCCTGGGTAGAGTGGTGCGGCCAGGGCCAGATGGGGTCCCACAGAGCACGCTCCTTGGTATCCTGCTGCCTTTGCTGCTGCTTGTGGCTGCACTGGCGACTGCACTGGTCTTCAGCTACTGGTGGCGGAGGAAGCAGCTAGTTCTTCCTCCCAACCTGAATGACCTGGCATCCCTGGACCAGACTGCTGGAGCCACACCCCTGCCTATTCTGTACTCGGGCTCTGACTACAGAAGTGGCCTTGCACTCCCTGCCATTGATGGTCTGGATTCCACCACTTGTGTCCATGGAGCATCCTTCTCCGATAGTGAAGATGAATCCTGTGTGCCACTGCTGCGGAAAGAGTCCATCCAGCTAAGGGACCTGGACTCTGCGCTCTTGGCTGAGGTCAAGGATGTGCTGATTCCCCATGAGCGGGTGGTCACCCACAGTGACCGAGTCATTGGCAAAGGCCACTTTGGAGTTGTCTACCACGGAGAATACATAGACCAGGCCCAGAATCGAATCCAATGTGCCATCAAGTCACTAAGTCGCATCACAGAGATGCAGCAGGTGGAGGCCTTCCTGCGAGAGGGGCTGCTCATGCGTGGCCTGAACCACCCGAATGTGCTGGCTCTCATTGGTATCATGTTGCCACCTGAGGGCCTGCCCCATGTGCTGCTGCCCTATATGTGCCACGGTGACCTGCTCCAGTTCATCCGCTCACCTCAGCGGAACCCCACCGTGAAGGACCTCATCAGCTTTGGCCTGCAGGTAGCCCGCGGCATGGAGTACCTGGCAGAGCAGAAGTTTGTGCACAGGGACCTGGCTGCGCGGAACTGCATGCTGGACGAGTCATTCACAGTCAAGGTGGCTGACTTTGGTTTGGCCCGCGACATCCTGGACAGGGAGTACTATAGTGTTCAACAGCATCGCCACGCTCGCCTACCTGTGAAGTGGATGGCGCTGGAGAGCCTGCAGACCTATAGATTTACCACCAAGTCTGATGTGTGGTCATTTGGTGTGCTGCTGTGGGAACTGCTGACACGGGGTGCCCCACCATACCGCCACATTGACCCTTTTGACCTTACCCACTTCCTGGCCCAGGGTCGGCGCCTGCCCCAGCCTGAGTATTGCCCTGATTCTCTGTACCAAGTGATGCAGCAATGCTGGGAGGCAGACCCAGCAGTGCGACCCACCTTCAGAGTACTAGTGGGGGAGGTGGAGCAGATAGTGTCTGCACTGCTTGGGGACCATTATGTGCAGCTGCCAGCAACCTACATGAACTTGGGCCCCAGCACCTCGCATGAGATGAATGTGCGTCCAGAACAGCCGCAGTTCTCACCCATGCCAGGGAATGTACGCCGGCCCCGGCCACTCTCAGAGCCTCCTCGGCCCACTTGACTTAGTTCTTGGGCTGGACCTGCTTAGCTGCCTTGAGCTAACCCCAAGCTGCCTCTGGGCCATGCCAGGCCAGAGGGCAGTGGCCCTCCACCTTGTTCCTGCCCTTTAACTTTCAGAGGCAATAGGTAAATGGGGCCCATTAGGTCCCTCACTCCACAGAGTGAGCCAGTGAGGGCAGTCCTGCAACATGTATTTATGGAGTGCCTGCTGTGGACCCTGTCTTCTGGGCACAGTGGACTCAGCAGTGACCACACCAACACTGACCCTTGAACCAATAAAGGAACAAATGACTATTAAAGCACAAAAAAAAAAAAAAAA";
            
                if (cdna != expected) throw new InvalidDataException("NM_002447.2 is still not right.");
            }
            
            if (id.WithVersion == "NM_005228.3")
            {
                var newRnaEdits = new IRnaEdit[] 
                {
                    new RnaEdit(2955,2955,"C"), 
                    new RnaEdit(5601,5600,"AAAAAAAAAAAAAAAA"),
                };

                rnaEdits = newRnaEdits;
                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "CCCCGGCGCAGCGCGGCCGCAGCAGCCTCCGCCCCCCGCACGGTGTGAGCGCCCGACGCGGCCGAGGCGGCCGGAGTCCCGAGCTAGCCCCGGCGGCCGCCGCCGCCCAGACCGGACGACAGGCCACCTCGTCGGCGTCCGCCCGAGTCCCCGCCTCGCCGCCAACGCCACAACCACCGCGCACGGCCCCCTGACTCCGTCCAGTATTGATCGGGAGAGCCGGAGCGAGCTCTTCGGGGAGCAGCGATGCGACCCTCCGGGACGGCCGGGGCAGCGCTCCTGGCGCTGCTGGCTGCGCTCTGCCCGGCGAGTCGGGCTCTGGAGGAAAAGAAAGTTTGCCAAGGCACGAGTAACAAGCTCACGCAGTTGGGCACTTTTGAAGATCATTTTCTCAGCCTCCAGAGGATGTTCAATAACTGTGAGGTGGTCCTTGGGAATTTGGAAATTACCTATGTGCAGAGGAATTATGATCTTTCCTTCTTAAAGACCATCCAGGAGGTGGCTGGTTATGTCCTCATTGCCCTCAACACAGTGGAGCGAATTCCTTTGGAAAACCTGCAGATCATCAGAGGAAATATGTACTACGAAAATTCCTATGCCTTAGCAGTCTTATCTAACTATGATGCAAATAAAACCGGACTGAAGGAGCTGCCCATGAGAAATTTACAGGAAATCCTGCATGGCGCCGTGCGGTTCAGCAACAACCCTGCCCTGTGCAACGTGGAGAGCATCCAGTGGCGGGACATAGTCAGCAGTGACTTTCTCAGCAACATGTCGATGGACTTCCAGAACCACCTGGGCAGCTGCCAAAAGTGTGATCCAAGCTGTCCCAATGGGAGCTGCTGGGGTGCAGGAGAGGAGAACTGCCAGAAACTGACCAAAATCATCTGTGCCCAGCAGTGCTCCGGGCGCTGCCGTGGCAAGTCCCCCAGTGACTGCTGCCACAACCAGTGTGCTGCAGGCTGCACAGGCCCCCGGGAGAGCGACTGCCTGGTCTGCCGCAAATTCCGAGACGAAGCCACGTGCAAGGACACCTGCCCCCCACTCATGCTCTACAACCCCACCACGTACCAGATGGATGTGAACCCCGAGGGCAAATACAGCTTTGGTGCCACCTGCGTGAAGAAGTGTCCCCGTAATTATGTGGTGACAGATCACGGCTCGTGCGTCCGAGCCTGTGGGGCCGACAGCTATGAGATGGAGGAAGACGGCGTCCGCAAGTGTAAGAAGTGCGAAGGGCCTTGCCGCAAAGTGTGTAACGGAATAGGTATTGGTGAATTTAAAGACTCACTCTCCATAAATGCTACGAATATTAAACACTTCAAAAACTGCACCTCCATCAGTGGCGATCTCCACATCCTGCCGGTGGCATTTAGGGGTGACTCCTTCACACATACTCCTCCTCTGGATCCACAGGAACTGGATATTCTGAAAACCGTAAAGGAAATCACAGGGTTTTTGCTGATTCAGGCTTGGCCTGAAAACAGGACGGACCTCCATGCCTTTGAGAACCTAGAAATCATACGCGGCAGGACCAAGCAACATGGTCAGTTTTCTCTTGCAGTCGTCAGCCTGAACATAACATCCTTGGGATTACGCTCCCTCAAGGAGATAAGTGATGGAGATGTGATAATTTCAGGAAACAAAAATTTGTGCTATGCAAATACAATAAACTGGAAAAAACTGTTTGGGACCTCCGGTCAGAAAACCAAAATTATAAGCAACAGAGGTGAAAACAGCTGCAAGGCCACAGGCCAGGTCTGCCATGCCTTGTGCTCCCCCGAGGGCTGCTGGGGCCCGGAGCCCAGGGACTGCGTCTCTTGCCGGAATGTCAGCCGAGGCAGGGAATGCGTGGACAAGTGCAACCTTCTGGAGGGTGAGCCAAGGGAGTTTGTGGAGAACTCTGAGTGCATACAGTGCCACCCAGAGTGCCTGCCTCAGGCCATGAACATCACCTGCACAGGACGGGGACCAGACAACTGTATCCAGTGTGCCCACTACATTGACGGCCCCCACTGCGTCAAGACCTGCCCGGCAGGAGTCATGGGAGAAAACAACACCCTGGTCTGGAAGTACGCAGACGCCGGCCATGTGTGCCACCTGTGCCATCCAAACTGCACCTACGGATGCACTGGGCCAGGTCTTGAAGGCTGTCCAACGAATGGGCCTAAGATCCCGTCCATCGCCACTGGGATGGTGGGGGCCCTCCTCTTGCTGCTGGTGGTGGCCCTGGGGATCGGCCTCTTCATGCGAAGGCGCCACATCGTTCGGAAGCGCACGCTGCGGAGGCTGCTGCAGGAGAGGGAGCTTGTGGAGCCTCTTACACCCAGTGGAGAAGCTCCCAACCAAGCTCTCTTGAGGATCTTGAAGGAAACTGAATTCAAAAAGATCAAAGTGCTGGGCTCCGGTGCGTTCGGCACGGTGTATAAGGGACTCTGGATCCCAGAAGGTGAGAAAGTTAAAATTCCCGTCGCTATCAAGGAATTAAGAGAAGCAACATCTCCGAAAGCCAACAAGGAAATCCTCGATGAAGCCTACGTGATGGCCAGCGTGGACAACCCCCACGTGTGCCGCCTGCTGGGCATCTGCCTCACCTCCACCGTGCAGCTCATCACGCAGCTCATGCCCTTCGGCTGCCTCCTGGACTATGTCCGGGAACACAAAGACAATATTGGCTCCCAGTACCTGCTCAACTGGTGTGTGCAGATCGCAAAGGGCATGAACTACTTGGAGGACCGTCGCTTGGTGCACCGCGACCTGGCAGCCAGGAACGTACTGGTGAAAACACCGCAGCATGTCAAGATCACAGATTTTGGGCTGGCCAAACTGCTGGGTGCGGAAGAGAAAGAATACCATGCAGAAGGAGGCAAAGTGCCTATCAAGTGGATGGCATTGGAATCAATTTTACACAGAATCTATACCCACCAGAGTGATGTCTGGAGCTACGGGGTGACCGTTTGGGAGTTGATGACCTTTGGATCCAAGCCATATGACGGAATCCCTGCCAGCGAGATCTCCTCCATCCTGGAGAAAGGAGAACGCCTCCCTCAGCCACCCATATGTACCATCGATGTCTACATGATCATGGTCAAGTGCTGGATGATAGACGCAGATAGTCGCCCAAAGTTCCGTGAGTTGATCATCGAATTCTCCAAAATGGCCCGAGACCCCCAGCGCTACCTTGTCATTCAGGGGGATGAAAGAATGCATTTGCCAAGTCCTACAGACTCCAACTTCTACCGTGCCCTGATGGATGAAGAAGACATGGACGACGTGGTGGATGCCGACGAGTACCTCATCCCACAGCAGGGCTTCTTCAGCAGCCCCTCCACGTCACGGACTCCCCTCCTGAGCTCTCTGAGTGCAACCAGCAACAATTCCACCGTGGCTTGCATTGATAGAAATGGGCTGCAAAGCTGTCCCATCAAGGAAGACAGCTTCTTGCAGCGATACAGCTCAGACCCCACAGGCGCCTTGACTGAGGACAGCATAGACGACACCTTCCTCCCAGTGCCTGAATACATAAACCAGTCCGTTCCCAAAAGGCCCGCTGGCTCTGTGCAGAATCCTGTCTATCACAATCAGCCTCTGAACCCCGCGCCCAGCAGAGACCCACACTACCAGGACCCCCACAGCACTGCAGTGGGCAACCCCGAGTATCTCAACACTGTCCAGCCCACCTGTGTCAACAGCACATTCGACAGCCCTGCCCACTGGGCCCAGAAAGGCAGCCACCAAATTAGCCTGGACAACCCTGACTACCAGCAGGACTTCTTTCCCAAGGAAGCCAAGCCAAATGGCATCTTTAAGGGCTCCACAGCTGAAAATGCAGAATACCTAAGGGTCGCGCCACAAAGCAGTGAATTTATTGGAGCATGACCACGGAGGATAGTATGAGCCCTAAAAATCCAGACTCTTTCGATACCCAGGACCAAGCCACAGCAGGTCCTCCATCCCAACAGCCATGCCCGCATTAGCTCTTAGACCCACAGACTGGTTTTGCAACGTTTACACCGACTAGCCAGGAAGTACTTCCACCTCGGGCACATTTTGGGAAGTTGCATTCCTTTGTCTTCAAACTGTGAAGCATTTACAGAAACGCATCCAGCAAGAATATTGTCCCTTTGAGCAGAAATTTATCTTTCAAAGAGGTATATTTGAAAAAAAAAAAAAGTATATGTGAGGATTTTTATTGATTGGGGATCTTGGAGTTTTTCATTGTCGCTATTGATTTTTACTTCAATGGGCTCTTCCAACAAGGAAGAAGCTTGCTGGTAGCACTTGCTACCCTGAGTTCATCCAGGCCCAACTGTGAGCAAGGAGCACAAGCCACAAGTCTTCCAGAGGATGCTTGATTCCAGTGGTTCTGCTTCAAGGCTTCCACTGCAAAACACTAAAGATCCAAGAAGGCCTTCATGGCCCCAGCAGGCCGGATCGGTACTGTATCAAGTCATGGCAGGTACAGTAGGATAAGCCACTCTGTCCCTTCCTGGGCAAAGAAGAAACGGAGGGGATGGAATTCTTCCTTAGACTTACTTTTGTAAAAATGTCCCCACGGTACTTACTCCCCACTGATGGACCAGTGGTTTCCAGTCATGAGCGTTAGACTGACTTGTTTGTCTTCCATTCCATTGTTTTGAAACTCAGTATGCTGCCCCTGTCTTGCTGTCATGAAATCAGCAAGAGAGGATGACACATCAAATAATAACTCGGATTCCAGCCCACATTGGATTCATCAGCATTTGGACCAATAGCCCACAGCTGAGAATGTGGAATACCTAAGGATAGCACCGCTTTTGTTCTCGCAAAAACGTATCTCCTAATTTGAGGCTCAGATGAAATGCATCAGGTCCTTTGGGGCATAGATCAGAAGACTACAAAAATGAAGCTGCTCTGAAATCTCCTTTAGCCATCACCCCAACCCCCCAAAATTAGTTTGTGTTACTTATGGAAGATAGTTTTCTCCTTTTACTTCACTTCAAAAGCTTTTTACTCAAAGAGTATATGTTCCCTCCAGGTCAGCTGCCCCCAAACCCCCTCCTTACGCTTTGTCACACAAAAAGTGTCTCTGCCTTGAGTCATCTATTCAAGCACTTACAGCTCTGGCCACAACAGGGCATTTTACAGGTGCGAATGACAGTAGCATTATGAGTAGTGTGGAATTCAGGTAGTAAATATGAAACTAGGGTTTGAAATTGATAATGCTTTCACAACATTTGCAGATGTTTTAGAAGGAAAAAAGTTCCTTCCTAAAATAATTTCTCTACAATTGGAAGATTGGAAGATTCAGCTAGTTAGGAGCCCACCTTTTTTCCTAATCTGTGTGTGCCCTGTAACCTGACTGGTTAACAGCAGTCCTTTGTAAACAGTGTTTTAAACTCTCCTAGTCAATATCCACCCCATCCAATTTATCAAGGAAGAAATGGTTCAGAAAATATTTTCAGCCTACAGTTATGTTCAGTCACACACACATACAAAATGTTCCTTTTGCTTTTAAAGTAATTTTTGACTCCCAGATCAGTCAGAGCCCCTACAGCATTGTTAAGAAAGTATTTGATTTTTGTCTCAATGAAAATAAAACTATATTCATTTCCACTCTAAAAAAAAAAAAAAAAA";
            
                if (cdna != expected) throw new InvalidDataException("NM_005228.3 is still not right.");
            }
            
            if (id.WithVersion == "NM_005922.2")
            {
                var newRnaEdits = new IRnaEdit[] 
                {
                    new RnaEdit(612,612,"A"), 
                    new RnaEdit(5485,5484,"AAAAAAAAAAAAAAAAA"),
                };

                rnaEdits = newRnaEdits;
                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "AAGATGGCCGCGGCGCGCACGGCTCCTGCGGCGGGGTAGAGGCGGAGGCGGAGTCGAGTCACTCCCGCACTTCGGGGCTCCGGTGCCCCGCGCCAGGCTGCAGCTTACTGCCCGCCGCGGCCATGCGGGGCTCCGTGCACGGATGAGAGAAGCCGCTGCCGCGCTGGTCCCTCCTCCCGCCTTTGCCGTCACGCCTGCCGCCGCCATGGAGGAGCCGCCGCCACCGCCGCCGCCGCCACCACCGCCACCGGAACCCGAGACCGAGTCAGAACCCGAGTGCTGCTTGGCGGCGAGGCAAGAGGGCACATTGGGAGATTCAGCTTGCAAGAGTCCTGAATCTGATCTAGAAGACTTCTCCGATGAAACAAATACAGAGAATCTTTATGGTACCTCTCCCCCCAGCACACCTCGACAGATGAAACGCATGTCAACCAAACATCAGAGGAATAATGTGGGGAGGCCAGCCAGTCGGTCTAATTTGAAAGAAAAAATGAATGCACCAAATCAGCCTCCACATAAAGACACTGGAAAAACAGTGGAGAATGTGGAAGAATACAGCTATAAGCAGGAGAAAAAGATCCGAGCAGCTCTTAGAACAACAGAGCGTGATCATAAAAAAAATGTACAGTGCTCATTCATGTTAGACTCAGTGGGTGGATCTTTGCCAAAAAAATCAATTCCAGATGTGGATCTCAATAAGCCTTACCTCAGCCTTGGCTGTAGCAATGCTAAGCTTCCAGTATCTGTGCCCATGCCTATAGCCAGACCTGCACGCCAGACTTCTAGGACTGACTGTCCAGCAGATCGTTTAAAGTTTTTTGAAACTTTACGACTTTTGCTAAAGCTTACCTCAGTCTCAAAGAAAAAAGACAGGGAGCAAAGAGGACAAGAAAATACGTCTGGTTTCTGGCTTAACCGATCTAACGAACTGATCTGGTTAGAGCTACAAGCCTGGCATGCAGGACGGACAATTAACGACCAGGACTTCTTTTTATATACAGCCCGTCAAGCCATCCCAGATATTATTAATGAAATCCTTACTTTCAAAGTCGACTATGGGAGCTTCGCCTTTGTTAGAGATAGAGCTGGTTTTAATGGTACTTCAGTAGAAGGGCAGTGCAAAGCCACTCCTGGAACAAAGATTGTAGGTTACTCAACACATCATGAGCATCTCCAACGCCAGAGGGTCTCATTTGAGCAGGTAAAACGGATAATGGAGCTGCTAGAGTACATAGAAGCACTTTATCCATCATTGCAGGCTCTTCAGAAGGACTATGAAAAATATGCTGCAAAAGACTTCCAGGACAGGGTGCAGGCACTCTGTTTGTGGTTAAACATCACAAAAGACTTAAATCAGAAATTAAGGATTATGGGCACTGTTTTGGGCATCAAGAATTTATCAGACATTGGCTGGCCAGTGTTTGAAATCCCTTCCCCTCGACCATCCAAAGGTAATGAGCCGGAGTATGAGGGTGATGACACAGAAGGAGAATTAAAGGAGTTGGAAAGTAGTACGGATGAGAGTGAAGAAGAACAAATCTCTGATCCTAGGGTACCGGAAATCAGACAGCCCATAGATAACAGCTTCGACATCCAGTCGCGGGACTGCATATCCAAGAAGCTTGAGAGGCTCGAATCTGAGGATGATTCTCTTGGCTGGGGAGCACCAGACTGGAGCACAGAAGCAGGCTTTAGTAGACATTGTCTGACTTCTATTTATAGACCATTTGTAGACAAAGCACTGAAGCAGATGGGGTTAAGAAAGTTAATTTTAAGACTTCACAAGCTAATGGATGGTTCCTTGCAAAGGGCACGTATAGCATTGGTAAAGAACGATCGTCCAGTGGAGTTTTCTGAATTTCCAGATCCCATGTGGGGTTCAGATTATGTGCAGTTGTCAAGGACACCACCTTCATCTGAGGAGAAATGCAGTGCTGTGTCGTGGGAGGAGCTGAAGGCCATGGATTTACCTTCATTCGAACCTGCCTTCCTAGTTCTCTGCCGAGTCCTTCTGAATGTCATACATGAGTGTCTGAAGTTAAGATTGGAGCAGAGACCTGCTGGAGAACCATCTCTCTTGAGTATTAAGCAGCTGGTGAGAGAGTGTAAGGAGGTCCTGAAGGGCGGCCTGCTGATGAAGCAGTACTACCAGTTCATGCTGCAGGAGGTTCTGGAGGACTTGGAGAAGCCCGACTGCAACATTGACGCTTTTGAAGAGGATCTACATAAAATGCTTATGGTGTATTTTGATTACATGAGAAGCTGGATCCAAATGCTACAGCAATTACCTCAAGCATCGCATAGTTTAAAAAATCTGTTAGAAGAAGAATGGAATTTCACCAAAGAAATAACTCATTACATACGGGGAGGAGAAGCACAGGCCGGGAAGCTTTTCTGTGACATTGCAGGAATGCTGCTGAAATCTACAGGAAGTTTTTTAGAATTTGGCTTACAGGAGAGCTGTGCTGAATTTTGGACTAGTGCGGATGACAGCAGTGCTTCCGACGAAATCAGGAGGTCTGTTATAGAGATCAGTCGAGCCCTGAAGGAGCTCTTCCATGAAGCCAGAGAAAGGGCTTCCAAAGCACTTGGATTTGCTAAAATGTTGAGAAAGGACCTGGAAATAGCAGCAGAATTCAGGCTTTCAGCCCCAGTTAGAGACCTCCTGGATGTTCTGAAATCAAAACAGTATGTCAAGGTGCAAATTCCTGGGTTAGAAAACTTGCAAATGTTTGTTCCAGACACTCTTGCTGAGGAGAAGAGTATTATTTTGCAGTTACTCAATGCAGCTGCAGGAAAGGACTGTTCAAAAGATTCAGATGACGTACTCATCGATGCCTATCTGCTTCTGACCAAGCACGGTGATCGAGCCCGTGATTCAGAGGACAGCTGGGGCACCTGGGAGGCACAGCCTGTCAAAGTCGTGCCTCAGGTGGAGACTGTTGACACCCTGAGAAGCATGCAGGTGGATAATCTTTTACTAGTTGTCATGCAGTCTGCGCATCTCACAATTCAGAGAAAAGCTTTCCAGCAGTCCATTGAGGGACTTATGACTCTGTGCCAGGAGCAGACATCCAGTCAGCCGGTCATCGCCAAAGCTTTGCAGCAGCTGAAGAATGATGCATTGGAGCTATGCAACAGGATAAGCAATGCCATTGACCGCGTGGACCACATGTTCACATCAGAATTTGATGCTGAGGTTGATGAATCTGAATCTGTCACCTTGCAACAGTACTACCGAGAAGCAATGATTCAGGGGTACAATTTTGGATTTGAGTATCATAAAGAAGTTGTTCGTTTGATGTCTGGGGAGTTTAGACAGAAGATAGGAGACAAATATATAAGCTTTGCCCGGAAGTGGATGAATTATGTCCTGACTAAATGTGAGAGTGGTAGAGGTACAAGACCCAGGTGGGCGACTCAAGGATTTGATTTTCTACAAGCAATTGAACCTGCCTTTATTTCAGCTTTACCAGAAGATGACTTCTTGAGTTTACAAGCCTTGATGAATGAATGCATTGGCCATGTCATAGGAAAACCACACAGTCCTGTTACAGGTTTGTACCTTGCCATTCATCGGAACAGCCCCCGTCCTATGAAGGTACCTCGATGCCATAGTGACCCTCCTAACCCACACCTCATTATCCCCACTCCAGAGGGATTCAGCACTCGGAGCATGCCTTCCGACGCGCGGAGCCATGGCAGCCCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGTTGCTGCCAGTCGGCCCAGCCCCTCTGGTGGTGACTCTGTGCTGCCCAAATCCATCAGCAGTGCCCATGATACCAGGGGTTCCAGCGTTCCTGAAAATGATCGATTGGCTTCCATAGCTGCTGAATTGCAGTTTAGGTCCCTGAGTCGTCACTCAAGCCCCACGGAGGAGCGAGATGAACCAGCATATCCAAGAGGAGATTCAAGTGGGTCCACAAGAAGAAGTTGGGAACTTCGGACACTAATCAGCCAGAGTAAAGATACTGCTTCTAAACTAGGACCCATAGAAGCTATCCAGAAGTCAGTCCGATTGTTTGAAGAAAAGAGGTACCGAGAAATGAGGAGAAAGAATATCATTGGTCAAGTTTGTGATACGCCTAAGTCCTATGATAATGTTATGCACGTTGGCTTGAGGAAGGTGACCTTCAAATGGCAAAGAGGAAACAAAATTGGAGAAGGCCAGTATGGGAAGGTGTACACCTGCATCAGCGTCGACACCGGGGAGCTGATGGCCATGAAAGAGATTCGATTTCAACCTAATGACCATAAGACTATCAAGGAAACTGCAGACGAATTGAAAATATTCGAAGGCATCAAACACCCCAATCTGGTTCGGTATTTTGGTGTGGAGCTCCATAGAGAAGAAATGTACATCTTCATGGAGTACTGCGATGAGGGGACTTTAGAAGAGGTGTCAAGGCTGGGACTTCAGGAACATGTGATTAGGCTGTATTCAAAGCAGATCACCATTGCGATCAACGTCCTCCATGAGCATGGCATAGTCCACCGTGACATTAAAGGTGCCAATATCTTCCTTACCTCATCTGGATTAATCAAACTGGGAGATTTTGGATGTTCAGTAAAGCTCAAAAACAATGCCCAGACCATGCCTGGTGAAGTGAACAGCACCCTGGGGACAGCAGCATACATGGCACCTGAAGTCATCACTCGTGCCAAAGGAGAGGGCCATGGGCGTGCGGCCGACATCTGGAGTCTGGGGTGTGTTGTCATAGAGATGGTGACTGGCAAGAGGCCTTGGCATGAGTATGAGCACAACTTTCAAATTATGTATAAAGTGGGGATGGGACATAAGCCACCAATCCCTGAAAGATTAAGCCCTGAAGGAAAGGACTTCCTTTCTCACTGCCTTGAGAGTGACCCAAAGATGAGATGGACCGCCAGCCAGCTCCTCGACCATTCGTTTGTCAAGGTTTGCACAGATGAAGAATGAAGCCTAGTAGAATATGGACTTGGAAAATTCTCTTAATCACTACTGTATGTAATATTTACATAAAGACTGTGCTGAGAAGCAGTATAAGCCTTTTTAACCTTCCAAGACTGAAGACTGCACAGGTGACAAGCGTCACTTCTCCTGCTGCTCCTGTTTGTCTGATGTGGCAAAAGGCCCTCTGGAGGGCTGGTGGCCACGAGGTTAAAGAAGCTGCATGTTAAGTGCCATTACTACTGTACACGGACCATCGCCTCTGTCTCCTCCGTGTCTCGCGCGACTGAGAACCGTGACATCAGCGTAGTGTTTTGACCTTTCTAGGTTCAAAAGAAGTTGTAGTGTTATCAGGCGTCCCATACCTTGTTTTTAATCTCCTGTTTGTTGAGTGCACTGACTGTGAAACCTTTACCTTTTTTGTTGTTGTTGGCAAGCTGCAGGTTTGTAATGCAAAAGGCTGATTACTGAAATTTAAGAAAAAGGTTCTTTTTTCAATAAATGGTTTATTTTAGGAAAGCTCAAAAAAAAAAAAAAAAAA";
            
                if (cdna != expected) throw new InvalidDataException("NM_005922.2 is still not right.");
            }
            
            if (id.WithVersion == "NM_006724.2")
            {
                var newRnaEdits = new IRnaEdit[] 
                {
                    new RnaEdit(612,612,"A"), 
                    new RnaEdit(5335,5334,"AAAAAAAAAAAAAAAAA"),
                };

                rnaEdits = newRnaEdits;
                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "AAGATGGCCGCGGCGCGCACGGCTCCTGCGGCGGGGTAGAGGCGGAGGCGGAGTCGAGTCACTCCCGCACTTCGGGGCTCCGGTGCCCCGCGCCAGGCTGCAGCTTACTGCCCGCCGCGGCCATGCGGGGCTCCGTGCACGGATGAGAGAAGCCGCTGCCGCGCTGGTCCCTCCTCCCGCCTTTGCCGTCACGCCTGCCGCCGCCATGGAGGAGCCGCCGCCACCGCCGCCGCCGCCACCACCGCCACCGGAACCCGAGACCGAGTCAGAACCCGAGTGCTGCTTGGCGGCGAGGCAAGAGGGCACATTGGGAGATTCAGCTTGCAAGAGTCCTGAATCTGATCTAGAAGACTTCTCCGATGAAACAAATACAGAGAATCTTTATGGTACCTCTCCCCCCAGCACACCTCGACAGATGAAACGCATGTCAACCAAACATCAGAGGAATAATGTGGGGAGGCCAGCCAGTCGGTCTAATTTGAAAGAAAAAATGAATGCACCAAATCAGCCTCCACATAAAGACACTGGAAAAACAGTGGAGAATGTGGAAGAATACAGCTATAAGCAGGAGAAAAAGATCCGAGCAGCTCTTAGAACAACAGAGCGTGATCATAAAAAAAATGTACAGTGCTCATTCATGTTAGACTCAGTGGGTGGATCTTTGCCAAAAAAATCAATTCCAGATGTGGATCTCAATAAGCCTTACCTCAGCCTTGGCTGTAGCAATGCTAAGCTTCCAGTATCTGTGCCCATGCCTATAGCCAGACCTGCACGCCAGACTTCTAGGACTGACTGTCCAGCAGATCGTTTAAAGTTTTTTGAAACTTTACGACTTTTGCTAAAGCTTACCTCAGTCTCAAAGAAAAAAGACAGGGAGCAAAGAGGACAAGAAAATACGTCTGGTTTCTGGCTTAACCGATCTAACGAACTGATCTGGTTAGAGCTACAAGCCTGGCATGCAGGACGGACAATTAACGACCAGGACTTCTTTTTATATACAGCCCGTCAAGCCATCCCAGATATTATTAATGAAATCCTTACTTTCAAAGTCGACTATGGGAGCTTCGCCTTTGTTAGAGATAGAGCTGGTTTTAATGGTACTTCAGTAGAAGGGCAGTGCAAAGCCACTCCTGGAACAAAGATTGTAGGTTACTCAACACATCATGAGCATCTCCAACGCCAGAGGGTCTCATTTGAGCAGGTAAAACGGATAATGGAGCTGCTAGAGTACATAGAAGCACTTTATCCATCATTGCAGGCTCTTCAGAAGGACTATGAAAAATATGCTGCAAAAGACTTCCAGGACAGGGTGCAGGCACTCTGTTTGTGGTTAAACATCACAAAAGACTTAAATCAGAAATTAAGGATTATGGGCACTGTTTTGGGCATCAAGAATTTATCAGACATTGGCTGGCCAGTGTTTGAAATCCCTTCCCCTCGACCATCCAAAGGTAATGAGCCGGAGTATGAGGGTGATGACACAGAAGGAGAATTAAAGGAGTTGGAAAGTAGTACGGATGAGAGTGAAGAAGAACAAATCTCTGATCCTAGGGTACCGGAAATCAGACAGCCCATAGATAACAGCTTCGACATCCAGTCGCGGGACTGCATATCCAAGAAGCTTGAGAGGCTCGAATCTGAGGATGATTCTCTTGGCTGGGGAGCACCAGACTGGAGCACAGAAGCAGGCTTTAGTAGACATTGTCTGACTTCTATTTATAGACCATTTGTAGACAAAGCACTGAAGCAGATGGGGTTAAGAAAGTTAATTTTAAGACTTCACAAGCTAATGGATGGTTCCTTGCAAAGGGCACGTATAGCATTGGTAAAGAACGATCGTCCAGTGGAGTTTTCTGAATTTCCAGATCCCATGTGGGGTTCAGATTATGTGCAGTTGTCAAGGACACCACCTTCATCTGAGGAGAAATGCAGTGCTGTGTCGTGGGAGGAGCTGAAGGCCATGGATTTACCTTCATTCGAACCTGCCTTCCTAGTTCTCTGCCGAGTCCTTCTGAATGTCATACATGAGTGTCTGAAGTTAAGATTGGAGCAGAGACCTGCTGGAGAACCATCTCTCTTGAGTATTAAGCAGCTGGTGAGAGAGTGTAAGGAGGTCCTGAAGGGCGGCCTGCTGATGAAGCAGTACTACCAGTTCATGCTGCAGGAGGTTCTGGAGGACTTGGAGAAGCCCGACTGCAACATTGACGCTTTTGAAGAGGATCTACATAAAATGCTTATGGTGTATTTTGATTACATGAGAAGCTGGATCCAAATGCTACAGCAATTACCTCAAGCATCGCATAGTTTAAAAAATCTGTTAGAAGAAGAATGGAATTTCACCAAAGAAATAACTCATTACATACGGGGAGGAGAAGCACAGGCCGGGAAGCTTTTCTGTGACATTGCAGGAATGCTGCTGAAATCTACAGGAAGTTTTTTAGAATTTGGCTTACAGGAGAGCTGTGCTGAATTTTGGACTAGTGCGGATGACAGCAGTGCTTCCGACGAAATCAGGAGGTCTGTTATAGAGATCAGTCGAGCCCTGAAGGAGCTCTTCCATGAAGCCAGAGAAAGGGCTTCCAAAGCACTTGGATTTGCTAAAATGTTGAGAAAGGACCTGGAAATAGCAGCAGAATTCAGGCTTTCAGCCCCAGTTAGAGACCTCCTGGATGTTCTGAAATCAAAACAGTATGTCAAGGTGCAAATTCCTGGGTTAGAAAACTTGCAAATGTTTGTTCCAGACACTCTTGCTGAGGAGAAGAGTATTATTTTGCAGTTACTCAATGCAGCTGCAGGAAAGGACTGTTCAAAAGATTCAGATGACGTACTCATCGATGCCTATCTGCTTCTGACCAAGCACGGTGATCGAGCCCGTGATTCAGAGGACAGCTGGGGCACCTGGGAGGCACAGCCTGTCAAAGTCGTGCCTCAGGTGGAGACTGTTGACACCCTGAGAAGCATGCAGGTGGATAATCTTTTACTAGTTGTCATGCAGTCTGCGCATCTCACAATTCAGAGAAAAGCTTTCCAGCAGTCCATTGAGGGACTTATGACTCTGTGCCAGGAGCAGACATCCAGTCAGCCGGTCATCGCCAAAGCTTTGCAGCAGCTGAAGAATGATGCATTGGAGCTATGCAACAGGATAAGCAATGCCATTGACCGCGTGGACCACATGTTCACATCAGAATTTGATGCTGAGGTTGATGAATCTGAATCTGTCACCTTGCAACAGTACTACCGAGAAGCAATGATTCAGGGGTACAATTTTGGATTTGAGTATCATAAAGAAGTTGTTCGTTTGATGTCTGGGGAGTTTAGACAGAAGATAGGAGACAAATATATAAGCTTTGCCCGGAAGTGGATGAATTATGTCCTGACTAAATGTGAGAGTGGTAGAGGTACAAGACCCAGGTGGGCGACTCAAGGATTTGATTTTCTACAAGCAATTGAACCTGCCTTTATTTCAGCTTTACCAGAAGATGACTTCTTGAGTTTACAAGCCTTGATGAATGAATGCATTGGCCATGTCATAGGAAAACCACACAGTCCTGTTACAGGTTTGTACCTTGCCATTCATCGGAACAGCCCCCGTCCTATGAAGGTACCTCGATGCCATAGTGACCCTCCTAACCCACACCTCATTATCCCCACTCCAGAGGGATTCAGGGGTTCCAGCGTTCCTGAAAATGATCGATTGGCTTCCATAGCTGCTGAATTGCAGTTTAGGTCCCTGAGTCGTCACTCAAGCCCCACGGAGGAGCGAGATGAACCAGCATATCCAAGAGGAGATTCAAGTGGGTCCACAAGAAGAAGTTGGGAACTTCGGACACTAATCAGCCAGAGTAAAGATACTGCTTCTAAACTAGGACCCATAGAAGCTATCCAGAAGTCAGTCCGATTGTTTGAAGAAAAGAGGTACCGAGAAATGAGGAGAAAGAATATCATTGGTCAAGTTTGTGATACGCCTAAGTCCTATGATAATGTTATGCACGTTGGCTTGAGGAAGGTGACCTTCAAATGGCAAAGAGGAAACAAAATTGGAGAAGGCCAGTATGGGAAGGTGTACACCTGCATCAGCGTCGACACCGGGGAGCTGATGGCCATGAAAGAGATTCGATTTCAACCTAATGACCATAAGACTATCAAGGAAACTGCAGACGAATTGAAAATATTCGAAGGCATCAAACACCCCAATCTGGTTCGGTATTTTGGTGTGGAGCTCCATAGAGAAGAAATGTACATCTTCATGGAGTACTGCGATGAGGGGACTTTAGAAGAGGTGTCAAGGCTGGGACTTCAGGAACATGTGATTAGGCTGTATTCAAAGCAGATCACCATTGCGATCAACGTCCTCCATGAGCATGGCATAGTCCACCGTGACATTAAAGGTGCCAATATCTTCCTTACCTCATCTGGATTAATCAAACTGGGAGATTTTGGATGTTCAGTAAAGCTCAAAAACAATGCCCAGACCATGCCTGGTGAAGTGAACAGCACCCTGGGGACAGCAGCATACATGGCACCTGAAGTCATCACTCGTGCCAAAGGAGAGGGCCATGGGCGTGCGGCCGACATCTGGAGTCTGGGGTGTGTTGTCATAGAGATGGTGACTGGCAAGAGGCCTTGGCATGAGTATGAGCACAACTTTCAAATTATGTATAAAGTGGGGATGGGACATAAGCCACCAATCCCTGAAAGATTAAGCCCTGAAGGAAAGGACTTCCTTTCTCACTGCCTTGAGAGTGACCCAAAGATGAGATGGACCGCCAGCCAGCTCCTCGACCATTCGTTTGTCAAGGTTTGCACAGATGAAGAATGAAGCCTAGTAGAATATGGACTTGGAAAATTCTCTTAATCACTACTGTATGTAATATTTACATAAAGACTGTGCTGAGAAGCAGTATAAGCCTTTTTAACCTTCCAAGACTGAAGACTGCACAGGTGACAAGCGTCACTTCTCCTGCTGCTCCTGTTTGTCTGATGTGGCAAAAGGCCCTCTGGAGGGCTGGTGGCCACGAGGTTAAAGAAGCTGCATGTTAAGTGCCATTACTACTGTACACGGACCATCGCCTCTGTCTCCTCCGTGTCTCGCGCGACTGAGAACCGTGACATCAGCGTAGTGTTTTGACCTTTCTAGGTTCAAAAGAAGTTGTAGTGTTATCAGGCGTCCCATACCTTGTTTTTAATCTCCTGTTTGTTGAGTGCACTGACTGTGAAACCTTTACCTTTTTTGTTGTTGTTGGCAAGCTGCAGGTTTGTAATGCAAAAGGCTGATTACTGAAATTTAAGAAAAAGGTTCTTTTTTCAATAAATGGTTTATTTTAGGAAAGCTCAAAAAAAAAAAAAAAAAA";
            
                if (cdna != expected) throw new InvalidDataException("NM_006724.2 is still not right.");
            }
            
            if (id.WithVersion == "NM_019063.3")
            {
                var newRnaEdits = new IRnaEdit[] 
                {
                    new RnaEdit(1109,1109,"G"), 
                    new RnaEdit(1406,1406,"G"), 
                    new RnaEdit(5550,5549,"AAAAAAAAAAAAAAAA"),
                };

                rnaEdits = newRnaEdits;
                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "GGCGCGGCGCTCGCGGCTGCTGCCTGGGAGGGAGGCCGGGCAGGCGGCTGAGCGGCGCGGCTCTCAACGTGACGGGGAAGTGGTTCGGGCGGCCGCGGCTTACTACCCCAGGGCGAACGGACGGACGACGGAGGCGGGAGCCGGTAGCCGAGCCGGGCGACCTAGAGAACGAGCGGGTCAGGCTCAGCGTCGGCCACTCTGTCGGTCCGCTGAATGAAGTGCCCGCCCCTCTAAGCCCGGAGCCCGGCGCTTTCCCCGCAAGATGGACGGTTTCGCCGGCAGTCTCGATGATAGTATTTCTGCTGCAAGTACTTCTGATGTTCAAGATCGCCTGTCAGCTCTTGAGTCACGAGTTCAGCAACAAGAAGATGAAATCACTGTGCTAAAGGCGGCTTTGGCTGATGTTTTGAGGCGTCTTGCAATCTCTGAAGATCATGTGGCCTCAGTGAAAAAATCAGTCTCAAGTAAAGGCCAACCAAGCCCTCGAGCAGTTATTCCCATGTCCTGTATAACCAATGGAAGTGGTGCAAACAGAAAACCAAGTCATACCAGTGCTGTCTCAATTGCAGGAAAAGAAACTCTTTCATCTGCTGCTAAAAGTGGTACAGAAAAAAAGAAAGAAAAACCACAAGGACAGAGAGAAAAAAAAGAGGAATCTCATTCTAATGATCAAAGTCCACAAATTCGAGCATCACCTTCTCCCCAGCCCTCTTCACAACCTCTCCAAATACACAGACAAACTCCAGAAAGCAAGAATGCTACTCCCACCAAAAGCATAAAACGACCATCACCAGCTGAAAAGTCACATAATTCTTGGGAAAATTCAGATGATAGCCGTAATAAATTGTCGAAAATACCTTCAACACCCAAATTAATACCAAAAGTTACCAAAACTGCAGACAAGCATAAAGATGTCATCATCAACCAAGAAGGAGAATATATTAAAATGTTTATGCGCGGTCGGCCAATTACCATGTTCATTCCTTCCGATGTTGACAACTATGATGACATCAGAACGGAACTGCCTCCTGAGAAGCTCAAACTGGAGTGGGCATATGGTTATCGAGGAAAGGACTGTAGAGCTAATGTTTACCTTCTTCCGACCGGGGAAATAGTTTATTTCATTGCATCAGTAGTAGTACTATTTAATTATGAGGAGAGAACTCAGCGACACTACCTGGGCCATACAGACTGTGTGAAATGCCTTGCTATACATCCTGACAAAATTAGGATTGCAACTGGACAGATAGCTGGCGTGGATAAAGATGGAAGGCCTCTACAACCCCACGTCAGAGTGTGGGATTCTGTTACTCTATCCACACTGCAGATTATTGGACTTGGCACTTTTGAGCGTGGAGTAGGATGCCTGGATTTTTCAAAAGCAGATTCAGGTGTTCATTTATGTGTTATTGATGACTCCAATGAGCATATGCTTACTGTATGGGACTGGCAGAAGAAAGCAAAAGGAGCAGAAATAAAGACAACAAATGAAGTTGTTTTGGCTGTGGAGTTTCACCCAACAGATGCAAATACCATAATTACATGCGGTAAATCTCATATTTTCTTCTGGACCTGGAGCGGCAATTCACTAACAAGAAAACAGGGAATTTTTGGGAAATATGAAAAGCCAAAATTTGTGCAGTGTTTAGCATTCTTGGGGAATGGAGATGTTCTTACTGGAGACTCAGGTGGAGTCATGCTTATATGGAGCAAAACTACTGTAGAGCCCACACCTGGGAAAGGACCTAAAGGTGTATATCAAATCAGCAAACAAATCAAAGCTCATGATGGCAGTGTGTTCACACTTTGTCAGATGAGAAATGGGATGTTATTAACTGGAGGAGGGAAAGACAGAAAAATAATTCTGTGGGATCATGATCTGAATCCTGAAAGAGAAATAGAGGTTCCTGATCAGTATGGCACAATCAGAGCTGTAGCAGAAGGAAAGGCAGATCAATTTTTAGTAGGCACATCACGAAACTTTATTTTACGAGGAACATTTAATGATGGCTTCCAAATAGAAGTACAGGGTCATACAGATGAGCTTTGGGGTCTTGCCACACATCCCTTCAAAGATTTGCTCTTGACATGTGCTCAGGACAGGCAGGTGTGCCTGTGGAACTCAATGGAACACAGGCTGGAATGGACCAGGCTGGTAGATGAACCAGGACACTGTGCAGATTTTCATCCAAGTGGCACAGTGGTGGCCATAGGAACGCACTCAGGCAGGTGGTTTGTTCTGGATGCAGAAACCAGAGATCTAGTTTCTATCCACACAGACGGGAATGAACAGCTCTCTGTGATGCGCTACTCAATAGATGGTACCTTCCTGGCTGTAGGATCTCATGACAACTTTATTTACCTCTATGTAGTCTCTGAAAATGGAAGAAAATATAGCAGATATGGAAGGTGCACTGGACATTCCAGCTACATCACACACCTTGACTGGTCCCCAGACAACAAGTATATAATGTCTAACTCGGGAGACTATGAAATATTGTACTGGGACATTCCAAATGGCTGCAAACTAATCAGGAATCGATCGGATTGTAAGGACATTGATTGGACGACATATACCTGTGTGCTAGGATTTCAAGTATTTGGTGTCTGGCCAGAAGGATCTGATGGGACAGATATCAATGCACTGGTGCGATCCCACAATAGAAAGGTGATAGCTGTTGCCGATGACTTTTGTAAAGTCCATCTGTTTCAGTATCCCTGCTCCAAAGCAAAGGCTCCCAGTCACAAGTACAGTGCCCACAGCAGCCATGTCACCAATGTCAGTTTTACTCACAATGACAGTCACCTGATATCAACTGGTGGAAAAGACATGAGCATCATTCAGTGGAAACTTGTGGAAAAGTTATCTTTGCCTCAGAATGAGACTGTAGCGGATACTACTCTAACCAAAGCCCCCGTCTCTTCCACTGAAAGTGTCATCCAATCTAATACTCCCACACCGCCTCCTTCTCAGCCCTTAAATGAGACAGCTGAAGAGGAAAGTAGAATAAGCAGTTCTCCCACACTTCTGGAGAACAGCCTGGAACAAACTGTGGAGCCAAGTGAAGACCACAGCGAGGAGGAGAGTGAAGAGGGCAGCGGAGACCTTGGTGAGCCTCTTTATGAAGAGCCATGCAACGAGATAAGCAAGGAGCAGGCCAAAGCCACCCTTCTGGAGGACCAGCAAGACCCTTCGCCCTCGTCCTAACACCCTGGCTTCAGTGCAACTCTTTTCCTTCAGCTGCATGTGATTTTGTGATAAAGTTCAGGTAACAGGATGGGCAGTGATGGAGAATCACTGTTGATTGAGATTTTGGTTTCCATGTGATTTGTTTTCTTCAATAGTCTTATTTTCAGTCTCTCAAATACAGCCAACTTAAAGTTTTAGTTTGGTGTTTATTGAAAATTAACCAAACTTAATACTAGGAGAAGACTGAATCATTAATGATGTCTCACAAATTACTGTGTACCTAAGTGGTGTGATGTAAATACTGGAAACAAAAACAGCAGTTGCATTGATTTTGAAAACAAACCCCCTTGTTATCTGAACATGTTTTCTTCAGGAACAACCAGAGGTATCACAAACACTGTTACTCATCTACTGGCTCAGACTGTACTACTTTTTTTTTTTTTTTTCCTGAAAAAGAAACCAGAAAAAAATGTACTCTTACTGAGATACCCTCTCACCCCAAATGTGTAATGGAAAATTTTTAATTAAGAAAAACTTCAGTTTTGCCAAGTGCAATGGTGTTGCCTTCTTTAAAAAATGCCGTTTTCTTACACTACCAGTGGATGTCCAGACATGCTCTTAGTCTACTAGAGAGGTGCTGCCTTTTCTAAGTCATAATGAGGAACAGTCCCTTAATTTCTTGTGTGCAACTCTGTTTTATCCTAGAACTAAGAGAGCATTGGTTTGTTAAAGAGCTTTCAATGTATATTAAAACCTTCAATACTCAGAAATGATGGATTCCTCCAAGGAGTCCTTTACTAGCCTAAACATTCTCAAATGTTTGAGATTCAAGTGAATGGAAGGAAAACCACATGCCTTTAAAACTAAACTGTAATAATTACCTGGCTAATTTCAGCTAAGCCTTCATCATAATTTGTTCCCTCAGTAATAGGAGAAATATAAATACAGTAAGTTTAGATTATTGAATTGGTGCTTGAAATTTATTGGTTTTGTTGTAATTTTATACAGATTATATGAGGGATAAGATACTCATCAAATTGCAAATTCTTTTTTTTACAGAAGTGTGGGTAACAGTCACAGCAGTTTTTTTTACCAACAGCATACTTAACAGACTTGCTGTGTAGCAGTTTTTTTCTGGTGGAGTTGCTGTAAGTCTTGTAAGTCTAATGTGGCTATCCTACTCTTTTGGGCAATGCATGTATTATGCATTGGAAAGGTATTTTTTTTAAGTTCTGTTGGCTAGCTATGGTTTTCAGTACATTTCCTACTTTAAGAGTAATTACTGACAAATATGTATTTCCTATATGTTTATACTTTGATTATAAAAAAGTATTTTGTTTTGATTTTTTAACTTGCTGCATTGTTTTGATACTTTCTATTTTTTTGGTCAAATCATGTTTAGAAACTTTGGATGAGTTAAGAAGTCTTAAGTATGCAGGCGTTTACGTGATTGTGCCATTCCAAAGTGCATCAGAACTGTCATTCCCTTCTAATATCTTCTCAGGAGTAATACAAATCAGGTATTTCATCATCATTTGGTAATATGAAAACTCCAGTGAACTCCCAAGGACATTTACAACATTTATATTCACACGCTGTATGGAAGGGTGTGGGTGTGTGTGAAGGGGCGAGTGGAGACACTGTGTGTATCTCTAGATAAGAAGATATGCACCACGTTGAAAATACTCAGTGTAGATCTCTATGTGTATAGGTATCTGTATATCTTTCCTTTTGTTTACAACTGTTAAAAAACCTCAAAATAGTTCTCTTCAAAAGAAGAGAGATTCCAAGCAACCCATCTTTCTTCAGTATGTATGTTCTGTACATACTTATCGGAGCGCGCCAGTAAGTATCAGGCATATATATCTGTCTGTTAGCAATGATTATTACATCATCAGATCAGCATGTGCTATACTCCCTGCAAGAAATATACTGACATGAACAGGCAGTTCTTGGAGAAGAAAGAGCATTTCTTTAAGTACCTGGGGAATACAGCTCTCAGTGATCAGCAGGGAGTTTATTTGAGGACATCAGTCACCTTTGGGGTTGCCATGTACAATGAGATTTATAATCATGATACTCTTCGGTGGTAGTTTCAAAAGACACTACTAATACGCAGGAAGCGTTCCAGCTATTTAATGCTGGCAACTACTGTTTAATGGTCAGTTAAATCTGTGATAATGGTTGGAAGTGGGTGGGGTTATGAAATTGTAGATGTTTTTAGAAAAACTTGTGAATGAAAATGAATCCAAGTGTTTCATGTGAAGATGTTGAGCCATTGCTATCATGCATTCCTGTCTCATGGCAGAAAATTTTGAAGATTAAAAAATAAAATAATCAAAATGTTTCCTCTTTCTAAAAAAAAAAAAAAAAAA";
            
                if (cdna != expected) throw new InvalidDataException("NM_019063.3 is still not right.");
            }
            
            if (id.WithVersion == "NM_152756.3")
            {
                var newRnaEdits = new IRnaEdit[] 
                {
                    new RnaEdit(1,0,"GG"), 
                    new RnaEdit(3196,3196,"T")
                };

                rnaEdits = newRnaEdits;
                
                var oldCodingRegion = translation.CodingRegion;
                var codingRegion    = new CodingRegion(oldCodingRegion.Start, oldCodingRegion.End, 25, 5151, 5127);
                translation = new Translation(codingRegion, (CompactId) translation.ProteinId, translation.PeptideSeq);
                
                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "GGGTTGTGACTGAAACCCGTCAATATGGCGGCGATCGGCCGCGGCCGCTCTCTGAAGAACCTCCGAGTACGAGGGCGGAATGACAGCGGCGAGGAGAACGTCCCGCTGGATCTGACCCGAGAACCTTCTGATAACTTAAGAGAGATTCTCCAAAATGTGGCCAGATTGCAGGGAGTATCAAATATGAGAAAGCTAGGCCATCTGAATAACTTTACTAAGCTTCTTTGTGATATTGGCCACAGTGAAGAAAAACTGGGCTTTCACTATGAGGATATCATAATTTGTTTGCGGTTAGCTTTATTAAATGAAGCAAAAGAAGTGCGAGCAGCAGGGCTACGAGCGCTTCGATATCTCATCCAAGACTCCAGTATTCTCCAGAAGGTGCTAAAATTGAAAGTGGACTATTTAATAGCTAGGTGCATTGACATACAACAGAGCAACGAGGTAGAGAGGACACAAGCACTTCGATTAGTCAGAAAGATGATTACTGTGAATGCTTCCTTGTTTCCTAGTTCTGTGACCAACTCATTAATTGCAGTTGGAAATGATGGACTTCAAGAAAGAGACAGAATGGTCCGAGCATGCATTGCCATTATCTGTGAACTAGCACTTCAGAATCCAGAGGTGGTGGCCCTTCGAGGTGGACTAAACACCATCTTGAAAAATGTGATCGATTGCCAATTAAGTCGAATAAATGAGGCCCTAATTACTACAATTTTGCACCTTCTTAATCATCCAAAGACTCGACAGTATGTGCGAGCTGATGTAGAATTAGAGAGAATTTTAGCACCCTATACTGATTTTCACTACAGACATAGTCCAGATACAGCTGAAGGACAGCTCAAAGAAGACAGAGAAGCACGATTTCTAGCCAGTAAAATGGGAATCATAGCAACATTCCGATCATGGGCAGGTATTATTAATTTATGTAAACCTGGAAATTCTGGGATCCAGTCTCTAATAGGAGTACTTTGCATACCAAATATGGAAATAAGGCGAGGTCTACTTGAAGTGCTTTATGATATATTTCGTCTTCCTCTACCTGTTGTGACTGAGGAGTTCATAGAAGCACTACTCAGTGTAGATCCAGGGAGGTTCCAAGACAGTTGGAGGCTTTCAGATGGCTTTGTGGCAGCTGAGGCAAAAACTATTCTTCCTCATCGTGCCAGATCCAGGCCAGACCTCATGGATAATTATTTGGCACTGATACTCTCTGCATTTATTCGTAATGGACTTTTAGAGGGTCTAGTTGAAGTGATAACAAACAGTGATGATCATATCTCAGTTAGAGCTACCATCCTTTTAGGAGAGCTTTTACATATGGCAAACACAATTCTTCCTCATTCACATAGCCATCATTTACACTGCTTGCCAACCCTAATGAATATGGCTGCATCCTTTGATATCCCCAAGGAAAAGAGACTGCGAGCCAGTGCAGCCTTGAACTGTTTAAAACGCTTCCATGAAATGAAGAAACGAGGACCTAAGCCTTATAGTCTTCATTTAGACCACATTATTCAGAAAGCAATTGCAACACACCAGAAACGGGATCAGTATCTCCGAGTTCAGAAAGATATATTTATCCTTAAGGATACAGAGGAAGCTCTTTTAATTAACCTTAGAGATAGCCAAGTCCTTCAACATAAAGAGAATCTTGAATGGAATTGGAATCTTATAGGGACCATTCTTAAGTGGCCAAATGTAAATCTAAGAAACTATAAAGATGAACAGTTACACAGGTTTGTACGAAGACTACTTTATTTTTACAAGCCCAGCAGTAAATTATATGCCAACCTGGATCTGGATTTTGCCAAGGCCAAACAGCTCACGGTTGTAGGTTGCCAGTTTACAGAATTTCTTCTTGAATCTGAAGAGGATGGGCAAGGCTACTTAGAAGATCTAGTAAAGGATATTGTTCAGTGGCTCAATGCTTCATCTGGAATGAAACCCGAAAGAAGTCTTCAAAATAATGGTTTATTGACCACCCTTAGTCAACACTACTTTTTATTTATTGGAACACTTTCTTGCCACCCTCATGGAGTTAAAATGCTGGAAAAATGCAGTGTATTTCAGTGTCTCCTTAATCTTTGCTCCTTGAAAAACCAAGATCACTTGCTAAAACTTACTGTTTCTAGCTTGGACTATAGCAGAGATGGATTGGCTAGAGTCATCCTTTCCAAAATTTTAACTGCAGCTACTGATGCCTGCAGACTCTATGCAACAAAACATTTAAGGGTATTATTGAGAGCTAATGTTGAATTCTTTAATAATTGGGGAATTGAGTTGTTAGTGACCCAGCTACATGATAAAAACAAAACGATTTCCTCTGAAGCTCTTGATATCCTCGATGAAGCATGTGAAGACAAGGCCAATCTTCATGCTCTCATTCAGATGAAACCAGCGTTATCCCACCTTGGAGACAAGGGTTTGCTTCTCCTGCTGAGATTTCTCTCCATTCCAAAAGGATTTTCCTATCTGAATGAAAGAGGTTATGTAGCAAAACAATTGGAAAAGTGGCACAGGGAATACAACTCCAAATATGTTGACTTGATTGAGGAACAACTCAATGAAGCACTTACTACTTACCGGAAGCCTGTTGATGGTGATAACTATGTTCGTCGGAGTAACCAAAGATTACAGCGTCCTCACGTCTACCTGCCTATACACCTTTATGGACAACTAGTACACCATAAAACAGGCTGCCATTTGTTGGAAGTACAGAATATTATTACAGAACTCTGTCGTAATGTTCGTACACCAGATTTGGATAAGTGGGAAGAAATTAAAAAACTGAAAGCATCTCTTTGGGCCTTGGGAAATATCGGCTCATCAAATTGGGGTCTCAATTTGCTACAGGAAGAAAACGTGATTCCAGATATACTAAAACTTGCAAAACAGTGTGAAGTTCTTTCCATCAGAGGGACCTGTGTATATGTACTTGGGCTCATAGCTAAAACCAAACAAGGCTGTGATATTCTAAAATGTCACAACTGGGATGCTGTGAGGCATAGTCGCAAACATCTGTGGCCAGTGGTTCCAGATGATGTGGAACAACTCTGTAATGAACTTTCATCTATCCCAAGCACTCTAAGTTTGAACTCGGAGTCAACCAGCTCTAGACATAATAGTGAAAGTGAATCTGTGCCATCGAGTATGTTCATATTGGAGGATGACCGGTTTGGCAGCAGCTCTACTAGTACATTTTTCCTTGATATCAATGAAGATACAGAGCCAACATTTTATGACCGATCTGGACCCATAAAGGATAAAAATTCATTCCCTTTCTTTGCTTCTAGTAAACTTGTGAAGAATCGTATCTTAAATTCGCTTACTTTGCCTAACAAAAAACATCGTAGTAGCAGTGATCCAAAAGGAGGGAAATTATCATCTGAAAGTAAGACAAGCAACAGGCGAATCAGAACACTTACGGAGCCCAGTGTTGATTTTAATCATAGTGATGATTTTACACCCATATCCACTGTACAGAAAACATTACAATTAGAGACTTCATTTATGGGGAATAAGCACATTGAAGACACTGGTAGTACACCAAGCATTGGAGAAAATGACTTAAAATTCACCAAGAATTTTGGTACAGAGAATCACAGAGAAAATACAAGCCGAGAGAGGTTAGTAGTAGAAAGTTCAACGAGCTCACATATGAAGATACGTAGCCAAAGTTTCAATACAGACACTACAACAAGTGGCATAAGTTCAATGAGCTCAAGTCCTTCACGAGAGACAGTAGGTGTAGATGCTACAACTATGGACACAGACTGTGGAAGCATGAGTACTGTGGTAAGTACTAAAACTATTAAGACAAGCCACTATTTGACGCCACAGTCTAACCATCTGTCTCTCTCCAAATCAAATTCGGTGTCCCTGGTGCCTCCAGGTTCTTCTCATACGCTTCCTAGAAGAGCACAGTCCCTTAAAGCACCCTCTATTGCTACAATTAAAAGTCTAGCAGATTGTAACTTTAGTTACACAAGTTCTAGAGATGCTTTTGGCTATGCTACACTGAAAAGACTACAGCAACAAAGAATGCATCCATCCTTATCTCACTCTGAAGCTTTGGCATCTCCAGCAAAAGATGTGCTATTTACTGATACCATCACCATGAAGGCCAACAGTTTTGAGTCCAGATTAACACCAAGCAGGTTCATGAAAGCCTTAAGTTATGCATCATTAGATAAAGAAGATTTATTGAGTCCTATTAATCAAAATACCCTGCAACGATCTTCCTCAGTGCGGTCCATGGTGTCCAGTGCCACATATGGGGGTTCAGATGATTACATTGGTCTTGCTCTCCCGGTGGATATAAATGATATATTCCAGGTAAAGGATATTCCCTATTTTCAGACAAAAAACATACCACCACATGATGATCGAGGTGCAAGAGCATTTGCCCATGATGCAGGAGGTCTTCCATCTGGAACTGGAGGTCTTGTAAAAAATTCTTTTCACTTGCTACGACAGCAGATGAGTCTTACGGAAATAATGAATTCAATCCATTCAGATGCCTCTCTGTTTTTAGAAAGTACAGAAGACACTGGACTACAGGAACATACAGATGATAACTGCCTTTATTGTGTCTGTATTGAAATTCTGGGTTTCCAGCCCAGCAACCAACTGAGTGCAATATGTAGTCATTCAGACTTTCAAGATATTCCATATTCTGATTGGTGTGAGCAGACTATCCATAATCCTTTAGAAGTGGTTCCCTCTAAGTTTTCGGGGATTTCTGGATGCAGTGATGGGGTGTCTCAAGAAGGCTCAGCTAGCAGCACCAAAAGCACAGAATTGTTACTAGGTGTTAAAACAATTCCAGATGATACACCAATGTGCCGTATACTCCTTCGCAAAGAAGTTCTAAGATTAGTCATTAATTTGAGTAGTTCAGTTTCAACTAAATGTCATGAGACTGGGCTTTTAACAATTAAGGAGAAGTATCCTCAAACATTTGATGACATATGCCTTTACTCTGAGGTTTCCCATTTGCTGTCACACTGCACATTCAGACTTCCGTGTCGGAGGTTCATACAAGAATTATTTCAAGATGTACAGTTTCTACAAATGCATGAAGAAGCAGAGGCTGTGTTGGCAACACCACCAAAGCAACCTATAGTTGATACATCTGCTGAATCCTGACCTCATATTTATGATGGATATAGATACATACTATATATATTCATATTTGTGGATTTCCTAAAAGCCTCAGAAAATACGACTGACTAGGCAGCAAAGACAGGAGTATCTTCTGTACACTGTTCCGCAGTTACTGGTACATGAACAGTTGGAACTGCTGACTTTCCTAACCAAAACAACTTCCTTCTCTCCTTTGTTGAGCCTTTTGAGGGGTTCATGATTCATTACCACAGTTTTAAGAGTTTCAGTTACCATTGTATGCAAGAGCCAAGCACTGAATACCTACATAGGTTTTCTATTTTCTTTCATTTTAAAAGCATAATGACAGTGGAACAATAATGGGATATGCAGAAGCACCCTTCACAAGTTATTTCTGAATGATTTTTAGGGTAAATAATACAGATGCCTTGTTTGTTAACTAACTTGTGGAAAGCAGGAATCAGTGTCTCTAAGGCTGCATCCTATTACCACAATGGGGTGTGCTATAACTGCTGGTATTAGAGAGGGAACTTTGGCCCTTTCACGTTTTTCTTAATGTTTGTAACACTACTTCAGAGGTTTATAACCTCAAAGCAGAAGAAGAGCCTCAACAACCCGGGACTTATAAGTTATTTTTATGTTACTAGACTTGCATAAAGATTCTTGTTTTCCAACTCTTCATTTTGTTGCAATGTGTTATTACAGGATATATGAACCAATTAAGGTTTTTCACTACAGTTCTTGAATAAAATTTAAAAATCATTTTTTATTTTAATTAAAAATATTTCCCATTTATAGAATGCATATATTTGCAATGGACTTCCACTTTCATCAACTTTCCATCTCATCGCTTTAAACAGGAACTTGAACAAGCACTGTTAGTTTAGACCTAAAGGATAGGAAAGCATTAAATAATACTTTGGATCTCCTGAGGAAAAGATAAGTTTGCTTGCAATTTACACATTCCATGGGGAAAGAAGAGCCATATTTCCTTAAAAAAAACATTAATAAAGCTTGTTATTGAGAAAAATTGTAGTGAAAAGCCTTAAGTACCAAATTTTAAAGCAGCAGTAACTTAATTTTTATATCAGTGTTTTTGTTTTGCACAAACTAAATGCAGTGGTAGGTGGGTTTATGAGTATATTAATTGCCTTTATCCATTTGTGAAGTTAAGTTGATGAGGGCAAGGTTTTTGTTTGTTTAATTTGTATATGTCTAAAGGTATTTGGAACTTTTTACAGGAATTAAACATATATGCAAATTTGTATATAAAAATAGCATGGCCATCATTTGAATGCTTGTAAATGAAAGGATTATCTTTTTTGAGATCTATATATAAATAGAAATAGAAAATCCAGCTGGACTGATTAGGATTCTTTTTTAATTCATTTGTGTATAACATTTTTATTACAATTACACATCAGTTTTGACACAGTCATAGCAACATTAATATTTTCCCATGATGCAGATCCTTTTTGTAATGGGCTTGTTCTTTGAGATCTCTGTAAAGAACCCTGTGAACTAGAAAACATAACTCACAGAGATACTTTTTTAAAAAATTTATTTACTGGAACTGAAAGTTCCAGTTGGGATGAAGCATTTCATCTCACTTCATAACACCTCTTTGACTGCACTTCAGTGAATTGTTCTTATGTGCACTGTGTAGCAACTTACATTATAACAAAGCAGATAAGGGCTGTAAGCTGCTGCTTATGTTGAAAAGTGGTTCTTCAGATTTTCTCTCATAAAATCCAGTTGAAGATAAATAATTTTTTTATACTTTATCACTGAACCCAAGTGTTTATTTAAATGTCAACAGTACTTCTAAGAACGTTGCCTGTCATCGTGGTCTTTGGTCTTGGATAACTAAACTGCCTTTCCAGAGAACCAAATGTCAGAGTTACTAGACCAAATAGTGGTTAAAACCTCCAAAGGAAGTAATGTAATCTTATTCATAATGGGATTAACATATTTTAGACATTCATTTTAAACACTACCTCAGTTAATATAGAGTATAAAAATCTGTGGTTTAATCCCTCAAAAGTTAACAGTAATTTTTTTTTTGTCTTACACACACACACACCCCCTCCCCCACCATCACTATCCCTGTACCCTCACCTTGGTCATCTATCCTGAAATAAGGCTTAGTTAGTATTGGCCTGAATGTTTTGTGTTTTTTTTTTTGTTTTTTTTTTTTACTGTTACTTTGAAAAATATGTATGTATACCTTATCATATCTGCCTATATCACTTACTTTGGGGAGATACTCAGAGCTTTGTGGTTATCAGTATACTAAAAAAAAAAAAAAGTCTACGCTTAAATTTATAGTGCTATTTGGTTTCTCCATGATTTCACTGACAGGTCTAATACATTTTCTTTGAGTACTTGTTTGTAAAAAGTAGACTTTATGGTGAAAAATACATGCAGTGCCAAGTGATTAACTTAAGTGTTTAAAAATATTAAATTATAGCAGAAGAGGTTAGGAATGATATCAGCAGTAATAGAAATAATTGAGAAAATCATCTATAAATAATAGATATTACAGACTATAGAATACCAAAATAATGTCAATACTGTAGTTTTTAAAGATTTTAGGATTAATCTTAGTCCATATAAATTTGTACTATTGGTAATTATTGAATAATTGGGAGGAATCTGGGCAGTTGTGCTGGTTGTAAACTATGAATTTCTAATCGTAAAGTGAATTGTTATTTCTAATTGAACTTTTTTTCAAGAACAGATTTCAGCCTCACATACTAAGTAAATACTGATAAATAAGGAAATTAGAAATTTAGTATTCATAATTAAATATGCTCTAAAATTTCCTATACTTTTATTTCCTGTTTATTCTTAGGTAGATTGGAAGGGGGAAACAGTCTGTTCTCCCTAATTAAATTTTTTCTAATAACGATTAGTAGAATATGGACATTCTATATGACAGTGACATTAAAAGAGGCTCTTTGGAAGTATATACATTATTAACATAATGTGTACAAGTCCTTTTGAAATGACAACTTTAATGGGTTTCAGCTCTTTTATCTAGAGCTTGAGATAATTCAAGCTGAGTTTTTCAGGGCATATCACAACGGCCAAGTGTTCAGCAGTGGGATATCAATGCTTATTTACATTTTCCTACTGCTATTTATATAAAATGTTATTCCATTCAGAGGATGCCTTTTATCCCCACATTAAAGCACAGATCATTAAGCAATAAAAACCAAATTGTCTGTCATTCAAATTATAACTGCAGTTATTTTTGCATGGTAAGAGTGAGGTGCTAATTTTGTGTGAGATGAACTTTGTAAACTACTTTGGGAAATGTTCTTTGGAAGTAAGGTTTTTTCTCCTTTAGTCTTATGCTTCCACTTTTGTCTCAGATTCACAATCCATTAAAACATGGGGAAAAAAGAAAAGGTAAAATTGAGAGACTTTTGTTAGAGGAGCTATTTGGAATGAACCAACATTTCAGATTTTCCAAAATGTAAGTTAGGAAGTCTCCATTGTCTCTGCATTAACAAAATACACTGTTACTATCTTAATCTCAAGAGTGTCATTACAGTGAGAATCTCATTTAAAAGCATACCAGTGAAATTAATAGCAGTGCTTATCAAAGAACACTGAAATCTGTGAGAATCTTTCTAGGAGCATTCTTTTCTTCTTTTAGTTCCAAGTTCCAGGGTATTTTTCATTCCTAGTAGGTTTATATGACTCACAGAATGTGGACTTTTTTCCTGTTTGGAGTATTTTTGTAATGTAAGTATCGGATAGCTGCACCACAGCATGCATAAATTGCACATTTTGTTTTACTTTCTTTATAGAATATTTAATTTCAAAAATATAATTTATGCCAAAAAAAGCATACCTTTCAATTTTGCTACTTGGTTGATTTAGCACAAAATGCAAAGTCTTGGGGCAGAGAGGGGGAGTGAAAAAAATTTTATAGGTAATTGTTACAAAAATACCTGTCAGAAACCCTAAAGCTGCATTGTAAAACAAATGGTGTAAACTAGTTTTGAAAAGTGGTAAGGAATTGTGAAAAAAATCTCAGACTTAATGCTCTCTAACCACATGAGTTTCTTCTTTTTTATTTAGTAATACGCTGCTACATATTTGGAGGTTCTGGTGTTTGTAGGTCACTGAACAGACATTGAAATCTGATTTATATTGTATAACTGTAACATAGAAAGAAAAAGTATTTATATTTTTTCTGTAAGAATATTTCATTGAGTTGTGTATAATTTAAATAAGATTTGTCCCCAAATGGTTTTGCTCACCTTGATTTTTTTTGTTGTGATTTTCTTGTTTTTGTATAATGTGTATAGTTTATGTCAAGGGCATTAAAAGCCTCCTGAAGCATAATCTTATCAAAGGGATACATTGTTAATAAAATGTACTTAAAATTCTTAAA";
            
                if (cdna != expected) throw new InvalidDataException("NM_152756.3 is still not right.");
            }
            
            if (id.WithVersion == "NM_175741.1")
            {
                var newRnaEdits = new IRnaEdit[] 
                {
                    new RnaEdit(220,220,"T"),
                    new RnaEdit(380,380,"C")
                };

                rnaEdits = newRnaEdits;
                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "GAGTTCCGTATTCTAGTTCTGTGTGATCTGATCTTTACCTTCCCTTCCTTGGATCCCTGTGCACCTACTGGAGCCAGGTTACTCTGGGTCCTGGACCTGACTGCCTCATTCTGGAGGCTTCCAGACAGCCACAGTTAGTGCCCAAACCTGAGAGGATGGCTTCAGATGGAGCATCTGCATTGCCGGGACCGGATATGAGCATGAAACCTAGTGCCGCCCTGTCTCCATCCCCTGCACTTCCCTTTCTCCCACCAACTTCTGACCCACCAGACCACCCACCCAGGGAGCCACCTCCACAGCCCATCATGCCTTCAGTATTCTCTCCAGACAACCCTCTGATGCTCTCTGCTTTCCCCAGCTCACTGTTGGTGACAGGGGACGGGGGCCCTTGCCTCAGTGGGGCTGGGGCTGGCAAGGTCATTGTCAAAGTCAAGACAGAAGGGGGGTCAGCTGAGCCCTCTCAAACTCAGAACTTTATCCTTACTCAGACTGCCCTCAATTCGACTGCCCCGGGCACTCCCTGTGGAGGCCTTGAGGGTCCTGCACCTCCATTTGTGACAGCATCTAATGTGAAGACCATTCTGCCCTCTAAGGCTGTTGGTGTCAGCCAGGAGGGTCCTCCAGGCCTTCCGCCTCAGCCTCCACCACCAGTTGCTCAACTGGTCCCCATTGTGCCCCTGGAAAAAGCTTGGCCAGGGCCACATGGGACAACCGGGGAAGGAGGTCCTGTGGCCACTCTATCCAAGCCTTCCCTAGGTGACCGCTCCAAAATTTCCAAGGACGTTTATGAGAACTTCCGTCAGTGGCAGCGTTACAAAGCCTTGGCCCGGAGGCACCTATCCCAGAGTCCTGACACAGAAGCTCTTTCCTGTTTTCTTATCCCAGTGCTTCGTTCCCTGGCCCGGCTGAAGCCCACTATGACCCTGGAGGAGGGACTGCCATTGGCTGTGCAGGAGTGGGAGCACACCAGCAACTTTGACCGGATGATCTTTTATGAGATGGCAGAAAGGTTCATGGAGTTTGAGGCTGAGGAGATGCAGATTCAGAACACACAGCTGATGAATGGGTCTCAGGGCCTGTCTCCTGCAACCCCTTTGAAACTTGATCCTCTAGGGCCCCTGGCCTCTGAGGTTTGCCAGCAGCCAGTGTACATTCCGAAGAAGGCAGCCTCCAAGACACGGGCCCCCCGCCGGCGTCAGCGTAAAGCCCAGAGACCTCCTGCTCCTGAGGCACCCAAGGAGATCCCACCAGAAGCTGTGAAGGAGTATGTTGACATCATGGAATGGCTGGTGGGGACTCACTTGGCCACTGGGGAGTCAGATGGAAAACAAGAGGAAGAAGGGCAGCAGCAGGAGGAGGAAGGGATGTATCCAGATCCAGGTCTCCTGAGCTACATCAATGAGCTGTGTTCTCAGAAGGTCTTTGTCTCCAAGGTGGAGGCTGTCATTCACCCTCAATTTCTGGCAGATCTGCTGTCCCCAGAAAAACAGAGAGATCCCTTGGCCTTAATTGAGGAGCTAGAGCAAGAAGAAGGACTCACTCTTGCCCAGCTGGTCCAGAAGCGACTCATGGCCTTGGAAGAGGAGGAAGATGCAGAGGCGCCTCCAAGTTTCAGTGGCGCTCAGTTGGACTCAAGTCCTTCTGGTTCTGTTGAGGATGAAGATGGGGATGGGCGGCTTCGGCCCTCACCTGGGCTTCAGGGGGCTGGGGGCGCCGCTTGCCTTGGAAAGGTTTCTTCTTCAGGAAAACGGGCAAGAGAAGTGCATGGTGGGCAGGAGCAAGCCCTAGATAGCCCCAGAGGGATGCACAGGGATGGGAACACTCTGCCATCCCCCAGCAGCTGGGACCTGCAGCCAGAACTTGCAGCTCCACAGGGAACTCCGGGACCCTTGGGTGTGGAGAGGAGAGGGTCTGGGAAGGTTATAAACCAGGTATCTCTACATCAGGATGGCCATCTAGGAGGCGCTGGGCCTCCTGGGCACTGCCTGGTGGCTGATAGGACTTCAGAGGCTCTGCCCCTTTGTTGGCAGGGAGGCTTCCAGCCTGAGAGCACTCCCAGTTTGGATGCTGGACTTGCAGAGCTGGCTCCTCTGCAAGGACAAGGGTTAGAAAAGCAAGTCCTGGGATTGCAGAAAGGACAACAAACAGGGGGTCGTGGAGTGCTTCCTCAAGGGAAGGAGCCTTTAGCAGTGCCCTGGGAAGGCTCTTCAGGAGCCATGTGGGGAGATGACAGAGGTACCCCCATGGCTCAGAGTTATGATCAGAATCCTTCCCCTAGAGCAGCTGGGGAGAGGGACGATGTCTGTCTCAGCCCAGGAGTTTGGCTGAGCAGTGAGATGGATGCTGTAGGCTTGGAGCTGCCTGTACAAATAGAGGAGGTCATAGAGAGCTTCCAAGTTGAGAAGTGTGTAACTGAGTATCAGGAAGGCTGCCAGGGACTGGGCTCCAGGGGCAACATTTCCCTGGGTCCTGGAGAAACCCTAGTACCTGGGGATACGGAGAGCAGTGTGATTCCCTGTGGAGGCACAGTTGCGGCAGCTGCCCTAGAAAAGAGAAACTATTGCAGCTTGCCAGGACCTTTGAGGGCCAACAGCCCACCCTTGAGGTCCAAAGAAAATCAAGAACAGAGCTGTGAAACCGTAGGGCATCCCAGTGATCTGTGGGCAGAAGGTTGCTTCCCATTGCTAGAAAGTGGTGATTCCACACTGGGGTCTTCCAAAGAAACCCTTCCACCCACATGCCAAGGCAATCTCCTTATCATGGGGACTGAGGATGCCTCCTCCTTGCCTGAAGCCAGTCAAGAGGCAGGGAGCAGAGGCAATTCCTTTTCTCCTCTGTTGGAAACCATAGAACCTGTCAACATACTAGATGTTAAAGATGACTGTGGCCTCCAACTAAGGGTCAGCGAGGACACCTGCCCACTGAATGTTCATTCTTATGACCCCCAAGGAGAAGGCAGGGTGGATCCTGATCTGTCCAAGCCTAAAAACCTTGCTCCTTTACAAGAGAGTCAGGAGTCTTACACAACTGGGACTCCCAAAGCAACATCTTCTCACCAGGGCCTTGGAAGCACTTTGCCTAGAAGGGGAACCAGGAATGCCATAGTTCCGAGAGAAACTTCTGTTAGTAAAACACACAGGTCAGCAGACAGGGCCAAAGGAAAGGAGAAAAAGAAAAAGGAAGCAGAGGAAGAGGATGAGGAACTCTCCAACTTTGCTTACCTCTTGGCCTCTAAACTTAGCCTCTCACCAAGGGAGCATCCCCTCAGTCCTCACCATGCCTCAGGAGGTCAGGGCAGCCAGAGAGCATCCCACCTGCTCCCTGCTGGAGCAAAAGGCCCCAGCAAACTTCCATATCCTGTTGCCAAGTCTGGGAAGCGAGCTCTAGCTGGAGGTCCAGCCCCTACTGAAAAGACACCCCACTCAGGAGCTCAACTTGGGGTCCCCAGGGAGAAACCCCTAGCTCTGGGAGTAGTTCGACCCTCACAGCCTCGTAAAAGGCGGTGTGACAGTTTTGTCACGGGCAGAAGGAAGAAACGACGTCGTAGCCAGTAGGGAGCAGCGGGACCATCTGACCCCACTTGCCAGTCCCTAAAGGTGGGTGCCCCAGAGTAGATTCCACCCCTGCTGCCCACCAATGGAGAATCCCAATGTTGAATCTCATCCCAATGTTGTTTTGTTGTTCTGCAAAAGTGGCAAGCATGGAGAGAGAGGTCAGACTGGCTAGGCTGCAGGGGGAATTACCTTTGGAAGGAGCTATATAGAAAAAAAATGAATAAAGTGTTTTGTTGGAAAA";
            
                if (cdna != expected) throw new InvalidDataException("NM_175741.1 is still not right.");
            }
            
            /*if (id.WithVersion == "NM_022148.2")
            {
                var newRnaEdits = new IRnaEdit[] 
                {
                    new RnaEdit(1,0,"AATTCGGCACGAGG"), 
                    new RnaEdit(1406,1406,"G"), 
                    new RnaEdit(5550,5549,"AAAAAAAAAAAAAAAA"),
                };

                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "AATTCGGCACGAGGGCATGGGGCGGCTGGTTCTGCTGTGGGGAGCTGCCGTCTTTCTGCTGGGAGGCTGGATGGCTTTGGGGCAAGGAGGAGCAGCAGAAGGAGTACAGATTCAGATCATCTACTTCAATTTAGAAACCGTGCAGGTGACATGGAATGCCAGCAAATACTCCAGGACCAACCTGACTTTCCACTACAGATTCAACGGTGATGAGGCCTATGACCAGTGCACCAACTACCTTCTCCAGGAAGGTCACACTTCGGGGTGCCTCCTAGACGCAGAGCAGCGAGACGACATTCTCTATTTCTCCATCAGGAATGGGACGCACCCCGTTTTCACCGCAAGTCGCTGGATGGTTTATTACCTGAAACCCAGTTCCCCGAAGCACGTGAGATTTTCGTGGCATCAGGATGCAGTGACGGTGACGTGTTCTGACCTGTCCTACGGGGATCTCCTCTATGAGGTTCAGTACCGGAGCCCCTTCGACACCGAGTGGCAGTCCAAACAGGAAAATACCTGCAACGTCACCATAGAAGGCTTGGATGCCGAGAAGTGTTACTCTTTCTGGGTCAGGGTGAAGGCTATGGAGGATGTATATGGGCCAGACACATACCCAAGCGACTGGTCAGAGGTGACATGCTGGCAGAGAGGCGAGATTCGGGATGCCTGTGCAGAGACACCAACGCCTCCCAAACCAAAGCTGTCCAAATTTATTTTAATTTCCAGCCTGGCCATCCTTCTGATGGTGTCTCTCCTCCTTCTGTCTTTATGGAAATTATGGAGAGTGAAGAAGTTTCTCATTCCCAGCGTGCCAGACCCGAAATCCATCTTCCCCGGGCTCTTTGAGATACACCAAGGGAACTTCCAGGAGTGGATCACAGACACCCAGAACGTGGCCCACCTCCACAAGATGGCAGGTGCAGAGCAAGAAAGTGGCCCCGAGGAGCCCCTGGTAGTCCAGTTGGCCAAGACTGAAGCCGAGTCTCCCAGGATGCTGGACCCACAGACCGAGGAGAAAGAGGCCTCTGGGGGATCCCTCCAGCTTCCCCACCAGCCCCTCCAAGGCGGTGATGTGGTCACAATCGGGGGCTTCACCTTTGTGATGAATGACCGCTCCTACGTGGCGTTGTGATGGACACACCACTGTCAAAGTCAACGTCAGGATCCACGTTGACATTTAAAGACAGAGGGGACTGTCCCGGGGACTCCACACCACCATGGATGGGAAGTCTCCACGCCAATGATGGTAGGACTAGGAGACTCTGAAGACCCAGCCTCACCGCCTAATGCGGCCACTGCCCTGCTAACTTTCCCCCACATGAGTCTCTGTGTTCAAAGGCTTGATGGCAGATGGGAGCCAATTGCTCCAGGAGATTTACTCCCAGTTCCTTTTCGTGCCTGAACGTTGTCACATAAACCCCAAGGCAGCACGTCCAAAATGCTGTAAAACCATCTTCCCACTCTGTGAGTCCCCAGTTCCGTCCATGTACCTGTTCCATAGCATTGGATTCTCGGAGGATTTTTTGTCTGTTTTGAGACTCCAAACCACCTCTACCCCTACAAAAAAAAAAAAAAAAAA";
            
                if (cdna != expected) throw new InvalidDataException("NM_022148.2 is still not right.");
            }*/
            
            if (id.WithVersion == "NM_001244937.1")
            {
                var newRnaEdits = new IRnaEdit[] 
                {
                    new RnaEdit(3700,3700,"G"),
                    new RnaEdit(4626,4625,"AAAAAAAAAAAAA"),
                };
                
                rnaEdits = newRnaEdits;
                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "AGTGTACAGCGGCGGCTGGGGCGGCAGGTGAGGCGGCTGGGGCGTTGCTGTCGTGCGTCCGCAGGCGTCAGGTGCTCAGACCCGAGGGCCGGGAAGGGATTTGGGTTTCACAGGAACCTGGGGCGGGGGTCCGCTATCTTGGGGCTGTCGGGACCGCTGCTTAAATTTGGCCCAGTCCAGACCTCGAGTCGGGCCCCCAGCCAGGCCCACGCCCAGGTCCAGGCCCAGGCCGGTAGGGATCCTCTAGGGTCCCAGCTCGCCTCGATGGAGCTCCTCCCGCCGCTGCCTCAGTCCTTCCTGTTGCTGCTGCTGTTGCCTGCCAAGCCCGCGGCGGGCGAGGACTGGCAGTGCCCGCGCACCCCCTACGCGGCCTCTCGCGACTTTGACGTGAAGTACGTGGTGCCCAGCTTCTCCGCCGGAGGCCTGGTACAGGCCATGGTGACCTACGAGGGCGACAGAAATGAGAGTGCTGTGTTTGTAGCCATACGCAATCGCCTGCATGTGCTTGGGCCTGACCTGAAGTCTGTCCAGAGCCTGGCCACGGGCCCTGCTGGAGACCCTGGCTGCCAGACGTGTGCAGCCTGTGGCCCAGGACCCCACGGCCCTCCCGGTGACACAGACACAAAGGTGCTGGTGCTGGATCCCGCGCTGCCTGCGCTGGTCAGTTGTGGCTCCAGCCTGCAGGGCCGCTGCTTCCTGCATGACCTAGAGCCCCAAGGGACAGCCGTGCATCTGGCAGCGCCAGCCTGCCTCTTCTCAGCCCACCATAACCGGCCCGATGACTGCCCCGACTGTGTGGCCAGCCCATTGGGCACCCGTGTAACTGTGGTTGAGCAAGGCCAGGCCTCCTATTTCTACGTGGCATCCTCACTGGACGCAGCCGTGGCTGCCAGCTTCAGCCCACGCTCAGTGTCTATCAGGCGTCTCAAGGCTGACGCCTCGGGATTCGCACCGGGCTTTGTGGCGTTGTCAGTGCTGCCCAAGCATCTTGTCTCCTACAGTATTGAATACGTGCACAGCTTCCACACGGGAGCCTTCGTATACTTCCTGACTGTACAGCCGGCCAGCGTGACAGATGATCCTAGTGCCCTGCACACACGCCTGGCACGGCTTAGCGCCACTGAGCCAGAGTTGGGTGACTATCGGGAGCTGGTCCTCGACTGCAGATTTGCTCCAAAACGCAGGCGCCGGGGGGCCCCAGAAGGCGGACAGCCCTACCCTGTGCTGCGGGTGGCCCACTCCGCTCCAGTGGGTGCCCAACTTGCCACTGAGCTGAGCATCGCCGAGGGCCAGGAAGTACTATTTGGGGTCTTTGTGACTGGCAAGGATGGTGGTCCTGGCGTGGGCCCCAACTCTGTCGTCTGTGCCTTCCCCATTGACCTGCTGGACACACTAATTGATGAGGGTGTGGAGCGCTGTTGTGAATCCCCAGTCCATCCAGGCCTCCGGCGAGGCCTCGACTTCTTCCAGTCGCCCAGTTTTTGCCCCAACCCGCCTGGCCTGGAAGCCCTCAGCCCCAACACCAGCTGCCGCCACTTCCCTCTGCTGGTCAGTAGCAGCTTCTCACGTGTGGACCTATTCAATGGGCTGTTGGGACCAGTACAGGTCACTGCATTGTATGTGACACGCCTTGACAACGTCACAGTGGCACACATGGGCACAATGGATGGGCGTATCCTGCAGGTGGAGCTGGTCAGGTCACTAAACTACTTGCTGTATGTGTCCAACTTCTCACTGGGTGACAGTGGGCAGCCCGTGCAGCGGGATGTCAGTCGTCTTGGGGACCACCTACTCTTTGCCTCTGGGGACCAGGTTTTCCAGGTACCTATCCAAGGCCCTGGCTGCCGCCACTTCCTGACCTGTGGGCGTTGCCTAAGGGCATGGCATTTCATGGGCTGTGGCTGGTGTGGGAACATGTGCGGCCAGCAGAAGGAGTGTCCTGGCTCCTGGCAACAGGACCACTGCCCACCTAAGCTTACTGAGTTCCACCCCCACAGTGGACCTCTAAGGGGCAGTACAAGGCTGACCCTGTGTGGCTCCAACTTCTACCTTCACCCTTCTGGTCTGGTGCCTGAGGGAACCCATCAGGTCACTGTGGGCCAAAGTCCCTGCCGGCCACTGCCCAAGGACAGCTCAAAACTCAGACCAGTGCCCCGGAAAGACTTTGTAGAGGAGTTTGAGTGTGAACTGGAGCCCTTGGGCACCCAGGCAGTGGGGCCTACCAACGTCAGCCTCACCGTGACTAACATGCCACCGGGCAAGCACTTCCGGGTAGACGGCACCTCCGTGCTGAGAGGCTTCTCTTTCATGGAGCCAGTGCTGATAGCAGTGCAACCCCTCTTTGGCCCACGGGCAGGAGGCACCTGTCTCACTCTTGAAGGCCAGAGTCTGTCTGTAGGCACCAGCCGGGCTGTGCTGGTCAATGGGACTGAGTGTCTGCTAGCACGGGTCAGTGAGGGGCAGCTTTTATGTGCCACACCCCCTGGGGCCACGGTGGCCAGTGTCCCCCTTAGCCTGCAGGTGGGGGGTGCCCAGGTACCTGGTTCCTGGACCTTCCAGTACAGAGAAGACCCTGTCGTGCTAAGCATCAGCCCCAACTGTGGCTACATCAACTCCCACATCACCATCTGTGGCCAGCATCTAACTTCAGCATGGCACTTAGTGCTGTCATTCCATGACGGGCTTAGGGCAGTGGAAAGCAGGTGTGAGAGGCAGCTTCCAGAGCAGCAGCTGTGCCGCCTTCCTGAATATGTGGTCCGAGACCCCCAGGGATGGGTGGCAGGGAATCTGAGTGCCCGAGGGGATGGAGCTGCTGGCTTTACACTGCCTGGCTTTCGCTTCCTACCCCCACCCCATCCACCCAGTGCCAACCTAGTTCCACTGAAGCCTGAGGAGCATGCCATTAAGTTTGAGGTCTGCGTAGATGGTGAATGTCATATCCTGGGTAGAGTGGTGCGGCCAGGGCCAGATGGGGTCCCACAGAGCACGCTCCTTGGTATCCTGCTGCCTTTGCTGCTGCTTGTGGCTGCACTGGCGACTGCACTGGTCTTCAGCTACTGGTGGCGGAGGAAGCAGCTAGTTCTTCCTCCCAACCTGAATGACCTGGCATCCCTGGACCAGACTGCTGGAGCCACACCCCTGCCTATTCTGTACTCGGGCTCTGACTACAGAAGTGGCCTTGCACTCCCTGCCATTGATGGTCTGGATTCCACCACTTGTGTCCATGGAGCATCCTTCTCCGATAGTGAAGATGAATCCTGTGTGCCACTGCTGCGGAAAGAGTCCATCCAGCTAAGGGACCTGGACTCTGCGCTCTTGGCTGAGGTCAAGGATGTGCTGATTCCCCATGAGCGGGTGGTCACCCACAGTGACCGAGTCATTGGCAAAGGCCACTTTGGAGTTGTCTACCACGGAGAATACATAGACCAGGCCCAGAATCGAATCCAATGTGCCATCAAGTCACTAAGTCGCATCACAGAGATGCAGCAGGTGGAGGCCTTCCTGCGAGAGGGGCTGCTCATGCGTGGCCTGAACCACCCGAATGTGCTGGCTCTCATTGGTATCATGTTGCCACCTGAGGGCCTGCCCCATGTGCTGCTGCCCTATATGTGCCACGGTGACCTGCTCCAGTTCATCCGCTCACCTCAGCGGAACCCCACCGTGAAGGACCTCATCAGCTTTGGCCTGCAGGTAGCCCGCGGCATGGAGTACCTGGCAGAGCAGAAGTTTGTGCACAGGGACCTGGCTGCGCGGAACTGCATGCTGGACGAGTCATTCACAGTCAAGGTGGCTGACTTTGGTTTGGCCCGCGACATCCTGGACAGGGAGTACTATAGTGTTCAACAGCATCGCCACGCTCGCCTACCTGTGAAGTGGATGGCGCTGGAGAGCCTGCAGACCTATAGATTTACCACCAAGTCTGATGTGTGGTCATTTGGTGTGCTGCTGTGGGAACTGCTGACACGGGGTGCCCCACCATACCGCCACATTGACCCTTTTGACCTTACCCACTTCCTGGCCCAGGGTCGGCGCCTGCCCCAGCCTGAGTATTGCCCTGATTCTCTGTACCAAGTGATGCAGCAATGCTGGGAGGCAGACCCAGCAGTGCGACCCACCTTCAGAGTACTAGTGGGGGAGGTGGAGCAGATAGTGTCTGCACTGCTTGGGGACCATTATGTGCAGCTGCCAGCAACCTACATGAACTTGGGCCCCAGCACCTCGCATGAGATGAATGTGCGTCCAGAACAGCCGCAGTTCTCACCCATGCCAGGGAATGTACGCCGGCCCCGGCCACTCTCAGAGCCTCCTCGGCCCACTTGACTTAGTTCTTGGGCTGGACCTGCTTAGCTGCCTTGAGCTAACCCCAAGCTGCCTCTGGGCCATGCCAGGCCAGAGGGCAGTGGCCCTCCACCTTGTTCCTGCCCTTTAACTTTCAGAGGCAATAGGTAAATGGGGCCCATTAGGTCCCTCACTCCACAGAGTGAGCCAGTGAGGGCAGTCCTGCAACATGTATTTATGGAGTGCCTGCTGTGGACCCTGTCTTCTGGGCACAGTGGACTCAGCAGTGACCACACCAACACTGACCCTTGAACCAATAAAGGAACAAATGACTATTAAAGCACAAAAAAAAAAAAAAAA";
            
                if (cdna != expected) throw new InvalidDataException("NM_001278433.1 is still not right.");
            }
            if (id.WithVersion == "NM_001278433.1")
            {
                var newRegions = new List<ITranscriptRegion>();
                var newRnaEdits = new IRnaEdit[] 
                {
                    new RnaEdit(1,0,"GAGCTGTGGTGGGCTCCACCCAGTTCGAGCTTCCCGGCTGCTTTGGTTACCTAATCAAGCCTGGGCAATGGCAGGCGCCCCTCCCCCAGCCTCGCTGCCGCCTTGCAGTTTGATCTCAGACTGCTGTGCTAGCAATCAGCGAGACTCCGTGGGCGTAGGACCCTCCGAGC"),
                    new RnaEdit(4138,4137,"AAAAAAAAAAAAAAAAAAAAA"),
                };
                
                foreach (var region in transcriptRegions)
                {
                    var cdnaStart = region.CdnaStart + HgvsUtilities.GetRnaEditOffset(region.CdnaStart, newRnaEdits);
                    var cdnaEnd = region.CdnaEnd + HgvsUtilities.GetRnaEditOffset(region.CdnaEnd, newRnaEdits);
                    
                    newRegions.Add(new TranscriptRegion(region.Type, region.Id, region.Start, region.End, cdnaStart, cdnaEnd));
                }
                
                transcriptRegions = newRegions.ToArray();
                rnaEdits = newRnaEdits;
                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "GAGCTGTGGTGGGCTCCACCCAGTTCGAGCTTCCCGGCTGCTTTGGTTACCTAATCAAGCCTGGGCAATGGCAGGCGCCCCTCCCCCAGCCTCGCTGCCGCCTTGCAGTTTGATCTCAGACTGCTGTGCTAGCAATCAGCGAGACTCCGTGGGCGTAGGACCCTCCGAGCCAGAGAACCATGGAGTCTGGCAGTACCGCCGCCAGTGAGGAGGCACGCAGCCTTCGAGAATGTGAGCTCTACGTCCAGAAGCATAACATTCAAGCGCTGCTCAAAGATTCTATTGTGCAGTTGTGCACTGCTCGACCTGAGAGACCCATGGCATTCCTCAGGGAATACTTTGAGAGGTTGGAGAAGGAGGAGGCAAAACAGATTCAGAATCTGCAGAAAGCAGGCACTCGTACAGACTCAAGGGAGGATGAGATTTCTCCTCCTCCACCCAACCCAGTGGTTAAAGGTAGGAGGCGACGAGGTGCTATCAGCGCTGAGGTCTACACGGAGGAAGATGCGGCATCCTATGTTAGAAAGGTTATACCAAAAGATTACAAGACAATGGCCGCTTTAGCCAAAGCCATTGAAAAGAATGTGCTGTTTTCACATCTTGATGATAATGAGAGAAGTGATATTTTTGATGCCATGTTTTCGGTCTCCTTTATCGCAGGAGAGACTGTGATTCAGCAAGGTGATGAAGGGGATAACTTCTATGTGATTGATCAAGGAGAGACGGATGTCTATGTTAACAATGAATGGGCAACCAGTGTTGGGGAAGGAGGGAGCTTTGGAGAACTTGCTTTGATTTATGGAACACCGAGAGCAGCCACTGTCAAAGCAAAGACAAATGTGAAATTGTGGGGCATCGACCGAGACAGCTATAGAAGAATCCTCATGGGAAGCACACTGAGAAAGCGGAAGATGTATGAGGAATTCCTTAGTAAAGTCTCTATTTTAGAGTCTCTGGACAAGTGGGAACGTCTTACGGTAGCTGATGCATTGGAACCAGTGCAGTTTGAAGATGGGCAGAAGATTGTGGTGCAGGGAGAACCAGGGGATGAGTTCTTCATTATTTTAGAGGGGTCAGCTGCTGTGCTACAACGTCGGTCAGAAAATGAAGAGTTTGTTGAAGTGGGAAGATTGGGGCCTTCTGATTATTTTGGTGAAATTGCACTACTGATGAATCGTCCTCGTGCTGCCACAGTTGTTGCTCGTGGCCCCTTGAAGTGCGTTAAGCTGGACCGACCTAGATTTGAACGTGTTCTTGGCCCATGCTCAGACATCCTCAAACGAAACATCCAGCAGTACAACAGTTTTGTGTCACTGTCTGTCTGAAATCTGCCTCCTGTGCCTCCCTTTTCTCCTCTCCCCAATCCATGCTTCACTCATGCAAACTGCTTTATTTTCCCTACTTGCAGCGCCAAGTGGCCACTGGCATCGCAGCTTCCTGTCTGTTTATATATTGAAAGTTGCTTTTATTGCACCATTTTCAATTTGGAGCATTAACTAAATGCTCATACACAGTTAAATAAATAGAAAGAGTTCTATGGAGACTTTGCTGTTACTGCTTCTCTTTGTGCAGTGTTAGTATTCACCCTGGGCAGTGAGTGCCATGCTTTTTGGTGAGGGCAGATCCCAGCACCTATTGAATTACCATAGAGTAATGATGTAACAGTGCAAGATTTTTTTTTTAAGTGACATAATTGTCCAGTTATAAGCGTATTTAGACTGTGGCCATATATGCTGTATTTCTTTGTAGAATAAATGGTTTCTCATTAAACTCTAAAGATTAGGGAAAATGGATATAGAAAATCTTAGTATAGTAGAAAGACATCTGCCTGTAATTAAACTAGTTTAAGGGTGGAAAAATGCCCATTTTTGCTAATTATCAATGGGATATGATTGGTTCAGTTTTTTTTTTTCCAGAGTTGTTGTTTGCCAAGCTAATCTGCCTGGTTTTATTTATATCTTGTTATTAATGTTTCTTCTCCAATTCTGAAATACTTTTGAGTATGGCTATCTATACCTGCCTTTTAAGTTTGAAACTAACTCATAGATTGCAAATATTGGTTAGTATTTAACTACATCTGCCTCGGCTCACAAATTCCGATTAGACCTTTATCCAGCTAGTGCCAAATAATTGATCAGATGCTGAATTGAGAATAAGAATTTGAGGTCTACATTCTTGGTTGTTAATTTAGAGCGTTTGGTTAAAGTATGTCCTTCAGCTGACTCCAGTATAATCTCCTCTGCTCATTAAACTGATTCCAGGAGATTGGATTTGCTGTGACTAGATACAGATGGAGCAAATGTCCTAACAGAGAAATAGAGGTGATGCTGCTAAAGGGAGAAATGCCAGGCGGACAAAGTTCAGTGTCGGGAATTTTCCCCGTGACATTCACTGGGGCATGAGATTTTGGAAGAAGTTTTTTACTTTGGTTTAGTCTTTTTTTCCTTCCTTTTTATTCAGCTAGAATTTCTGGTGGGTTGATGGTAGGGTATAATGTGTCTGTGTTGCTTCAAATTGGTCTGAAAGGCTATCCTGCTGAAAGTCCTGCTTTCCTATCTAGCATTTATTTCTCTGGCAAACTTTTCTTTCTTTTCTTTTTTAAAGTAAACTTGTGTATTGAGTCTTAACTGTATTTCAGTATTTTCCAGCCTTATGTGTTACATTATTCCAATGATACCCAACAGTTTATTTTTATTATTTTTTTAAACAAAATTTCACAGTTCTGTAATGTAGGCACTTTTATTTTCATTGTGATTTATATATAAGGTAATGTAGGGTTATATTTGGGAGTGACTGCAAGCATTTTTCCATCTGTGTGCAACTAACTGACTCTGTTATTGATCCCTTCTCCTGCCCTTTCCCAGGTAATTTAAATTGGTCATGGTAGATTTTTTTCATAGATTTGAAAAACTTTTAGGTTGTTACCAAGTATGAAGTATAAATCTGGGGAAGAGGTTTTATTTACATTTTAGGGTGGGTAAGAAAGCCACCTTGTTACAAATTTTTTAATTTCCAAAATAATCTATATTAAATGAGGGTTTCTGATCTGTACTTTGTGTTTAGCTACCTTTTTATATTTAAAAAATTAAAAATGAAAATTACGTTCTTACAAGCTTAAAGCTTGATTTGATCTTTGTTTAAATGCCAAAATGTACTTAAATGAGTTACTTAGAATGCCATAAAATTGCAGTTTCATGTATGTATATAATCATGCTCATGTATATTTAGTTACGTATAATGCTTTCTGAGTGAGTTTTACTCTTAAATCATTTGGTTAAATCATTTGGCTTGCTGTTTACTCCCTTCTGTAGTTTTTAATTAAAAACTTTAAAGATAAGTCTACATTAAACAATGATCACATCTAAAGCTTTATCTTTGTGTAATCTAAGTATATGTGAGAAATCAGAATTGGCATAATTTGTCTTAGTTGATATTCAAGGCTTTAAAAGTCATTATTCCTGGGCTTGGTAAGTGAATTTATGAGATTTACTGCTCTAGAAAGTATAGATGGCCAAAGGACCGTTTTGTATTGCTTCCTGATTACCAGTCTGATTATACCATGTGTGCTAATATACTTTTTTTGTTATAGATTGTCTTAATGGTAGGTCAAGTAATAAAAAGAGATGAAATAATTTAAATTCTTAAATGAATCAGTTTTTCTTCCCTTTCTCCTTTCCGTCTTTCCTCTCTCTGTCCTTCCCCGAAAGTCTACTCGGGTGGGCAAAAATGAAAAGGGGGAAAGTGAATTATGGGATCGGTGTTTTGAAAGAGCAATGTTTATTTTCAGTGCTTTTCAGTTTGTCAAAGAGTGGATCTCAAAATCTTGCTTAAAGGGTAATTGAGATGTAGCAGATTTATTTACTTAGTCATGGAAAGAAAAAAATTCAGTCAAAAGCTAAAGATTTCCTTTTGATTGAAGACAGATTGGTTCTGTGGCCTTGGAACTTTCCCAGACTTAATGGGGAAACATCATTTCTAGATTAGCATACTCTTTGGTTTAAATTTAATATATACATTTAATGTTACTTAGGGATACTTTTATATTTTGCATATATAAAGCCTCATATATAAAGCCTTATTTCTGATGCTCTTAGATTTCTGAGGAGTGAGATGATTAAGTTGTATTCATTAGTGTATTGGTATTTCTTCACATCCAGTGAAATTGGAGATATGTTGTATGTTAGAAGAGCATTCTTTAAATTGTGTTGCTTTGAACATGTGTACCTTTTCTAGATTCAGTAATCCCTTCCCCCCGTCCTCTGGAGTATGAAACCTTTAGAGTCACAATAAAATGTAACTAAAGAAAAAAAAAAAAAAAAAAAAAAAAA";
            
                if (cdna != expected) throw new InvalidDataException("NM_001278433.1 is still not right.");
            }
            if (id.WithVersion == "NM_001260.1")
            {
                var newRegions = new List<ITranscriptRegion>();
                var newRnaEdits = new IRnaEdit[] 
                {
                    new RnaEdit(1,0,"GGG"), 
                };

                foreach (var region in transcriptRegions)
                {
                    var cdnaStart = region.CdnaStart + HgvsUtilities.GetRnaEditOffset(region.CdnaStart, newRnaEdits);
                    var cdnaEnd = region.CdnaEnd + HgvsUtilities.GetRnaEditOffset(region.CdnaEnd, newRnaEdits);
                    
                    newRegions.Add(new TranscriptRegion(region.Type, region.Id, region.Start, region.End, cdnaStart, cdnaEnd));
                }

                transcriptRegions = newRegions.ToArray();
                
                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, newRnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "GGGCTCCGGCCTCAGAGGCTGTGACAATGGACTATGACTTTAAAGTGAAGCTGAGCAGCGAGCGGGAGCGGGTCGAGGACCTGTTTGAATACGAGGGCTGCAAAGTTGGCCGAGGCACTTATGGTCACGTCTACAAAGCCAAGAGGAAAGATGGGAAGGATGATAAAGACTATGCTTTAAAACAAATAGAAGGAACTGGGATCTCTATGTCGGCATGTAGAGAAATAGCATTACTTCGAGAGCTTAAGCATCCAAACGTCATTTCTCTTCAAAAGGTGTTTCTGTCTCATGCTGATAGGAAGGTGTGGCTTCTGTTTGACTATGCTGAACATGACCTCTGGCATATAATCAAGTTTCACAGAGCTTCTAAAGCAAACAAGAAGCCAGTTCAGTTACCTCGGGGAATGGTGAAGTCACTATTATATCAGATCCTAGATGGTATTCACTACCTGCATGCTAACTGGGTGTTGCACAGAGATTTGAAACCTGCTAATATTTTAGTTATGGGTGAAGGTCCTGAGCGAGGAAGAGTAAAAATTGCTGACATGGGCTTTGCCCGATTATTTAATTCACCTTTGAAGCCTTTAGCAGATTTGGATCCAGTGGTTGTTACATTCTGGTACCGAGCCCCTGAACTACTTCTTGGAGCAAGGCATTATACCAAAGCTATTGATATTTGGGCTATAGGGTGTATATTTGCAGAACTACTAACGTCAGAACCAATATTTCACTGTCGACAAGAGGACATCAAAACTAGTAATCCTTATCACCATGACCAGCTGGACAGAATATTCAATGTAATGGGATTTCCTGCAGATAAAGATTGGGAAGATATAAAAAAGATGCCTGAACATTCAACATTAATGAAAGATTTCAGAAGAAATACGTATACCAACTGCAGCCTTATCAAGTATATGGAAAAACATAAAGTTAAACCAGATAGTAAAGCATTCCACTTGCTTCAGAAGCTGCTTACCATGGACCCAATAAAGCGAATTACCTCAGAACAGGCTATGCAGGACCCCTATTTCTTAGAAGACCCACTTCCTACATCAGACGTTTTTGCCGGTTGTCAAATCCCTTACCCAAAACGAGAATTTTTAACGGAAGAAGAACCTGATGACAAAGGAGACAAAAAGAACCAGCAGCAGCAGCAGGGCAATAACCACACTAATGGAACTGGCCACCCAGGGAATCAAGACAGCAGTCACACACAGGGACCCCCGTTGAAGAAAGTGAGAGTTGTTCCTCCTACCACTACCTCAGGTGGACTTATCATGACCTCAGACTATCAGCGTTCCAATCCACATGCTGCCTATCCCAACCCTGGACCAAGCACATCACAGCCGCAGAGCAGCATGGGATACTCAGCTACCTCCCAGCAGCCTCCACAGTACTCACATCAGACACATCGGTACTGAGCTGCATCGGAATCTTGTCCATGCACTGTTGCGAATGCTGCAGGGCTGACTGTGCAGCTCTCTGCGGGAACCTGGTATGGGCCATGAGAATGTACTGTACAACCACATCTTCAAAATGTCCAGTAGCCAAGTTCCACCACTTTTCACAGATTGGGGTAGTGGCTTCCAAGTTGTACCTATTTTGGAGTTAGACTTGAAAAGAAAGTGCTAGCACAGTTTGTGTTGTGGATTTGCTACTTCCATAGTTTACTTGACATGGTTCAGACTGACCAATGCATTTTTTTCAGTGACAGTCTGTAGCAGTTGAAGCTGTGAATGTGCTAGGGGCAAGCATTTGTCTTTGTATGTGGT";
            
                if (cdna != expected) throw new InvalidDataException("NM_001260.1 is still not right.");
            }

            if (id.WithVersion == "NM_000314.4")
            {
                var newRegions = new List<ITranscriptRegion>();

                var oldExon = transcriptRegions[0];
                var exon1a = new TranscriptRegion(TranscriptRegionType.Exon, 1, oldExon.Start, 89623860,
                    oldExon.CdnaStart, 666);
                var gap1 = new TranscriptRegion(TranscriptRegionType.Gap, 1, 89623861, 89623861, 666, 667);
                var exon1b = new TranscriptRegion(TranscriptRegionType.Exon, 1, 89623862, oldExon.End, 667,
                    oldExon.CdnaEnd - 1);

                newRegions.Add(exon1a);
                newRegions.Add(gap1);
                newRegions.Add(exon1b);
 
                for (int i = 1; i < transcriptRegions.Length; i++)
                {
                    var region = transcriptRegions[i];
                    newRegions.Add(new TranscriptRegion(region.Type, region.Id, region.Start, region.End,
                        region.CdnaStart - 1, region.CdnaEnd - 1));
                }

                transcriptRegions = newRegions.ToArray();
                
                rnaEdits    = new IRnaEdit[3];
                rnaEdits[0] = new RnaEdit(667,  667, null);
                rnaEdits[1] = new RnaEdit(707,  707, "C");
                rnaEdits[2] = new RnaEdit(5548, 5547, "AAAAAAAAAAAAAAAAAAAAAAAAAA");

                var oldCodingRegion = translation.CodingRegion;
                var codingRegion    = new CodingRegion(oldCodingRegion.Start, oldCodingRegion.End, 1032, 2243, 1212);
                translation = new Translation(codingRegion, (CompactId) translation.ProteinId, translation.PeptideSeq);
                
                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "CCTCCCCTCGCCCGGCGCGGTCCCGTCCGCCTCTCGCTCGCCTCCCGCCTCCCCTCGGTCTTCCGAGGCGCCCGGGCTCCCGGCGCGGCGGCGGAGGGGGCGGGCAGGCCGGCGGGCGGTGATGTGGCGGGACTCTTTATGCGCTGCGGCAGGATACGCGCTCGGCGCTGGGACGCGACTGCGCTCAGTTCTCTCCTCTCGGAAGCTGCAGCCATGATGGAAGTTTGAGAGTTGAGCCGCTGTGAGGCGAGGCCGGGCTCAGGCGAGGGAGATGAGAGACGGCGGCGGCCGCGGCCCGGAGCCCCTCTCAGCGCCTGTGAGCAGCCGCGGGGGCAGCGCCCTCGGGGAGCCGGCCGGCCTGCGGCGGCGGCAGCGGCGGCGTTTCTCGCCTCCTCTTCGTCTTTTCTAACCGTGCAGCCTCTTCCTCGGCTTCTCCTGAAAGGGAAGGTGGAAGCCGTGGGCTCGGGCGGGAGCCGGCTGAGGCGCGGCGGCGGCGGCGGCACCTCCCGCTCCTGGAGCGGGGGGGAGAAGCGGCGGCGGCGGCGGCCGCGGCGGCTGCAGCTCCAGGGAGGGGGTCTGAGTCGCCTGTCACCATTTCCAGGGCTGGGAACGCCGGAGAGTTGGTCTCTCCCCTTCTACTGCCTCCAACACGGCGGCGGCGGCGGCGGCACATCCAGGGACCCGGGCCGGTTTTAAACCTCCCGTCCGCCGCCGCCGCACCCCCCGTGGCCCGGGCTCCGGAGGCCGCCGGCGGAGGCAGCCGTTCGGAGGATTATTCGTCTTCTCCCCATTCCGCTGCCGCCGCTGCCAGGCCTCTGGCTGCTGAGGAGAAGCAGGCCCAGTCGCTGCAACCATCCAGCAGCCGCCGCAGCAGCCATTACCCGGCTGCGGTCCAGAGCCAAGCGGCGGCAGAGCGAGGGGCATCAGCTACCGCCAAGTCCAGAGCCATTTCCATCCTGCAGAAGAAGCCCCGCCACCAGCAGCTTCTGCCATCTCTCTCCTCCTTTTTCTTCAGCCACAGGCTCCCAGACATGACAGCCATCATCAAAGAGATCGTTAGCAGAAACAAAAGGAGATATCAAGAGGATGGATTCGACTTAGACTTGACCTATATTTATCCAAACATTATTGCTATGGGATTTCCTGCAGAAAGACTTGAAGGCGTATACAGGAACAATATTGATGATGTAGTAAGGTTTTTGGATTCAAAGCATAAAAACCATTACAAGATATACAATCTTTGTGCTGAAAGACATTATGACACCGCCAAATTTAATTGCAGAGTTGCACAATATCCTTTTGAAGACCATAACCCACCACAGCTAGAACTTATCAAACCCTTTTGTGAAGATCTTGACCAATGGCTAAGTGAAGATGACAATCATGTTGCAGCAATTCACTGTAAAGCTGGAAAGGGACGAACTGGTGTAATGATATGTGCATATTTATTACATCGGGGCAAATTTTTAAAGGCACAAGAGGCCCTAGATTTCTATGGGGAAGTAAGGACCAGAGACAAAAAGGGAGTAACTATTCCCAGTCAGAGGCGCTATGTGTATTATTATAGCTACCTGTTAAAGAATCATCTGGATTATAGACCAGTGGCACTGTTGTTTCACAAGATGATGTTTGAAACTATTCCAATGTTCAGTGGCGGAACTTGCAATCCTCAGTTTGTGGTCTGCCAGCTAAAGGTGAAGATATATTCCTCCAATTCAGGACCCACACGACGGGAAGACAAGTTCATGTACTTTGAGTTCCCTCAGCCGTTACCTGTGTGTGGTGATATCAAAGTAGAGTTCTTCCACAAACAGAACAAGATGCTAAAAAAGGACAAAATGTTTCACTTTTGGGTAAATACATTCTTCATACCAGGACCAGAGGAAACCTCAGAAAAAGTAGAAAATGGAAGTCTATGTGATCAAGAAATCGATAGCATTTGCAGTATAGAGCGTGCAGATAATGACAAGGAATATCTAGTACTTACTTTAACAAAAAATGATCTTGACAAAGCAAATAAAGACAAAGCCAACCGATACTTTTCTCCAAATTTTAAGGTGAAGCTGTACTTCACAAAAACAGTAGAGGAGCCGTCAAATCCAGAGGCTAGCAGTTCAACTTCTGTAACACCAGATGTTAGTGACAATGAACCTGATCATTATAGATATTCTGACACCACTGACTCTGATCCAGAGAATGAACCTTTTGATGAAGATCAGCATACACAAATTACAAAAGTCTGAATTTTTTTTTATCAAGAGGGATAAAACACCATGAAAATAAACTTGAATAAACTGAAAATGGACCTTTTTTTTTTTAATGGCAATAGGACATTGTGTCAGATTACCAGTTATAGGAACAATTCTCTTTTCCTGACCAATCTTGTTTTACCCTATACATCCACAGGGTTTTGACACTTGTTGTCCAGTTGAAAAAAGGTTGTGTAGCTGTGTCATGTATATACCTTTTTGTGTCAAAAGGACATTTAAAATTCAATTAGGATTAATAAAGATGGCACTTTCCCGTTTTATTCCAGTTTTATAAAAAGTGGAGACAGACTGATGTGTATACGTAGGAATTTTTTCCTTTTGTGTTCTGTCACCAACTGAAGTGGCTAAAGAGCTTTGTGATATACTGGTTCACATCCTACCCCTTTGCACTTGTGGCAACAGATAAGTTTGCAGTTGGCTAAGAGAGGTTTCCGAAGGGTTTTGCTACATTCTAATGCATGTATTCGGGTTAGGGGAATGGAGGGAATGCTCAGAAAGGAAATAATTTTATGCTGGACTCTGGACCATATACCATCTCCAGCTATTTACACACACCTTTCTTTAGCATGCTACAGTTATTAATCTGGACATTCGAGGAATTGGCCGCTGTCACTGCTTGTTGTTTGCGCATTTTTTTTTAAAGCATATTGGTGCTAGAAAAGGCAGCTAAAGGAAGTGAATCTGTATTGGGGTACAGGAATGAACCTTCTGCAACATCTTAAGATCCACAAATGAAGGGATATAAAAATAATGTCATAGGTAAGAAACACAGCAACAATGACTTAACCATATAAATGTGGAGGCTATCAACAAAGAATGGGCTTGAAACATTATAAAAATTGACAATGATTTATTAAATATGTTTTCTCAATTGTAACGACTTCTCCATCTCCTGTGTAATCAAGGCCAGTGCTAAAATTCAGATGCTGTTAGTACCTACATCAGTCAACAACTTACACTTATTTTACTAGTTTTCAATCATAATACCTGCTGTGGATGCTTCATGTGCTGCCTGCAAGCTTCTTTTTTCTCATTAAATATAAAATATTTTGTAATGCTGCACAGAAATTTTCAATTTGAGATTCTACAGTAAGCGTTTTTTTTCTTTGAAGATTTATGATGCACTTATTCAATAGCTGTCAGCCGTTCCACCCTTTTGACCTTACACATTCTATTACAATGAATTTTGCAGTTTTGCACATTTTTTAAATGTCATTAACTGTTAGGGAATTTTACTTGAATACTGAATACATATAATGTTTATATTAAAAAGGACATTTGTGTTAAAAAGGAAATTAGAGTTGCAGTAAACTTTCAATGCTGCACACAAAAAAAAGACATTTGATTTTTCAGTAGAAATTGTCCTACATGTGCTTTATTGATTTGCTATTGAAAGAATAGGGTTTTTTTTTTTTTTTTTTTTTTTTTTTTTAAATGTGCAGTGTTGAATCATTTCTTCATAGTGCTCCCCCGAGTTGGGACTAGGGCTTCAATTTCACTTCTTAAAAAAAATCATCATATATTTGATATGCCCAGACTGCATACGATTTTAAGCGGAGTACAACTACTATTGTAAAGCTAATGTGAAGATATTATTAAAAAGGTTTTTTTTTCCAGAAATTTGGTGTCTTCAAATTATACCTTCACCTTGACATTTGAATATCCAGCCATTTTGTTTCTTAATGGTATAAAATTCCATTTTCAATAACTTATTGGTGCTGAAATTGTTCACTAGCTGTGGTCTGACCTAGTTAATTTACAAATACAGATTGAATAGGACCTACTAGAGCAGCATTTATAGAGTTTGATGGCAAATAGATTAGGCAGAACTTCATCTAAAATATTCTTAGTAAATAATGTTGACACGTTTTCCATACCTTGTCAGTTTCATTCAACAATTTTTAAATTTTTAACAAAGCTCTTAGGATTTACACATTTATATTTAAACATTGATATATAGAGTATTGATTGATTGCTCATAAGTTAAATTGGTAAAGTTAGAGACAACTATTCTAACACCTCACCATTGAAATTTATATGCCACCTTGTCTTTCATAAAAGCTGAAAATTGTTACCTAAAATGAAAATCAACTTCATGTTTTGAAGATAGTTATAAATATTGTTCTTTGTTACAATTTCGGGCACCGCATATTAAAACGTAACTTTATTGTTCCAATATGTAACATGGAGGGCCAGGTCATAAATAATGACATTATAATGGGCTTTTGCACTGTTATTATTTTTCCTTTGGAATGTGAAGGTCTGAATGAGGGTTTTGATTTTGAATGTTTCAATGTTTTTGAGAAGCCTTGCTTACATTTTATGGTGTAGTCATTGGAAATGGAAAAATGGCATTATATATATTATATATATAAATATATATTATACATACTCTCCTTACTTTATTTCAGTTACCATCCCCATAGAATTTGACAAGAATTGCTATGACTGAAAGGTTTTCGAGTCCTAATTAAAACTTTATTTATGGCAGTATTCATAATTAGCCTGAAATGCATTCTGTAGGTAATCTCTGAGTTTCTGGAATATTTTCTTAGACTTTTTGGATGTGCAGCAGCTTACATGTCTGAAGTTACTTGAAGGCATCACTTTTAAGAAAGCTTACAGTTGGGCCCTGTACCATCCCAAGTCCTTTGTAGCTCCTCTTGAACATGTTTGCCATACTTTTAAAAGGGTAGTTGAATAAATAGCATCACCATTCTTTGCTGTGGCACAGGTTATAAACTTAAGTGGAGTTTACCGGCAGCATCAAATGTTTCAGCTTTAAAAAATAAAAGTAGGGTACAAGTTTAATGTTTAGTTCTAGAAATTTTGTGCAATATGTTCATAACGATGGCTGTGGTTGCCACAAAGTGCCTCGTTTACCTTTAAATACTGTTAATGTGTCATGCATGCAGATGGAAGGGGTGGAACTGTGCACTAAAGTGGGGGCTTTAACTGTAGTATTTGGCAGAGTTGCCTTCTACCTGCCAGTTCAAAAGTTCAACCTGTTTTCATATAGAATATATATACTAAAAAATTTCAGTCTGTTAAACAGCCTTACTCTGATTCAGCCTCTTCAGATACTCTTGTGCTGTGCAGCAGTGGCTCTGTGTGTAAATGCTATGCACTGAGGATACACAAAAATACCAATATGATGTGTACAGGATAATGCCTCATCCCAATCAGATGTCCATTTGTTATTGTGTTTGTTAACAACCCTTTATCTCTTAGTGTTATAAACTCCACTTAAAACTGATTAAAGTCTCATTCTTGTCAAAAAAAAAAAAAAAAAAAAAAAAAAA";
            
                if (cdna != expected) throw new InvalidDataException("NM_000314.4 is still not right.");
            }

            if (id.WithVersion == "NM_000535.5")
            {
                rnaEdits    = new IRnaEdit[2];
                rnaEdits[0] = new RnaEdit(1708, 1708, "G");
                rnaEdits[1] = new RnaEdit(2837, 2836, "AAAAAAAAAAAAAAA");
                
                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "AGCCAATGGGAGTTCAGGAGGCGGAGCGCCTGTGGGAGCCCTGGAGGGAACTTTCCCAGTCCCCGAGGCGGATCGGGTGTTGCATCCATGGAGCGAGCTGAGAGCTCGAGTACAGAACCTGCTAAGGCCATCAAACCTATTGATCGGAAGTCAGTCCATCAGATTTGCTCTGGGCAGGTGGTACTGAGTCTAAGCACTGCGGTAAAGGAGTTAGTAGAAAACAGTCTGGATGCTGGTGCCACTAATATTGATCTAAAGCTTAAGGACTATGGAGTGGATCTTATTGAAGTTTCAGACAATGGATGTGGGGTAGAAGAAGAAAACTTCGAAGGCTTAACTCTGAAACATCACACATCTAAGATTCAAGAGTTTGCCGACCTAACTCAGGTTGAAACTTTTGGCTTTCGGGGGGAAGCTCTGAGCTCACTTTGTGCACTGAGCGATGTCACCATTTCTACCTGCCACGCATCGGCGAAGGTTGGAACTCGACTGATGTTTGATCACAATGGGAAAATTATCCAGAAAACCCCCTACCCCCGCCCCAGAGGGACCACAGTCAGCGTGCAGCAGTTATTTTCCACACTACCTGTGCGCCATAAGGAATTTCAAAGGAATATTAAGAAGGAGTATGCCAAAATGGTCCAGGTCTTACATGCATACTGTATCATTTCAGCAGGCATCCGTGTAAGTTGCACCAATCAGCTTGGACAAGGAAAACGACAGCCTGTGGTATGCACAGGTGGAAGCCCCAGCATAAAGGAAAATATCGGCTCTGTGTTTGGGCAGAAGCAGTTGCAAAGCCTCATTCCTTTTGTTCAGCTGCCCCCTAGTGACTCCGTGTGTGAAGAGTACGGTTTGAGCTGTTCCGATGCTCTGCATAATCTTTTTTACATCTCAGGTTTCATTTCACAATGCACGCATGGAGTTGGAAGGAGTTCAACAGACAGACAGTTTTTCTTTATCAACCGGCGGCCTTGTGACCCAGCAAAGGTCTGCAGACTCGTGAATGAGGTCTACCACATGTATAATCGACACCAGTATCCATTTGTTGTTCTTAACATTTCTGTTGATTCAGAATGCGTTGATATCAATGTTACTCCAGATAAAAGGCAAATTTTGCTACAAGAGGAAAAGCTTTTGTTGGCAGTTTTAAAGACCTCTTTGATAGGAATGTTTGATAGTGATGTCAACAAGCTAAATGTCAGTCAGCAGCCACTGCTGGATGTTGAAGGTAACTTAATAAAAATGCATGCAGCGGATTTGGAAAAGCCCATGGTAGAAAAGCAGGATCAATCCCCTTCATTAAGGACTGGAGAAGAAAAAAAAGACGTGTCCATTTCCAGACTGCGAGAGGCCTTTTCTCTTCGTCACACAACAGAGAACAAGCCTCACAGCCCAAAGACTCCAGAACCAAGAAGGAGCCCTCTAGGACAGAAAAGGGGTATGCTGTCTTCTAGCACTTCAGGTGCCATCTCTGACAAAGGCGTCCTGAGACCTCAGAAAGAGGCAGTGAGTTCCAGTCACGGACCCAGTGACCCTACGGACAGAGCGGAGGTGGAGAAGGACTCGGGGCACGGCAGCACTTCCGTGGATTCTGAGGGGTTCAGCATCCCAGACACGGGCAGTCACTGCAGCAGCGAGTATGCGGCCAGCTCCCCAGGGGACAGGGGCTCGCAGGAACATGTGGACTCTCAGGAGAAAGCGCCTGAAACTGACGACTCTTTTTCAGATGTGGACTGCCATTCAAACCAGGAAGATACCGGATGTAAATTTCGAGTTTTGCCTCAGCCAACTAATCTCGCAACCCCAAACACAAAGCGTTTTAAAAAAGAAGAAATTCTTTCCAGTTCTGACATTTGTCAAAAGTTAGTAAATACTCAGGACATGTCAGCCTCTCAGGTTGATGTAGCTGTGAAAATTAATAAGAAAGTTGTGCCCCTGGACTTTTCTATGAGTTCTTTAGCTAAACGAATAAAGCAGTTACATCATGAAGCACAGCAAAGTGAAGGGGAACAGAATTACAGGAAGTTTAGGGCAAAGATTTGTCCTGGAGAAAATCAAGCAGCCGAAGATGAACTAAGAAAAGAGATAAGTAAAACGATGTTTGCAGAAATGGAAATCATTGGTCAGTTTAACCTGGGATTTATAATAACCAAACTGAATGAGGATATCTTCATAGTGGACCAGCATGCCACGGACGAGAAGTATAACTTCGAGATGCTGCAGCAGCACACCGTGCTCCAGGGGCAGAGGCTCATAGCACCTCAGACTCTCAACTTAACTGCTGTTAATGAAGCTGTTCTGATAGAAAATCTGGAAATATTTAGAAAGAATGGCTTTGATTTTGTTATCGATGAAAATGCTCCAGTCACTGAAAGGGCTAAACTGATTTCCTTGCCAACTAGTAAAAACTGGACCTTCGGACCCCAGGACGTCGATGAACTGATCTTCATGCTGAGCGACAGCCCTGGGGTCATGTGCCGGCCTTCCCGAGTCAAGCAGATGTTTGCCTCCAGAGCCTGCCGGAAGTCGGTGATGATTGGGACTGCTCTTAACACAAGCGAGATGAAGAAACTGATCACCCACATGGGGGAGATGGACCACCCCTGGAACTGTCCCCATGGAAGGCCAACCATGAGACACATCGCCAACCTGGGTGTCATTTCTCAGAACTGACCGTAGTCACTGTATGGAATAATTGGTTTTATCGCAGATTTTTATGTTTTGAAAGACAGAGTCTTCACTAACCTTTTTTGTTTTAAAATGAACCTGCTACTTAAAAAAAATACACATCACACCCATTTAAAAGTGATCTTGAGAACCTTTTCAAACCAGAAAAAAAAAAAAAAAA";

                if (cdna != expected) throw new InvalidDataException("NM_000535.5 is still not right.");
            }

            if (id.WithVersion == "NM_000545.5")
            {
                rnaEdits    = new IRnaEdit[2];
                rnaEdits[0] = new RnaEdit(1743, 1743, "G");
                rnaEdits[1] = new RnaEdit(3240, 3239, "AA");

                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "CGTGGCCCTGTGGCAGCCGAGCCATGGTTTCTAAACTGAGCCAGCTGCAGACGGAGCTCCTGGCGGCCCTGCTCGAGTCAGGGCTGAGCAAAGAGGCACTGATCCAGGCACTGGGTGAGCCGGGGCCCTACCTCCTGGCTGGAGAAGGCCCCCTGGACAAGGGGGAGTCCTGCGGCGGCGGTCGAGGGGAGCTGGCTGAGCTGCCCAATGGGCTGGGGGAGACTCGGGGCTCCGAGGACGAGACGGACGACGATGGGGAAGACTTCACGCCACCCATCCTCAAAGAGCTGGAGAACCTCAGCCCTGAGGAGGCGGCCCACCAGAAAGCCGTGGTGGAGACCCTTCTGCAGGAGGACCCGTGGCGTGTGGCGAAGATGGTCAAGTCCTACCTGCAGCAGCACAACATCCCACAGCGGGAGGTGGTCGATACCACTGGCCTCAACCAGTCCCACCTGTCCCAACACCTCAACAAGGGCACTCCCATGAAGACGCAGAAGCGGGCCGCCCTGTACACCTGGTACGTCCGCAAGCAGCGAGAGGTGGCGCAGCAGTTCACCCATGCAGGGCAGGGAGGGCTGATTGAAGAGCCCACAGGTGATGAGCTACCAACCAAGAAGGGGCGGAGGAACCGTTTCAAGTGGGGCCCAGCATCCCAGCAGATCCTGTTCCAGGCCTATGAGAGGCAGAAGAACCCTAGCAAGGAGGAGCGAGAGACGCTAGTGGAGGAGTGCAATAGGGCGGAATGCATCCAGAGAGGGGTGTCCCCATCACAGGCACAGGGGCTGGGCTCCAACCTCGTCACGGAGGTGCGTGTCTACAACTGGTTTGCCAACCGGCGCAAAGAAGAAGCCTTCCGGCACAAGCTGGCCATGGACACGTACAGCGGGCCCCCCCCAGGGCCAGGCCCGGGACCTGCGCTGCCCGCTCACAGCTCCCCTGGCCTGCCTCCACCTGCCCTCTCCCCCAGTAAGGTCCACGGTGTGCGCTATGGACAGCCTGCGACCAGTGAGACTGCAGAAGTACCCTCAAGCAGCGGCGGTCCCTTAGTGACAGTGTCTACACCCCTCCACCAAGTGTCCCCCACGGGCCTGGAGCCCAGCCACAGCCTGCTGAGTACAGAAGCCAAGCTGGTCTCAGCAGCTGGGGGCCCCCTCCCCCCTGTCAGCACCCTGACAGCACTGCACAGCTTGGAGCAGACATCCCCAGGCCTCAACCAGCAGCCCCAGAACCTCATCATGGCCTCACTTCCTGGGGTCATGACCATCGGGCCTGGTGAGCCTGCCTCCCTGGGTCCTACGTTCACCAACACAGGTGCCTCCACCCTGGTCATCGGCCTGGCCTCCACGCAGGCACAGAGTGTGCCGGTCATCAACAGCATGGGCAGCAGCCTGACCACCCTGCAGCCCGTCCAGTTCTCCCAGCCGCTGCACCCCTCCTACCAGCAGCCGCTCATGCCACCTGTGCAGAGCCATGTGACCCAGAGCCCCTTCATGGCCACCATGGCTCAGCTGCAGAGCCCCCACGCCCTCTACAGCCACAAGCCCGAGGTGGCCCAGTACACCCACACGGGCCTGCTCCCGCAGACTATGCTCATCACCGACACCACCAACCTGAGCGCCCTGGCCAGCCTCACGCCCACCAAGCAGGTCTTCACCTCAGACACTGAGGCCTCCAGTGAGTCCGGGCTTCACACGCCGGCATCTCAGGCCACCACCCTCCACGTCCCCAGCCAGGACCCTGCCGGCATCCAGCACCTGCAGCCGGCCCACCGGCTCAGCGCCAGCCCCACAGTGTCCTCCAGCAGCCTGGTGCTGTACCAGAGCTCAGACTCCAGCAATGGCCAGAGCCACCTGCTGCCATCCAACCACAGCGTCATCGAGACCTTCATCTCCACCCAGATGGCCTCTTCCTCCCAGTAACCACGGCACCTGGGCCCTGGGGCCTGTACTGCCTGCTTGGGGGGTGATGAGGGCAGCAGCCAGCCCTGCCTGGAGGACCTGAGCCTGCCGAGCAACCGTGGCCCTTCCTGGACAGCTGTGCCTCGCTCCCCACTCTGCTCTGATGCATCAGAAAGGGAGGGCTCTGAGGCGCCCCAACCCGTGGAGGCTGCTCGGGGTGCACAGGAGGGGGTCGTGGAGAGCTAGGAGCAAAGCCTGTTCATGGCAGATGTAGGAGGGACTGTCGCTGCTTCGTGGGATACAGTCTTCTTACTTGGAACTGAAGGGGGCGGCCTATGACTTGGGCACCCCCAGCCTGGGCCTATGGAGAGCCCTGGGACCGCTACACCACTCTGGCAGCCACACTTCTCAGGACACAGGCCTGTGTAGCTGTGACCTGCTGAGCTCTGAGAGGCCCTGGATCAGCGTGGCCTTGTTCTGTCACCAATGTACCCACCGGGCCACTCCTTCCTGCCCCAACTCCTTCCAGCTAGTGACCCACATGCCATTTGTACTGACCCCATCACCTACTCACACAGGCATTTCCTGGGTGGCTACTCTGTGCCAGAGCCTGGGGCTCTAACGCCTGAGCCCAGGGAGGCCGAAGCTAACAGGGAAGGCAGGCAGGGCTCTCCTGGCTTCCCATCCCCAGCGATTCCCTCTCCCAGGCCCCATGACCTCCAGCTTTCCTGTATTTGTTCCCAAGAGCATCATGCCTCTGAGGCCAGCCTGGCCTCCTGCCTCTACTGGGAAGGCTACTTCGGGGCTGGGAAGTCGTCCTTACTCCTGTGGGAGCCTCGCAACCCGTGCCAAGTCCAGGTCCTGGTGGGGCAGCTCCTCTGTCTCGAGCGCCCTGCAGACCCTGCCCTTGTTTGGGGCAGGAGTAGCTGAGCTCACAAGGCAGCAAGGCCCGAGCAGCTGAGCAGGGCCGGGGAACTGGCCAAGCTGAGGTGCCCAGGAGAAGAAAGAGGTGACCCCAGGGCACAGGAGCTACCTGTGTGGACAGGACTAACACTCAGAAGCCTGGGGGCCTGGCTGGCTGAGGGCAGTTCGCAGCCACCCTGAGGAGTCTGAGGTCCTGAGCACTGCCAGGAGGGACAAAGGAGCCTGTGAACCCAGGACAAGCATGGTCCCACATCCCTGGGCCTGCTGCTGAGAACCTGGCCTTCAGTGTACCGCGTCTACCCTGGGATTCAGGAAAAGGCCTGGGGTGACCCGGCACCCCCTGCAGCTTGTAGCCAGCCGGGGCGAGTGGCACGTTTATTTAACTTTTAGTAAAGTCAAGGAGAAATGCGGTGGAAAAA";

                if (cdna != expected) throw new InvalidDataException("NM_000545.5 is still not right.");
            }

            if (id.WithVersion == "NM_001145076.1")
            {
                rnaEdits    = new IRnaEdit[3];
                rnaEdits[0] = new RnaEdit(935,  935,  "G");
                rnaEdits[1] = new RnaEdit(1232, 1232, "G");
                rnaEdits[2] = new RnaEdit(5376, 5375, "AAAAAAAAAAAAAAAA");

                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                string expected =
                    "GGCGCGGCGCTCGCGGCTGCTGCCTGGGAGGGAGGCCGGGCAGGCGGCTGAGCGGCGCGGCTCTCAACGTGACGGGGAAGTGGTTCGGGCGGCCGCGGCTTACTACCCCAGGGCGAACGGACGGACGACGGAGGCGGGAGCCGGTAGCCGAGCCGGGCGACCTAGAGAACGAGCGGGTCAGGCTCAGCGTCGGCCACTCTGTCGGTCCGCTGAATGAAGTGCCCGCCCCTCTAAGCCCGGAGCCCGGCGCTTTCCCCGCAAGATGGACGGTTTCGCCGGCAGTCTCGATGATAGTATTTCTGCTGCAAGTACTTCTGATGTTCAAGATCGCCTGTCAGCTCTTGAGTCACGAGTTCAGCAACAAGAAGATGAAATCACTGTGCTAAAGGCGGCTTTGGCTGATGTTTTGAGGCGTCTTGCAATCTCTGAAGATCATGTGGCCTCAGTGAAAAAATCAGTCTCAAGTAAAGGCCAACCAAGCCCTCGAGCAGTTATTCCCATGTCCTGTATAACCAATGGAAGTGGTGCAAACAGAAAACCAAGTCATACCAGTGCTGTCTCAATTGCAGGAAAAGAAACTCTTTCATCTGCTGCTAAAAGCATAAAACGACCATCACCAGCTGAAAAGTCACATAATTCTTGGGAAAATTCAGATGATAGCCGTAATAAATTGTCGAAAATACCTTCAACACCCAAATTAATACCAAAAGTTACCAAAACTGCAGACAAGCATAAAGATGTCATCATCAACCAAGAAGGAGAATATATTAAAATGTTTATGCGCGGTCGGCCAATTACCATGTTCATTCCTTCCGATGTTGACAACTATGATGACATCAGAACGGAACTGCCTCCTGAGAAGCTCAAACTGGAGTGGGCATATGGTTATCGAGGAAAGGACTGTAGAGCTAATGTTTACCTTCTTCCGACCGGGGAAATAGTTTATTTCATTGCATCAGTAGTAGTACTATTTAATTATGAGGAGAGAACTCAGCGACACTACCTGGGCCATACAGACTGTGTGAAATGCCTTGCTATACATCCTGACAAAATTAGGATTGCAACTGGACAGATAGCTGGCGTGGATAAAGATGGAAGGCCTCTACAACCCCACGTCAGAGTGTGGGATTCTGTTACTCTATCCACACTGCAGATTATTGGACTTGGCACTTTTGAGCGTGGAGTAGGATGCCTGGATTTTTCAAAAGCAGATTCAGGTGTTCATTTATGTGTTATTGATGACTCCAATGAGCATATGCTTACTGTATGGGACTGGCAGAAGAAAGCAAAAGGAGCAGAAATAAAGACAACAAATGAAGTTGTTTTGGCTGTGGAGTTTCACCCAACAGATGCAAATACCATAATTACATGCGGTAAATCTCATATTTTCTTCTGGACCTGGAGCGGCAATTCACTAACAAGAAAACAGGGAATTTTTGGGAAATATGAAAAGCCAAAATTTGTGCAGTGTTTAGCATTCTTGGGGAATGGAGATGTTCTTACTGGAGACTCAGGTGGAGTCATGCTTATATGGAGCAAAACTACTGTAGAGCCCACACCTGGGAAAGGACCTAAAGGTGTATATCAAATCAGCAAACAAATCAAAGCTCATGATGGCAGTGTGTTCACACTTTGTCAGATGAGAAATGGGATGTTATTAACTGGAGGAGGGAAAGACAGAAAAATAATTCTGTGGGATCATGATCTGAATCCTGAAAGAGAAATAGAGGTTCCTGATCAGTATGGCACAATCAGAGCTGTAGCAGAAGGAAAGGCAGATCAATTTTTAGTAGGCACATCACGAAACTTTATTTTACGAGGAACATTTAATGATGGCTTCCAAATAGAAGTACAGGGTCATACAGATGAGCTTTGGGGTCTTGCCACACATCCCTTCAAAGATTTGCTCTTGACATGTGCTCAGGACAGGCAGGTGTGCCTGTGGAACTCAATGGAACACAGGCTGGAATGGACCAGGCTGGTAGATGAACCAGGACACTGTGCAGATTTTCATCCAAGTGGCACAGTGGTGGCCATAGGAACGCACTCAGGCAGGTGGTTTGTTCTGGATGCAGAAACCAGAGATCTAGTTTCTATCCACACAGACGGGAATGAACAGCTCTCTGTGATGCGCTACTCAATAGATGGTACCTTCCTGGCTGTAGGATCTCATGACAACTTTATTTACCTCTATGTAGTCTCTGAAAATGGAAGAAAATATAGCAGATATGGAAGGTGCACTGGACATTCCAGCTACATCACACACCTTGACTGGTCCCCAGACAACAAGTATATAATGTCTAACTCGGGAGACTATGAAATATTGTACTGGGACATTCCAAATGGCTGCAAACTAATCAGGAATCGATCGGATTGTAAGGACATTGATTGGACGACATATACCTGTGTGCTAGGATTTCAAGTATTTGGTGTCTGGCCAGAAGGATCTGATGGGACAGATATCAATGCACTGGTGCGATCCCACAATAGAAAGGTGATAGCTGTTGCCGATGACTTTTGTAAAGTCCATCTGTTTCAGTATCCCTGCTCCAAAGCAAAGGCTCCCAGTCACAAGTACAGTGCCCACAGCAGCCATGTCACCAATGTCAGTTTTACTCACAATGACAGTCACCTGATATCAACTGGTGGAAAAGACATGAGCATCATTCAGTGGAAACTTGTGGAAAAGTTATCTTTGCCTCAGAATGAGACTGTAGCGGATACTACTCTAACCAAAGCCCCCGTCTCTTCCACTGAAAGTGTCATCCAATCTAATACTCCCACACCGCCTCCTTCTCAGCCCTTAAATGAGACAGCTGAAGAGGAAAGTAGAATAAGCAGTTCTCCCACACTTCTGGAGAACAGCCTGGAACAAACTGTGGAGCCAAGTGAAGACCACAGCGAGGAGGAGAGTGAAGAGGGCAGCGGAGACCTTGGTGAGCCTCTTTATGAAGAGCCATGCAACGAGATAAGCAAGGAGCAGGCCAAAGCCACCCTTCTGGAGGACCAGCAAGACCCTTCGCCCTCGTCCTAACACCCTGGCTTCAGTGCAACTCTTTTCCTTCAGCTGCATGTGATTTTGTGATAAAGTTCAGGTAACAGGATGGGCAGTGATGGAGAATCACTGTTGATTGAGATTTTGGTTTCCATGTGATTTGTTTTCTTCAATAGTCTTATTTTCAGTCTCTCAAATACAGCCAACTTAAAGTTTTAGTTTGGTGTTTATTGAAAATTAACCAAACTTAATACTAGGAGAAGACTGAATCATTAATGATGTCTCACAAATTACTGTGTACCTAAGTGGTGTGATGTAAATACTGGAAACAAAAACAGCAGTTGCATTGATTTTGAAAACAAACCCCCTTGTTATCTGAACATGTTTTCTTCAGGAACAACCAGAGGTATCACAAACACTGTTACTCATCTACTGGCTCAGACTGTACTACTTTTTTTTTTTTTTTTCCTGAAAAAGAAACCAGAAAAAAATGTACTCTTACTGAGATACCCTCTCACCCCAAATGTGTAATGGAAAATTTTTAATTAAGAAAAACTTCAGTTTTGCCAAGTGCAATGGTGTTGCCTTCTTTAAAAAATGCCGTTTTCTTACACTACCAGTGGATGTCCAGACATGCTCTTAGTCTACTAGAGAGGTGCTGCCTTTTCTAAGTCATAATGAGGAACAGTCCCTTAATTTCTTGTGTGCAACTCTGTTTTATCCTAGAACTAAGAGAGCATTGGTTTGTTAAAGAGCTTTCAATGTATATTAAAACCTTCAATACTCAGAAATGATGGATTCCTCCAAGGAGTCCTTTACTAGCCTAAACATTCTCAAATGTTTGAGATTCAAGTGAATGGAAGGAAAACCACATGCCTTTAAAACTAAACTGTAATAATTACCTGGCTAATTTCAGCTAAGCCTTCATCATAATTTGTTCCCTCAGTAATAGGAGAAATATAAATACAGTAAGTTTAGATTATTGAATTGGTGCTTGAAATTTATTGGTTTTGTTGTAATTTTATACAGATTATATGAGGGATAAGATACTCATCAAATTGCAAATTCTTTTTTTTACAGAAGTGTGGGTAACAGTCACAGCAGTTTTTTTTACCAACAGCATACTTAACAGACTTGCTGTGTAGCAGTTTTTTTCTGGTGGAGTTGCTGTAAGTCTTGTAAGTCTAATGTGGCTATCCTACTCTTTTGGGCAATGCATGTATTATGCATTGGAAAGGTATTTTTTTTAAGTTCTGTTGGCTAGCTATGGTTTTCAGTACATTTCCTACTTTAAGAGTAATTACTGACAAATATGTATTTCCTATATGTTTATACTTTGATTATAAAAAAGTATTTTGTTTTGATTTTTTAACTTGCTGCATTGTTTTGATACTTTCTATTTTTTTGGTCAAATCATGTTTAGAAACTTTGGATGAGTTAAGAAGTCTTAAGTATGCAGGCGTTTACGTGATTGTGCCATTCCAAAGTGCATCAGAACTGTCATTCCCTTCTAATATCTTCTCAGGAGTAATACAAATCAGGTATTTCATCATCATTTGGTAATATGAAAACTCCAGTGAACTCCCAAGGACATTTACAACATTTATATTCACACGCTGTATGGAAGGGTGTGGGTGTGTGTGAAGGGGCGAGTGGAGACACTGTGTGTATCTCTAGATAAGAAGATATGCACCACGTTGAAAATACTCAGTGTAGATCTCTATGTGTATAGGTATCTGTATATCTTTCCTTTTGTTTACAACTGTTAAAAAACCTCAAAATAGTTCTCTTCAAAAGAAGAGAGATTCCAAGCAACCCATCTTTCTTCAGTATGTATGTTCTGTACATACTTATCGGAGCGCGCCAGTAAGTATCAGGCATATATATCTGTCTGTTAGCAATGATTATTACATCATCAGATCAGCATGTGCTATACTCCCTGCAAGAAATATACTGACATGAACAGGCAGTTCTTGGAGAAGAAAGAGCATTTCTTTAAGTACCTGGGGAATACAGCTCTCAGTGATCAGCAGGGAGTTTATTTGAGGACATCAGTCACCTTTGGGGTTGCCATGTACAATGAGATTTATAATCATGATACTCTTCGGTGGTAGTTTCAAAAGACACTACTAATACGCAGGAAGCGTTCCAGCTATTTAATGCTGGCAACTACTGTTTAATGGTCAGTTAAATCTGTGATAATGGTTGGAAGTGGGTGGGGTTATGAAATTGTAGATGTTTTTAGAAAAACTTGTGAATGAAAATGAATCCAAGTGTTTCATGTGAAGATGTTGAGCCATTGCTATCATGCATTCCTGTCTCATGGCAGAAAATTTTGAAGATTAAAAAATAAAATAATCAAAATGTTTCCTCTTTCTAAAAAAAAAAAAAAAAAA";

                if (cdna != expected) throw new InvalidDataException("NM_001145076.1 is still not right.");
            }

            if (id.WithVersion == "NM_001220765.1")
            {
                rnaEdits    = new IRnaEdit[4];
                rnaEdits[0] = new RnaEdit(1, 0, "GAATTCCGGCGT");
                rnaEdits[1] = new RnaEdit(6, 5, "A");
                rnaEdits[2] = new RnaEdit(16, 16, "T");
                rnaEdits[3] = new RnaEdit(97, 97, "C");

                var               newRegions = new List<ITranscriptRegion>();
                ITranscriptRegion oldExon    = transcriptRegions[0];

                var exon1a = new TranscriptRegion(TranscriptRegionType.Exon, 1, oldExon.Start, oldExon.Start + 5, 13,
                    17);
                var exon1b = new TranscriptRegion(TranscriptRegionType.Exon, 1, oldExon.Start + 6, oldExon.End, 19,
                    oldExon.CdnaEnd                                                           + 13);

                newRegions.Add(exon1a);
                newRegions.Add(exon1b);

                for (int i = 1; i < transcriptRegions.Length; i++)
                {
                    var region = transcriptRegions[i];
                    newRegions.Add(new TranscriptRegion(region.Type, region.Id, region.Start, region.End,
                        region.CdnaStart + 13, region.CdnaEnd + 13));
                }

                transcriptRegions = newRegions.ToArray();
                
                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();
                
                // NOTE: this expected sequence has been truncated compared with the full cDNA sequence
                const string expected = "GAATTCCGGCGTCGCGGACGCATCCCAGTCTGGGCGGGACGCTCGGCCGCGGCGAGGCGGGCAAGCCTGGCAGGGCAGAGGGAGCCCCGGCTCCGAGGTTGCTCTTCGCCCCCGAGGATCAGTCTTGGCCCCAAAGCGCGACGCACAAATCCACATAACCTGAGGACCATGGATGCTGATGAGGGTCAAGACATGTCCCAAGTTTCAGGGAAGGAAAGCCCCCCTGTAAGCGATACTCCAGATGAGGGCGATGAGCCCATGCCGATCCCCGAGGACCTCTCCACCACCTCGGGAGGACAGCAAAGCTCCAAGAGTGACAGAGTCGTGG";
                if (cdna != expected) throw new InvalidDataException("NM_001220765.1 is still not right.");
            }

            if (id.WithVersion == "NM_001220766.1")
            {
                rnaEdits    = new IRnaEdit[5];
                rnaEdits[0] = new RnaEdit(1,   0,   "GAATTCCGGCGT");
                rnaEdits[1] = new RnaEdit(6,   5,   "A");
                rnaEdits[2] = new RnaEdit(16,  16,  "T");
                rnaEdits[3] = new RnaEdit(97,  97,  "C");
                rnaEdits[4] = new RnaEdit(317, 318, null);

                var               newRegions = new List<ITranscriptRegion>();
                ITranscriptRegion oldExon    = transcriptRegions[0];
                
                var exon1a = new TranscriptRegion(TranscriptRegionType.Exon, 1, oldExon.Start, oldExon.Start + 5, 13,
                    17);
                var exon1b = new TranscriptRegion(TranscriptRegionType.Exon, 1, oldExon.Start + 6, oldExon.End, 19,
                    oldExon.CdnaEnd                                                           + 13);
                
                newRegions.Add(exon1a);
                newRegions.Add(exon1b);
                ITranscriptRegion region;

                for (int i = 1; i < transcriptRegions.Length - 1; i++)
                {
                    region = transcriptRegions[i];
                    newRegions.Add(new TranscriptRegion(region.Type, region.Id, region.Start, region.End,
                        region.CdnaStart + 13, region.CdnaEnd + 13));
                }
                
                newRegions.Add(new TranscriptRegion(TranscriptRegionType.Exon, 3, 50367234, 50367354,
                    209, 329));
                
                newRegions.Add(new TranscriptRegion(TranscriptRegionType.Gap, 3, 50367355, 50367356,
                    329, 330));
                
                newRegions.Add(new TranscriptRegion(TranscriptRegionType.Exon, 3, 50367357, 50367358,
                    330, 331));
                
                transcriptRegions = newRegions.ToArray();

                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();

                // NOTE: this expected sequence has been truncated compared with the full cDNA sequence
                const string expected = "GAATTCCGGCGTCGCGGACGCATCCCAGTCTGGGCGGGACGCTCGGCCGCGGCGAGGCGGGCAAGCCTGGCAGGGCAGAGGGAGCCCCGGCTCCGAGGTTGCTCTTCGCCCCCGAGGATCAGTCTTGGCCCCAAAGCGCGACGCACAAATCCACATAACCTGAGGACCATGGATGCTGATGAGGGTCAAGACATGTCCCAAGTTTCAGGGAAGGAAAGCCCCCCTGTAAGCGATACTCCAGATGAGGGCGATGAGCCCATGCCGATCCCCGAGGACCTCTCCACCACCTCGGGAGGACAGCAAAGCTCCAAGAGTGACAGAGTCGTGGGAG";
                if (cdna != expected) throw new InvalidDataException("NM_001220766.1 is still not right.");
            }

            if (id.WithVersion == "NM_001220767.1" || id.WithVersion == "NM_001220769.1"|| id.WithVersion == "NM_001220770.1")
            {
                rnaEdits    = new IRnaEdit[5];
                rnaEdits[0] = new RnaEdit(1,   0,   "GAATTCCGGCGT");
                rnaEdits[1] = new RnaEdit(6,   5,   "A");
                rnaEdits[2] = new RnaEdit(16,  16,  "T");
                rnaEdits[3] = new RnaEdit(97,  97,  "C");
                rnaEdits[4] = new RnaEdit(317, 318, null);

                var               newRegions = new List<ITranscriptRegion>();
                ITranscriptRegion oldExon    = transcriptRegions[0];
                
                var exon1a = new TranscriptRegion(TranscriptRegionType.Exon, 1, oldExon.Start, oldExon.Start + 5, 13,
                    17);
                var exon1b = new TranscriptRegion(TranscriptRegionType.Exon, 1, oldExon.Start + 6, oldExon.End, 19,
                    oldExon.CdnaEnd                                                           + 13);
                
                newRegions.Add(exon1a);
                newRegions.Add(exon1b);
                ITranscriptRegion region;
                
                for (int i = 1; i < transcriptRegions.Length - 1; i++)
                {
                    region = transcriptRegions[i];
                    newRegions.Add(new TranscriptRegion(region.Type, region.Id, region.Start, region.End,
                        region.CdnaStart + 13, region.CdnaEnd + 13));
                }
                
                newRegions.Add(new TranscriptRegion(TranscriptRegionType.Exon, 3, 50367234, 50367354,
                    209, 329));
                
                newRegions.Add(new TranscriptRegion(TranscriptRegionType.Gap, 3, 50367355, 50367356,
                    329, 330));
                
                newRegions.Add(new TranscriptRegion(TranscriptRegionType.Exon, 3, 50367357, 50367358,
                    330, 331));
                
                transcriptRegions = newRegions.ToArray();

                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();

                // NOTE: this expected sequence has been truncated compared with the full cDNA sequence
                const string expected =
                    "GAATTCCGGCGTCGCGGACGCATCCCAGTCTGGGCGGGACGCTCGGCCGCGGCGAGGCGGGCAAGCCTGGCAGGGCAGAGGGAGCCCCGGCTCCGAGGTTGCTCTTCGCCCCCGAGGATCAGTCTTGGCCCCAAAGCGCGACGCACAAATCCACATAACCTGAGGACCATGGATGCTGATGAGGGTCAAGACATGTCCCAAGTTTCAGGGAAGGAAAGCCCCCCTGTAAGCGATACTCCAGATGAGGGCGATGAGCCCATGCCGATCCCCGAGGACCTCTCCACCACCTCGGGAGGACAGCAAAGCTCCAAGAGTGACAGAGTCGTGGGAG";
                if (cdna != expected) throw new InvalidDataException("NM_001220767.1/NM_001220769.1 is still not right.");
            }

            if (id.WithVersion == "NM_001220768.1" || id.WithVersion == "NM_006060.4")
            {
                rnaEdits    = new IRnaEdit[5];
                rnaEdits[0] = new RnaEdit(1,   0,   "GAATTCCGGCGT");
                rnaEdits[1] = new RnaEdit(6,   5,   "A");
                rnaEdits[2] = new RnaEdit(16,  16,  "T");
                rnaEdits[3] = new RnaEdit(97,  97,  "C");
                rnaEdits[4] = new RnaEdit(316, 315, "CCA");
                
                var               newRegions = new List<ITranscriptRegion>();
                ITranscriptRegion oldExon    = transcriptRegions[0];
                
                var exon1a = new TranscriptRegion(TranscriptRegionType.Exon, 1, oldExon.Start, oldExon.Start + 5, 13,
                    17);
                var exon1b = new TranscriptRegion(TranscriptRegionType.Exon, 1, oldExon.Start + 6, oldExon.End, 19,
                    oldExon.CdnaEnd                                                           + 13);
                
                newRegions.Add(exon1a);
                newRegions.Add(exon1b);
                ITranscriptRegion region;
                
                for (int i = 1; i < transcriptRegions.Length - 1; i++)
                {
                    region = transcriptRegions[i];
                    newRegions.Add(new TranscriptRegion(region.Type, region.Id, region.Start, region.End,
                        region.CdnaStart + 13, region.CdnaEnd + 13));
                }
                
                newRegions.Add(new TranscriptRegion(TranscriptRegionType.Exon, 3, 50367234, 50367353,
                    209, 329));
                
                newRegions.Add(new TranscriptRegion(TranscriptRegionType.Exon, 3, 50367354, 50367357,
                    332, 335));

                transcriptRegions = newRegions.ToArray();

                sequenceProvider.LoadChromosome(chromosome);
                var cdnaSequence = new CdnaSequence(sequenceProvider.Sequence, translation.CodingRegion,
                    transcriptRegions, gene.OnReverseStrand, encoded.StartExonPhase, rnaEdits);
                string cdna = cdnaSequence.GetCdnaSequence();

                // NOTE: this expected sequence has been truncated compared with the full cDNA sequence
                const string expected =
                    "GAATTCCGGCGTCGCGGACGCATCCCAGTCTGGGCGGGACGCTCGGCCGCGGCGAGGCGGGCAAGCCTGGCAGGGCAGAGGGAGCCCCGGCTCCGAGGTTGCTCTTCGCCCCCGAGGATCAGTCTTGGCCCCAAAGCGCGACGCACAAATCCACATAACCTGAGGACCATGGATGCTGATGAGGGTCAAGACATGTCCCAAGTTTCAGGGAAGGAAAGCCCCCCTGTAAGCGATACTCCAGATGAGGGCGATGAGCCCATGCCGATCCCCGAGGACCTCTCCACCACCTCGGGAGGACAGCAAAGCTCCAAGAGTGACAGAGTCGTGGCCAGTAA";
                if (cdna != expected) throw new InvalidDataException("NM_001220768.1 is still not right.");
            }

            return new Transcript(chromosomeIndexDictionary[referenceIndex], start, end, id, translation,
                encoded.BioType, gene, ExonUtilities.GetTotalExonLength(transcriptRegions), encoded.StartExonPhase,
                encoded.IsCanonical, transcriptRegions, numExons, mirnas, siftIndex, polyphenIndex,
                encoded.TranscriptSource, encoded.CdsStartNotFound, encoded.CdsEndNotFound, selenocysteines, rnaEdits);
        }

        /// <summary>
        /// writes the transcript to the binary writer
        /// </summary>
        public void Write(IExtendedBinaryWriter writer, Dictionary<IGene, int> geneIndices,
            Dictionary<ITranscriptRegion, int> transcriptRegionIndices, Dictionary<IInterval, int> microRnaIndices,
            Dictionary<string, int> peptideIndices)
        {
            // transcript
            writer.WriteOpt(Chromosome.Index);
            writer.WriteOpt(Start);
            writer.WriteOpt(End);
            // ReSharper disable once ImpureMethodCallOnReadonlyValueField
            Id.Write(writer);
            
            // gene
            writer.WriteOpt(GetIndex(Gene, geneIndices));

            // encoded data
            var encoded = EncodedTranscriptData.GetEncodedTranscriptData(BioType, CdsStartNotFound, CdsEndNotFound,
                Source, IsCanonical, SiftIndex != -1, PolyPhenIndex != -1, MicroRnas != null, RnaEdits != null,
                Selenocysteines != null, TranscriptRegions != null, Translation != null, StartExonPhase);
            encoded.Write(writer);

            // transcript regions
            if (encoded.HasTranscriptRegions) WriteIndices(writer, TranscriptRegions, transcriptRegionIndices);
            writer.WriteOpt(NumExons);

            // protein function predictions
            if (encoded.HasSift) writer.WriteOpt(SiftIndex);
            if (encoded.HasPolyPhen) writer.WriteOpt(PolyPhenIndex);

            // translation
            if (encoded.HasTranslation)
            {
                // ReSharper disable once PossibleNullReferenceException
                var peptideIndex = GetIndex(Translation.PeptideSeq, peptideIndices);
                Translation.Write(writer, peptideIndex);
            }

            // attributes
            if (encoded.HasMirnas)          WriteIndices(writer, MicroRnas, microRnaIndices);
            if (encoded.HasRnaEdits)        WriteItems(writer, RnaEdits, (x, y) => x.Write(y));
            if (encoded.HasSelenocysteines) WriteItems(writer, Selenocysteines, (x, y) => y.WriteOpt(x));
        }

        private static T[] ReadItems<T>(BufferedBinaryReader reader, Func<BufferedBinaryReader, T> readFunc)
        {
            int numItems = reader.ReadOptInt32();
            var items    = new T[numItems];
            for (int i = 0; i < numItems; i++) items[i] = readFunc(reader);
            return items;
        }

        private static void WriteItems<T>(IExtendedBinaryWriter writer, T[] items, Action<T, IExtendedBinaryWriter> writeAction)
        {
            writer.WriteOpt(items.Length);
            foreach (var item in items) writeAction(item, writer);
        }

        private static T[] ReadIndices<T>(IBufferedBinaryReader reader, T[] cachedItems)
        {
            int numItems = reader.ReadOptInt32();
            var items = new T[numItems];

            for (int i = 0; i < numItems; i++)
            {
                var index = reader.ReadOptInt32();
                items[i] = cachedItems[index];
            }

            return items;
        }

        private static void WriteIndices<T>(IExtendedBinaryWriter writer, T[] items, IReadOnlyDictionary<T, int> indices)
        {
            writer.WriteOpt(items.Length);
            foreach (var item in items) writer.WriteOpt(GetIndex(item, indices));
        }

        private static int GetIndex<T>(T item, IReadOnlyDictionary<T, int> indices)
        {
            if (item == null) return -1;

            if (!indices.TryGetValue(item, out var index))
            {
                throw new InvalidDataException($"Unable to locate the {typeof(T)} in the indices: {item}");
            }

            return index;
        }
    }
}